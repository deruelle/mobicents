<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <title>Mobicents</title>
      <link rel="stylesheet" href="css/jbossorg.css" type="text/css"/>
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/>
      <meta name="description" content="Mobicents is a highly scalable event-driven application server with a robust component model. Mobicents is the first and only Open Source Platform certified for JSLEE 1.0 compliance. It complements J2EE to enable the convergence of voice, video and data in next-generation intelligent applications. Web and SIP can be combined together to achieve more sophisticated and natural user experience."/>
   </head>
   <body>
      <div class="book" lang="en-US">
         <div class="titlepage">
            <div>
               <p id="title">
                  <a href="http://www.jboss.org" class="jbossOrg_href">
                     <strong>
						        JBoss.org	
						</strong>
                  </a>
                  <a href="http://labs.jboss.com/projects/docs" class="commDoc_href">
                     <strong>
						        Community Documentation	
						</strong>
                  </a>
               </p>
               <div>
                  <h1 class="title">
                     <a name="d0e1"/>Mobicents</h1>
               </div>
               <div>
                  <h2 class="subtitle">User Guide</h2>
               </div>
               <div>
                  <div class="authorgroup">
                     <h3 class="corpauthor">Red Hat Documentation Group</h3>
                     <div class="author">
                        <h3 class="author">
                           <span class="firstname">Douglas</span> 
                           <span class="surname">Silas</span>
                        </h3>
                        <div class="affiliation">
                           <span class="orgname">Red Hat, Inc.<br/>
                           </span> 
                           <span class="orgdiv">Content Services<br/>
                           </span>
                        </div>
                        <code class="email">&lt;<a href="mailto:dhensley@redhat.com">dhensley@redhat.com</a>&gt;</code>
                     </div>
                  </div>
               </div>
               <div>
                  <p class="copyright">Copyright ©  </p>
               </div>
               <div>
                  <div class="abstract">
                     <p class="title">
                        <b>Abstract</b>
                     </p>
                     <p>Mobicents is a highly scalable event-driven application server with a robust component model. Mobicents is the first and only Open Source Platform certified for JSLEE 1.0 compliance. It complements J2EE to enable the convergence of voice, video and data in next-generation intelligent applications. Web and SIP can be combined together to achieve more sophisticated and natural user experience.</p>
                  </div>
               </div>
            </div>
            <hr/>
         </div>
         <div class="toc">
            <dl>
               <dt>
                  <span class="preface">
                     <a href="#Mobicents_User_Guide-Preface">Preface</a>
                  </span>
               </dt>
               <dd>
                  <dl>
                     <dt>
                        <span class="section">
                           <a href="#Document_Conventions">1. Document Conventions</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#We_Need_Feedback">2. We Need Feedback!</a>
                        </span>
                     </dt>
                  </dl>
               </dd>
               <dt>
                  <span class="chapter">
                     <a href="#chapter-Introduction">1. Introduction</a>
                  </span>
               </dt>
               <dd>
                  <dl>
                     <dt>
                        <span class="section">
                           <a href="#section-Introduction_to_the_Mobicents_Converged_Application_Server">1.1. Introduction to the Mobicents Converged Application Server</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-Service_Building_Blocks_and_Next-Generation_Intelligent_Networks">1.2. Service Building Blocks and Next-Generation Intelligent Networks</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-Mobicents_Use_Cases">1.3. Mobicents Use Cases</a>
                        </span>
                     </dt>
                  </dl>
               </dd>
               <dt>
                  <span class="chapter">
                     <a href="#chapter-Installation">2. Installation</a>
                  </span>
               </dt>
               <dd>
                  <dl>
                     <dt>
                        <span class="section">
                           <a href="#section-Installing_the_Mobicents_Binary_Distribution">2.1. Installing the Mobicents Binary Distribution</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-Building_the_Mobicents_1.2.x_Series">2.2. Building the Mobicents 1.2.x Series</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-Installing_EclipSLEE">2.3. Installing EclipSLEE: The JAIN SLEE Eclipse Plugin</a>
                        </span>
                     </dt>
                  </dl>
               </dd>
               <dt>
                  <span class="chapter">
                     <a href="#chapter-Running_Mobicents">3. Running Mobicents</a>
                  </span>
               </dt>
               <dd>
                  <dl>
                     <dt>
                        <span class="section">
                           <a href="#Running_the_Mobicents_Application_Server">3.1. Running the Mobicents Application Server</a>
                        </span>
                     </dt>
                  </dl>
               </dd>
               <dt>
                  <span class="chapter">
                     <a href="#chapter-Working_with_the_Mobicents_Management_Console">4. Working with the Mobicents Management Console</a>
                  </span>
               </dt>
               <dt>
                  <span class="chapter">
                     <a href="#chapter-Resource_Adapters">5. Resource Adapters</a>
                  </span>
               </dt>
               <dd>
                  <dl>
                     <dt>
                        <span class="section">
                           <a href="#section-Deploying_and_Undeploying_Resource_Adapters">5.1. Deploying and Undeploying Resource Adapters</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Before_You_Begin_Resource_Adapters_and_Deployable_Unit_Files">5.1.1. Before You Begin: Resource Adapters and Deployable Unit Files</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Deploying_Resource_Adapters">5.1.2. Deploying Resource Adapters</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Undeploying_Resource_Adapters">5.1.3. Undeploying Resource Adapters</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-SIP_Resource_Adapter">5.2. SIP Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_JAIN_SIP_Resource_Adapter">5.2.1. Installing the JAIN SIP Resource Adapter</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Configuration_of_the_JAIN_SIP_Resource_Adapter">5.2.2. Configuration of the JAIN SIP Resource Adapter</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-End-to-End_SIP_Example">5.2.3. Example: End-to-End SIP</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Wake-Up_Call_Example">5.2.4. Example: Wake-Up Call</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Third-Party_Call_Control_Example">5.2.5. Example: Third-Party Call Control</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Back-to-Back_User_Agent_Example">5.2.6. Example: Back-to-Back User Agent</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-The_XMPP_and_Google_Talk_Resource_Adapter">5.3. The XMPP and Google Talk Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Google_Talk_Bot_Example">5.3.1. Example: Google Talk Bot</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-Asterisk_Resource_Adapter">5.4. Asterisk Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_Asterisk_Resource_Adapter">5.4.1. Installing the Asterisk Resource Adapter</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-J2EE_and_CA_Resource_Adapter">5.5. J2EE and CA Resource Adapter</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-Diameter_Resource_Adapter">5.6. Diameter Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_Diameter_Resource_Adapter">5.6.1. Installing the Diameter Resource Adapter</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-Media_Resource_Adapter">5.7. Media Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_Media_Resource_Adapter">5.7.1. Installing the Media Resource Adapter</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-SMPP_Resource_Adapter">5.8. SMPP Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_SMPP_Resource_Adapter">5.8.1. Installing the SMPP Resource Adapter</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-Media_Gateway_Resource_Adapter">5.9. Media Gateway Resource Adapter</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-JCC_INAP_Resource_Adapter">5.10. JCC INAP Resource Adapter</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-HTTP_Servlet_Resource_Adapter">5.11. HTTP Servlet Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_HTTP_Servlet_Resource_Adapter">5.11.1. Installing the HTTP Servlet Resource Adapter</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Understanding_the_HTTP_Servlet_Resource_Adapter">5.11.2. Understanding the HTTP Servlet Resource Adapter</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-HTTP_Client_Resource_Adapter">5.12. The HTTP Client Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_HTTP_Client_Resource_Adapter">5.12.1. Installing the HTTP Client Resource Adapter</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Understanding_the_HTTP_Client_Resource_Adapter">5.12.2. Understanding the HTTP Client Resource Adapter</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-Persistence_Resource_Adapter">5.13. Persistence Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_Persistence_Resource_Adapter">5.13.1. Installing the Persistence Resource Adapter</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-XCAP_Client_Resource_Adapter">5.14. XCAP Client Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_XCAP_Client_Resource_Adapter">5.14.1. Installing the XCAP Client Resource Adapter</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-Rules_Resource_Adapter">5.15. Rules Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_Rules_Resource_Adapter">5.15.1. Installing the Rules Resource Adapter</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-TTS_Resource_Adapter">5.16. TTS Resource Adapter</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_the_TTS_Resource_Adapter">5.16.1. Installing the TTS Resource Adapter</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-SAP_Resource_Adapter">5.17. SAP Resource Adapter</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-Third-Party_Resource_Adapters">5.18. Third-Party Resource Adapters</a>
                        </span>
                     </dt>
                  </dl>
               </dd>
               <dt>
                  <span class="chapter">
                     <a href="#chapter-Other_Examples">6. Other Examples</a>
                  </span>
               </dt>
               <dd>
                  <dl>
                     <dt>
                        <span class="section">
                           <a href="#section-SLEE_Graph_Viewer_Example">6.1. Example: SLEE Graph Viewer</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-Call_Blocking_and_Call_Forwarding_and_Voice_Mail_Example">6.2. Example: Call-Blocking, Call-Forwarding and Voice Mail</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-Multi-Service_Example">6.3. Example: Multiple Services</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-Parent-Child_Interaction_Example">6.4. Example: Parent-Child Interaction</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-LDAP-Enabled_JSLEE_Example">6.5. Example: LDAP-Enabled JSLEE</a>
                        </span>
                     </dt>
                  </dl>
               </dd>
               <dt>
                  <span class="chapter">
                     <a href="#chapter-Mobicents_SIP_Presence_Service">7. Mobicents SIP Presence Service</a>
                  </span>
               </dt>
               <dd>
                  <dl>
                     <dt>
                        <span class="section">
                           <a href="#section-Mobicents_SIP_Presence_Service">7.1. Mobicents SIP Presence Service</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Architecture_of_the_Mobicents_SIP_Presence_Service">7.1.1. Architecture of the Mobicents SIP Presence Service</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-Mobicents_XML_Document_Management_Server">7.2. Mobicents XML Document Management Server</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Introduction_to_the_XDM_Server">7.2.1. Introduction to the XDM Server</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Configuring_Installing_and_Testing_the_XDM_Server">7.2.2. Configuring, Installing and Testing the XDM Server</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Functional_Architecture_of_the_XDM_Server">7.2.3. Functional Architecture of the XDM Soerver</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Resources_and_Further_Information_about_the_XDM_Server">7.2.4. Resources and Further Information about the XDM Server</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-Mobicents_SIP_Presence_Server">7.3. Mobicents SIP Presence Server</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Introduction_to_the_SIP_Presence_Server">7.3.1. Introduction to the SIP Presence Server</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Configuring_Installing_and_Testing_the_SIP_Presence_Server">7.3.2. Configuring, Installing and Testing the SIP Presence Server</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Functional_Architecture_of_the_SIP_Presence_Server">7.3.3. Functional Architecture of the SIP Presence Server</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Resources_and_Further_Information_about_the_SIP_Presence_Server">7.3.4. Resources and Further Information about the SIP Presence Server</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-Mobicents_Resource_List_Server">7.4. Mobicents_Resource_List_Server</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Introduction_to_the_Mobicents_Resource_List_Server">7.4.1. Introduction to the Mobicents Resource List Server</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                  </dl>
               </dd>
               <dt>
                  <span class="chapter">
                     <a href="#chapter-Mobicents_Media_Server">8. Mobicents Media Server</a>
                  </span>
               </dt>
               <dd>
                  <dl>
                     <dt>
                        <span class="section">
                           <a href="#section-Mobicents_Media_Server">8.1. Mobicents Media Server</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Overview_of_Media_Servers">8.1.1. Overview of Media Servers</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Installing_Building_and_Uninstalling_the_MMS">8.1.2. Installing, Building and Uninstalling the MMS</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-Mobicents_Media_Server_Architecture">8.2. Mobicents Media Server Architecture</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Design_Overview_and_Typical_Deployment_Scenario">8.2.1. Design Overview and Typical Deployment Scenario</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Endpoints">8.2.2. Endpoints</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Endpoint_Identifiers">8.2.3. Endpoint Identifiers</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Connections">8.2.4. Connections</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Events_and_Signals">8.2.5. Events and Signals</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-MMS_Configuration">8.3. MMS Configuration</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Announcement_Server_Access_Points">8.3.1. Announcement Server Access Points</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Interactive_Voice_Response">8.3.2. Interactive Voice Response</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Packet_Relay_Endpoint">8.3.3. Packet Relay Endpoint</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Conference_Bridge_Endpoint">8.3.4. Conference Bridge Endpoint</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-MMS_Control_Protocols">8.4. MMS Control Protocols</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-MMS_Control_API">8.5. MMS Control API</a>
                        </span>
                     </dt>
                     <dd>
                        <dl>
                           <dt>
                              <span class="section">
                                 <a href="#section-Basic_Components_of_the_MMS_API">8.5.1. Basic Components of the MMS API</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Basic_API_Patterns_Listeners">8.5.2. Basic API Patterns: Listeners</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-Events">8.5.3. Events</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-MSC_API_Objects_Finite_State_Machines">8.5.4. MSC API Objects: Finite State Machines</a>
                              </span>
                           </dt>
                           <dt>
                              <span class="section">
                                 <a href="#section-API_Methods_and_Usage">8.5.5. API Methods and Usage</a>
                              </span>
                           </dt>
                        </dl>
                     </dd>
                     <dt>
                        <span class="section">
                           <a href="#section-MMS_Event_Packages">8.6. MMS Event Packages</a>
                        </span>
                     </dt>
                     <dt>
                        <span class="section">
                           <a href="#section-MMS_Demonstration_Example">8.7. MMS Demonstration Example</a>
                        </span>
                     </dt>
                  </dl>
               </dd>
               <dt>
                  <span class="appendix">
                     <a href="#Mobicents_User_Guide-Revision_History">A. Revision History</a>
                  </span>
               </dt>
            </dl>
         </div>
         <div class="preface" lang="en-US">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title">
                        <a name="Mobicents_User_Guide-Preface"/>Preface</h2>
                  </div>
               </div>
            </div>
            <p/>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="Document_Conventions"/>1. Document Conventions</h2>
                     </div>
                  </div>
               </div>
               <p>
		Certain words in this manual are represented in different fonts, styles, and weights. This highlighting indicates that the word is part of a specific category. The categories include the following:
	</p>
               <div class="variablelist">
                  <dl>
                     <dt>
                        <span class="term">
				
                           <code class="literal">Courier font</code>
			
                        </span>
                     </dt>
                     <dd>
                        <p>
					Courier font represents <code class="command">commands</code>, <code class="filename">file names and paths</code>, and <code class="prompt">prompts</code> .
				</p>
                        <p>
					When shown as below, it indicates computer output: 
</p>
                        <pre class="screen">
Desktop       about.html       logs      paulwesterberg.png
Mail          backupfiles      mail      reports
</pre>
                        <p>
				
                        </p>
                     </dd>
                     <dt>
                        <span class="term">
				
                           <strong class="userinput">
                              <code>bold Courier font</code>
                           </strong>
			
                        </span>
                     </dt>
                     <dd>
                        <p>
					Bold Courier font represents text that you are to type, such as: <strong class="userinput">
                              <code>service jonas start</code>
                           </strong>
				
                        </p>
                        <p>
					If you have to run a command as root, the root prompt (<code class="literal">#</code>) precedes the command:
				</p>
                        <pre class="screen">
# <strong class="userinput">
                              <code>gconftool-2 </code>
                           </strong>


                        </pre>
                     </dd>
                     <dt>
                        <span class="term">
				
                           <em class="replaceable">
                              <code>italic Courier font</code>
                           </em>
			
                        </span>
                     </dt>
                     <dd>
                        <p>
					Italic Courier font represents a variable, such as an installation directory: <code class="filename">
                              <em class="replaceable">
                                 <code>install_dir</code>
                              </em>/bin/</code>
				
                        </p>
                     </dd>
                     <dt>
                        <span class="term">
				
                           <span>
                              <strong class="application">bold font</strong>
                           </span>
			
                        </span>
                     </dt>
                     <dd>
                        <p>
					Bold font represents <span>
                              <strong class="application">application programs</strong>
                           </span> and <span>
                              <strong class="guilabel">text found on a graphical interface</strong>
                           </span>.
				</p>
                        <p>
					When shown like this: <span>
                              <strong class="guibutton"> OK </strong>
                           </span>, it indicates a button on a graphical application interface.
				</p>
                     </dd>
                  </dl>
               </div>
               <p>
		Additionally, the manual uses different strategies to draw your attention to pieces of information. In order of how critical the information is to you, these items are marked as follows:
	</p>
               <div class="note">
                  <h2>Note</h2>
                  <p>
			A note is typically information that you need to understand the behavior of the system.
		</p>
               </div>
               <div class="tip">
                  <h2>Tip</h2>
                  <p>
			A tip is typically an alternative way of performing a task.
		</p>
               </div>
               <div class="important">
                  <h2>Important</h2>
                  <p>
			Important information is necessary, but possibly unexpected, such as a configuration change that will not persist after a reboot.
		</p>
               </div>
               <div class="caution">
                  <h2>Caution</h2>
                  <p>
			A caution indicates an act that would violate your support agreement, such as recompiling the kernel.
		</p>
               </div>
               <div class="warning">
                  <h2>Warning</h2>
                  <p>
			A warning indicates potential data loss, as may happen when tuning hardware for maximum performance.
		</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="We_Need_Feedback"/>2. We Need Feedback!</h2>
                     </div>
                  </div>
               </div>
               <a name="d0e155" class="indexterm"/>
               <p>
		You should over ride this by creating your own local Feedback.xml file.
	</p>
            </div>
         </div>
         <div class="chapter" lang="en-US">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title">
                        <a name="chapter-Introduction"/>Chapter 1. Introduction</h2>
                  </div>
               </div>
            </div>
            <div class="toc">
               <dl>
                  <dt>
                     <span class="section">
                        <a href="#section-Introduction_to_the_Mobicents_Converged_Application_Server">1.1. Introduction to the Mobicents Converged Application Server</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-Service_Building_Blocks_and_Next-Generation_Intelligent_Networks">1.2. Service Building Blocks and Next-Generation Intelligent Networks</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-Mobicents_Use_Cases">1.3. Mobicents Use Cases</a>
                     </span>
                  </dt>
               </dl>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Introduction_to_the_Mobicents_Converged_Application_Server"/>1.1. Introduction to the Mobicents Converged Application Server</h2>
                     </div>
                  </div>
               </div>
               <p>The Mobicents Communication Platform is the best architecture for creating, deploying and managing services and applications integrating voice, video and data across a range of IP and communications networks. The Mobicents Communication Platform drives convergence by leveraging the following four core capabilities.</p>
               <div class="mediaobject" align="center">
                  <a name="mediaobj-top-orig-dia-mobicents-high-level-diagram.gif"/>
                  <img src="images/top-orig-dia-mobicents-high-level-diagram.gif" align="middle"/>
               </div>
               <div class="variablelist">
                  <a name="varlist-Core_Capabilities_of_the_Mobicents_Converged_Application_Server"/>
                  <p class="title">
                     <b>Core Capabilities of the Mobicents Converged Application Server</b>
                  </p>
                  <dl>
                     <dt>
                        <span class="term">Mobicents JAIN-SLEE</span>
                     </dt>
                     <dd>
                        <p>Mobicents JAIN-SLEE provides a highly-scalable event-driven application server with a robust component model and a fault-tolerant execution environment. Mobicents JAIN-SLEE is the first and only Open Source Platform certified for JSLEE 1.0 compliance. It complements J2EE to enable the convergence of voice, video and data in next-generation intelligent applications. Web and SIP can be combined together to achieve more sophisticated and natural user experience.</p>
                     </dd>
                     <dt>
                        <span class="term">Mobicents Media Server</span>
                     </dt>
                     <dd>
                        <p>The Mobicents Media Server is an open sourced server based on the Java Media Framework implementation, and aimed to:</p>
                        <div class="itemizedlist">
                           <a name="itemlist-MMS_aims"/>
                           <p class="title">
                              <b>Aims of the Mobicents Media Server</b>
                           </p>
                           <ul>
                              <li>
                                 <p>Deliver a competitive, complete, best-of-breed media gateway functionality of the highest quality.</p>
                              </li>
                              <li>
                                 <p>Meet the demands of converged wireless, wireline, cable broadband access and fixed-mobile converged VoIP networks from a single media gateway platform.</p>
                              </li>
                              <li>
                                 <p>Increase flexibility with a media gateway that supports a wide variety of call control protocols, and which scales down to meet the demands of enterprises and small carrier providers.</p>
                              </li>
                              <li>
                                 <p>React quickly to dynamic market requirements.</p>
                              </li>
                           </ul>
                        </div>
                     </dd>
                     <dt>
                        <span class="term">Mobicents Presence (XDM) Server</span>
                     </dt>
                     <dd>
                        <p>The first free and open source implementation of an XML Document Management (XDM) server, as defined in the Open Mobile Alliance (OMA) specifications. This functional element of next-generation IP communication networks is responsible for handling the management of users' XML documents stored on the network side, such as presence authorization rules, contact and group lists (also known as resource lists), static presence information, and much more.</p>
                     </dd>
                     <dt>
                        <span class="term">The JBoss Microcontainer</span>
                     </dt>
                     <dd>
                        <p>The JBoss Microcontainer is the state-of-the-art hosting environment in which higher-level containers reside. It provides service registration, configuration and dependency management, classloading isolation control, package versioning, deployment, thread pooling and many other fundamental building blocks necessary for highly-scalable, fault-tolerant middleware servers.</p>
                     </dd>
                  </dl>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Service_Building_Blocks_and_Next-Generation_Intelligent_Networks"/>1.2. Service Building Blocks and Next-Generation Intelligent Networks</h2>
                     </div>
                  </div>
               </div>
               <p>In the scope of telecommunications' Next Generation Intelligent Networks (<acronym class="acronym">NGIN</acronym>s), Mobicents fits in as a high-performance core engine for Service Delivery Platforms (<acronym class="acronym">SDP</acronym>s) and IP Multimedia Subsystems (<acronym class="acronym">IMS</acronym>es).</p>
               <p>Mobicents enables the composition of Service Building Blocks (<acronym class="acronym">SBB</acronym>s) such as call control, billing, user-provisioning, administration, and presence-sensing features. The <acronym class="acronym">JAIN SLEE</acronym>
			
                  <sup>[<a name="def-jain" href="#ftn.def-jain">1</a>]</sup> specification allows popular protocol stacks such as <acronym class="acronym">SIP</acronym> to be plugged in as resource adapters. The <acronym class="acronym">SLEE</acronym> Service Building Blocks have many similarities to Enterprise Java Beans (<acronym class="acronym">EJB</acronym>s), and naturally accommodate integration with enterprise applications, the Web, Customer Relationship Management (<acronym class="acronym">CRM</acronym>) and Service-Oriented Architecture (<acronym class="acronym">SOA</acronym>) end points.</p>
               <p>Out-of-the-box monitoring and management of Mobicents components is achieved via <acronym class="acronym">SLEE</acronym> standard-based Java Management Extensions (<acronym class="acronym">JMXes</acronym>) and Simple Network Management Profile (<acronym class="acronym">SNMP</acronym>) interfaces.</p>
               <p>Beyond telecommunications, Mobicents is applicable to a wider variety of problems demanding high-volume, low-latency signaling. Examples include financial trading, online gaming, RFID sensor network integration, and distributed control.</p>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Mobicents_Use_Cases"/>1.3. Mobicents Use Cases</h2>
                     </div>
                  </div>
               </div>
               <p>The Mobicents Converged Application Server has a wide variety of use cases, including all of the following domains:</p>
               <div class="itemizedlist">
                  <ul>
                     <li>
                        <p>
					
                           <a href="#VoIP_Call_Control_Services">VoIP Call Control Services</a>
				
                        </p>
                     </li>
                     <li>
                        <p>
					
                           <a href="#Instant_Messaging_Services">Instant Messaging Services</a>
				
                        </p>
                     </li>
                     <li>
                        <p>
					
                           <a href="#Online_Multi-Player_Games">Online Multi-Player Games</a>
				
                        </p>
                     </li>
                     <li>
                        <p>
					
                           <a href="#Financial_Day_Trading">Financial Day Trading</a>
				
                        </p>
                     </li>
                     <li>
                        <p>
					
                           <a href="#First_Responder_Communication_Networks">First Responder Communication Networks</a>
				
                        </p>
                     </li>
                     <li>
                        <p>
					
                           <a href="#Sensor_network_integration_and_RFID">Sensor Network Integration and RFID</a>
				
                        </p>
                     </li>
                  </ul>
               </div>
               <h5 class="formalpara">
				
                  <a name="VoIP_Call_Control_Services"/>VoIP Call Control Services</h5>
               <p class="formalpara">Voice-over-Internet Protocol (<acronym class="acronym">VoIP</acronym>) services are some of the primary use cases for Mobicents. Examples of VoIP services include call routing, forwarding, termination, voice mailbox, conferencing and user provisioning.</p>
               <h5 class="formalpara">
				
                  <a name="Instant_Messaging_Services"/>Instant Messaging Services</h5>
               <h5 class="formalpara">
				
                  <a name="Online_Multi-Player_Games"/>Online Multi-Player Games</h5>
               <p class="formalpara">SLEE is a great platform for Massively Multi-Player (<acronym class="acronym">MMP</acronym> games. The following are some of the principle requirements for <acronym class="acronym">MMP</acronym> servers, provided by the leader of <a xmlns:xlink="http://www.w3.org/1999/xlink" href="https://games.dev.java.net/nonav/index.html">Java.net Games community</a>:</p>
               <div class="orderedlist">
                  <ol>
                     <li>
                        <p>
					
                           <span class="emphasis">
                              <em>Worst-case</em>
                           </span> latencies from end-to-end in the back-end system, including all database operations, of no more than 100 ms. </p>
                     </li>
                     <li>
                        <p>A programming model that allows the game programmer to program simple persistent objects, with no more work than any other standard Java object, and have them execute on data events coming into the system. These objects must be "real objects" in the simulation sense of the term.</p>
                     </li>
                     <li>
                        <p>A programming model that is optimistically parallel while <span class="emphasis">
                              <em>appearing</em>
                           </span> to the programmer as a single-threaded event-driven model. Each event has to be <acronym class="acronym">ACID-transactional</acronym> (Atomicity, Consistency, Isolation, Durability), and atomic unto itself. The programmer cannot be required to be aware in any way of multiple threads, database access, or locking. It must be inherently and transparently race-condition-proof and deadlock-proof.</p>
                     </li>
                     <li>
                        <p>It must scale to massive numbers of simultaneous users (5-to-6 figures) online simultaneously accessing the same database of objects.</p>
                     </li>
                     <li>
                        <p>It needs to provide failover, fault-tolerance and efficient load-balancing. The last is critical. Game applications are cost-sensitive. Without the ability to load-balance the potentially heavy loads of multiple apps over banks of low-cost computers used to maximal efficiency, the economic model falls apart.</p>
                     </li>
                  </ol>
               </div>
               <p>If you are familiar with SLEE, then you have already noticed that these requirements closely track the fundamental SLEE design principles.</p>
               <p>Here are some pointers to books, blogs and papers on the subject of Massive Multi-Player games:</p>
               <div class="itemizedlist">
                  <ul>
                     <li>
                        <p>
					
                           <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://liquidnarrative.csc.ncsu.edu/pubs/phic.pdf">Internet-Based Games by R. Young</a>
				
                        </p>
                     </li>
                     <li>
                        <p>
					
                           <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.amazon.com/exec/obidos/tg/detail/-/1584502436/002-3357427-0961607?v=glance">Massively Multiplayer Game Development</a> by Thor Alexander</p>
                     </li>
                     <li>
                        <p>
					
                           <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://hardcodedgames.com/mmpgamedev/">MMP Blog</a>
				
                        </p>
                     </li>
                     <li>
                        <p>
					
                           <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.ibr.cs.tu-bs.de/users/wellnitz/papers/misc/ims-netgames2004.pdf">A Mobile Gaming Platform for the IMS</a>
				
                        </p>
                     </li>
                     <li>
                        <p>
					
                           <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://forum.nokia.com.cn/doc/SIPpresentation(24workshopHK)-new.pdf">SIP based Game Server </a>
				
                        </p>
                     </li>
                  </ul>
               </div>
               <h5 class="formalpara">
				
                  <a name="Financial_Day_Trading"/>Financial Day Trading</h5>
               <p class="formalpara">Financial trading is a well-understood problem domain demanding highly-available, fast-response technology to serve billions of trading calls per day. Each trading call is a concise message identifying the trader, ticker and price. Day trading applications fit nicely on top of event-driven containers.</p>
               <h5 class="formalpara">
				
                  <a name="First_Responder_Communication_Networks"/>First Responder Communication Networks</h5>
               <p class="formalpara">We live in an unsafe world. Project P25 is focused on public safety communications digital radio interoperability. It is spurred on by growing concern which has driven many countries' governmentsincluding the US Federal Governmentto reorganize in order to create focused positions to address homeland security. The National Institute of Standards and Technology (<acronym class="acronym">NIST</acronym>) is building a test system for Radio-Frequency subsystem interoperability Standard, which is based on these three protocols: the Session Initiation Protocol (<acronym class="acronym">SIP</acronym>), the Service Discovery Protocol (<acronym class="acronym">SDP</acronym>), and the Real-time Transport Protocol (<acronym class="acronym">RTP</acronym>). The reference implementation and test system will be built as SLEE services.</p>
               <h5 class="formalpara">
				
                  <a name="Sensor_network_integration_and_RFID"/>Sensor Network Integration and RFID</h5>
               <p class="formalpara">Gartner predicts that sensor technologies will be part of our everyday life by the year 2015. Sensors will be everywhere: as RFID tags on consumer products, devices monitoring tire pressure, location-tracking tags carried by workers in sensitive or hazardous environments, <abbr class="abbrev">etc.</abbr> In addition, all enterprise activities will be monitored using enterprise tools connected to the network; by 2010 these, as embedded Internet devices, will represent 95% of all Internet-connected systems.</p>
               <p>Pervasive sensor technologies will transform the objective of IT from providing support for fundamentally manual processes to automating the execution of tasks in response to a continuously-changing environment monitored by sensors. This requires a new kind of architecture capable of delivering <span class="emphasis">
                     <em>extreme</em>
                  </span> transaction processing.</p>
            </div>
            <div class="footnotes">
               <br/>
               <hr width="100" align="left"/>
               <div class="footnote">
                  <p>
                     <sup>[<a name="ftn.def-jain" href="#def-jain">1</a>] </sup>
					
                     <acronym class="acronym">JAIN SLEE</acronym> stands for Java <acronym class="acronym">API</acronym> for Intelligent Network Service Logic and Execution Environment architecture. <acronym class="acronym">JSLEE</acronym> (Java Service Logic Execution Environment) is a short synonym for <acronym class="acronym">JAIN SLEE</acronym>.</p>
               </div>
            </div>
         </div>
         <div class="chapter" lang="en-US">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title">
                        <a name="chapter-Installation"/>Chapter 2. Installation</h2>
                  </div>
               </div>
            </div>
            <div class="toc">
               <dl>
                  <dt>
                     <span class="section">
                        <a href="#section-Installing_the_Mobicents_Binary_Distribution">2.1. Installing the Mobicents Binary Distribution</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-Building_the_Mobicents_1.2.x_Series">2.2. Building the Mobicents 1.2.x Series</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-Installing_EclipSLEE">2.3. Installing EclipSLEE: The JAIN SLEE Eclipse Plugin</a>
                     </span>
                  </dt>
               </dl>
            </div>
            <p/>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Installing_the_Mobicents_Binary_Distribution"/>2.1. Installing the Mobicents Binary Distribution</h2>
                     </div>
                  </div>
               </div>
               <p>The Mobicents Converged Application Server runs on top of the JBoss Application Server. The Mobicents 1.20 binary distribution comes bundled with the JBoss Application Server version 4.2.2 GA.</p>
               <p class="formalpara">
                  <a name="fpara-Hardware_Requirements_for_the_Binary_Distribution"/>
               </p>
               <h5 class="formalpara">Hardware Requirements for the Binary Distribution</h5>
               <p class="formalpara">Both the Mobicents Converged Application Server and the JBoss Application Server are 100% Java. Mobicents will run on the same hardware that the JBoss Application Server runs on.</p>
               <p class="formalpara">
                  <a name="fpara-Pre-Install_Requirements_for_the_Binary_Distribution"/>
               </p>
               <h5 class="formalpara">Pre-Install Requirements for the Binary Distribution</h5>
               <p class="formalpara">You should ensure a couple of things before downloading and installing the Mobicents binary release:</p>
               <div class="itemizedlist">
                  <a name="itemlist-Binary_Distribution_Installation_Requirements"/>
                  <ul>
                     <li>
                        <p>You must have sufficient disk space in order to install the Mobicents binary release. Once unzipped, version 1.20 (<code class="literal">BETA3</code>) of the Mobicents binary release requires about 150 MB of free disk space. Keep in mind that disk space requirements may change from release to release.</p>
                     </li>
                     <li>
                        <p>A working installation of Java 1.5 or higher is required in order to run Mobicents and the JBoss Application Server.</p>
                     </li>
                  </ul>
               </div>
               <h5 class="formalpara">Installing the Mobicents Binary</h5>
               <p class="formalpara">Once the preconditions and requirements have been met, you are ready to install the Mobicents binary distribution.</p>
               <div class="procedure">
                  <a name="procedure-Downloading_and_Verifying_the_Mobicents_Distribution"/>
                  <ol class="1">
                     <li>
                        <p>Download the latest version of the Mobicents binary distribution. The latest version can be found by going to the <a xmlns:xlink="http://www.w3.org/1999/xlink" href="https://sourceforge.net/projects/mobicents/">Mobicents project page on SourceForge.net</a>, clicking on <span class="emphasis">
                              <em>Download Mobicents</em>
                           </span>, and then looking for <span class="emphasis">
                              <em>Mobicents Server</em>
                           </span> and <span class="emphasis">
                              <em>Latest Version</em>
                           </span>. The latest version as of the latest update of this document was <code class="literal">BETA3</code>.</p>
                     </li>
                     <li>
                        <p>Verify the integrity of the zip file. Along with the zip file there is a sha1 file<sup>[<a name="d0e513" href="#ftn.d0e513">2</a>]</sup> which contains a checksum that can be used to verify the integrity of the zip file, and can alert you if the file has been changed since it was uploaded, or if it was corrupted upon download.</p>
                        <p>On a Linux system you can use the <code class="command">sha1sum</code> command to verify the integrity of the binary distribution zip file.</p>
                        <p>On a Windows system you will need to download a sha1sum-generating program such as the <code class="command">sha1sum.exe</code> program. This will generate a checksum that you can compare with the sum in the sha1 file.</p>
                        <p>Note that if the two checksums are not identical, it means that the downloaded zip file was corrupted upon download, or has been changed since it was last uploaded to the server.</p>
                     </li>
                     <li>
                        <p>Finally, install the Mobicents Converged Application Server. Unzip the Mobicents binary distribution zip file to a location of your choice, thus completing the install.</p>
                     </li>
                  </ol>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Building_the_Mobicents_1.2.x_Series"/>2.2. Building the Mobicents 1.2.x Series</h2>
                     </div>
                  </div>
               </div>
               <p>Besides simply installing the latest binary Mobicents release, you can also build the Mobicents Converged Application Server from source. There are several reasons for building Mobicents from source, including getting access to new features such as the latest resource adapters, bundled servers and examples, getting full support for debugging, and accessing extra documentation.</p>
               <p>Note that building Mobicents from source requires a working installation of JBoss 4.2. This section on building Mobicents from source also includes the steps necessary for installing the JBoss 4.2.2 binary distribution.</p>
               <p class="formalpara">
                  <a name="fpara-Hardware_Requirements_for_the_Source_Distribution"/>
               </p>
               <h5 class="formalpara">Hardware Requirements for the Source Distribution</h5>
               <p class="formalpara">Both the Mobicents Converged Application Server and the JBoss Application Server are 100% Java. Mobicents will run on the same hardware that the JBoss Application Server runs on.</p>
               <p class="formalpara">
                  <a name="fpara-Pre-Install_Requirements_for_the_Source_Distribution"/>
               </p>
               <h5 class="formalpara">Pre-Install Requirements for the Source Distribution</h5>
               <p class="formalpara">There are a number of requirements that should be met before downloading and installing JBoss, and then acquiring the Mobicents sources and building the Mobicents Converged Application Server.</p>
               <div class="variablelist">
                  <a name="varlist-Source_Distribution_Installation_Requirements"/>
                  <p class="title">
                     <b>Source Distribution Installation Requirements</b>
                  </p>
                  <dl>
                     <dt>
                        <span class="term">Sufficient Disk Space</span>
                     </dt>
                     <dd>
                        <p>You must have sufficient disk space in order to install the Mobicents source as well as the JBoss binary distribution. The Mobicents source, once fetched from the development Subversion repository, will consume anywhere from 250-300 MB of disk space. In addition to this, the JBoss Application Server binary distribution (version 4.2.2 GA), once decompressed, requires approximately 115 MB, meaning that you should probably have <span class="emphasis">
                              <em>at least</em>
                           </span> 415 MB of free disk space available. Keep in mind also that disk space requirements will change with subsequent updates to the development repository.</p>
                     </dd>
                     <dt>
                        <span class="term">Java 1.5 or Higher</span>
                     </dt>
                     <dd>
                        <p>A working installation of Java 1.5 or higher is required in order to run Mobicents and the JBoss Application Server.</p>
                     </dd>
                     <dt>
                        <span class="term">A Download Utility</span>
                     </dt>
                     <dd>
                        <p>A way to download files. We will use the wget utility in the subsequent sections, but any common web browser will do.</p>
                     </dd>
                     <dt>
                        <span class="term">The Subversion Version Control System or Client</span>
                     </dt>
                     <dd>
                        <p>The Subversion Version Control System (<acronym class="acronym">VCS</acronym>) is required in order to check out the latest Mobicents source code. In addition to the command line client, there are a number of other clients that can be downloaded or installed via your package manager:</p>
                        <div class="itemizedlist">
                           <a name="itemlist-"/>
                           <ul>
                              <li>
                                 <h5 class="formalpara">Basic Subversion (the shell client)</h5>
                                 <p class="formalpara">If you are reasonably proficient on the command line, this is the only client you will need. You can get a binary version for your operating system here: <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://subversion.tigris.org/project_packages.html">http://subversion.tigris.org/project_packages.html</a>. Note that I will be using the command line (shell) Subversion client throughout this Guide.</p>
                              </li>
                              <li>
                                 <h5 class="formalpara">The Meld Diff and Merge Tool</h5>
                                 <p class="formalpara">On Linux and UNIX-based operating systems, Meld is the Swiss Army knife of version control tools. It can do 2- and 3-way diffs between files, diffs between directories, and also serves as a graphical <acronym class="acronym">VCS</acronym> front-end for Subversion, as well as Darcs, Git, Mercurial, Bazaar(-NG), Monotone, Perforce, CVS, and probably others. Note that you will need the basic Subversion shell client installed before Meld can function as a client. Meld is available from <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://meld.sourceforge.net/install.html">http://meld.sourceforge.net/install.html</a>.</p>
                              </li>
                              <li>
                                 <h5 class="formalpara">TortoiseSVN</h5>
                                 <p class="formalpara">A graphical Windows Subversion client which integrates with the Explorer file manager. Available from <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://tortoisesvn.tigris.org/">http://tortoisesvn.tigris.org/</a>.</p>
                              </li>
                              <li>
                                 <h5 class="formalpara">Other Subversion Clients</h5>
                                 <p class="formalpara">A full list of Subversion clients is available from <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://subversion.tigris.org/links.html">http://subversion.tigris.org/links.html</a> (look under the <code class="literal">Clients and plugins</code> subheading).</p>
                              </li>
                           </ul>
                        </div>
                     </dd>
                     <dt>
                        <span class="term">Ant, version 1.7.0 or Higher</span>
                     </dt>
                     <dd>
                        <p>The Java-based Ant build tool “<span class="quote">for tracking, resolving and managing project dependencies.</span>”, which is available here: <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://ant.apache.org/">http://ant.apache.org/</a>.</p>
                        <div class="note">
                           <a name="note-Both_Ant_and_Maven_Are_Required"/>
                           <h2>Both Ant and Maven Are Required!</h2>
                           <p>Both the Ant and Maven build tools are required in order to build the Mobicents Converged Application Server and deploy resource adapters, etc.</p>
                        </div>
                     </dd>
                     <dt>
                        <span class="term">Maven, version 2.0.6 or Higher</span>
                     </dt>
                     <dd>
                        <p>The Java-based Maven build and “<span class="quote">software project management and comprehension tool</span>”, available here: <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://maven.apache.org/">http://maven.apache.org/</a>.</p>
                     </dd>
                  </dl>
               </div>
               <p class="formalpara">
                  <a name="fpara-Downloading_and_Installing_the_Jboss_Binary_Distribution"/>
               </p>
               <h5 class="formalpara">Downloading and Installing the Jboss Binary Distribution</h5>
               <p class="formalpara">Once the pre-install requirements have been met, you are ready to start. We will split the entire procedure, which isn't long but may take a while depending on the speed of your Internet connection, into two parts: in the first we will install JBoss; in the second, we will download and build Mobicents.</p>
               <div class="procedure">
                  <a name="procedure-Downloading_and_Installing_JBoss"/>
                  <p class="title">
                     <b>Procedure 2.1. Downloading and Installing JBoss</b>
                  </p>
                  <ol class="1">
                     <li>
                        <p>First, move to the directory where you want to install JBoss and download the JBoss 4.2.2 General Availability (<acronym class="acronym">GA</acronym>) binary distribution<sup>[<a name="jboss_sourceforge_link" href="#ftn.jboss_sourceforge_link">3</a>]</sup>:</p>
                        <pre class="screen">cd &lt;directory_to_install_jboss_into&gt;
wget http://surfnet.dl.sourceforge.net/sourceforge/jboss/jboss-4.2.2.GA.zip</pre>
                     </li>
                     <li>
                        <p>Next, assuming you want to install JBoss in the same directory you have downloaded the zip file into, simply unzip it:</p>
                        <pre class="screen">unzip jboss-4.2.2.GA.zip</pre>
                     </li>
                     <li>
                        <p>Finally, we must set the <code class="envar">JBOSS_HOME</code> environment variable. The quick-and-easy way to set it for the current session, but which will not last beyond the next reboot, is to <code class="command">export</code> the variable on the command line, and then to <code class="command">echo</code> the variable to make sure that it contains the right directory. For example:</p>
                        <pre class="screen">export JBOSS_HOME="${PWD}/jboss-4.2.2.GA"
echo $JBOSS_HOME
/home/my_name/jboss/jboss-4.2.2.GA</pre>
                        <p>If the <code class="command">echo</code> command doesn't produce any output, make sure that you are in the directory into which you unzipped the JBoss binary distribution zip file, and that the name of that directory is correct in the <code class="command">export</code> command (i.e., that the file name hasn't changed in some subtle way).</p>
                        <p>Alternatively, you can set the <code class="envar">JBOSS_HOME</code> environment variable permanently in the startup file for your shell. If you are using the Bash shell, this would mean inserting the following line into your <code class="filename">~/.bashrc</code> startup file (remember to make sure that the path name, i.e. <code class="filename">&lt;unzip_directory&gt;</code>, is absolute!): </p>
                        <pre class="screen">export JBOSS_HOME="&lt;unzip_directory&gt;/jboss-4.2.2.GA"</pre>
                        <p>
				
                        </p>
                        <div class="important">
                           <a name="important-You_Must_Set_JBOSS_HOME_If_You_Are_Building_Mobicents_from_Source"/>
                           <h2>You Must Set JBOSS_HOME If You Are Building from Source</h2>
                           <p>The source distribution of Mobicents does not “<span class="quote">bundle</span>”, or come with, the JBoss Application Server, so you must remember to install it and set the environment variable. Conversely, the binary Mobicents distribution does come bundled with JBoss; therefore, if you are running Mobicents using the binary distribution, then you should <span class="emphasis">
                                 <em>not</em>
                              </span> set <code class="envar">JBOSS_HOME</code>.</p>
                        </div>
                     </li>
                  </ol>
               </div>
               <h5 class="formalpara">Downloading the Source and Building Mobicents</h5>
               <p class="formalpara">Now that that you have successfully installed the JBoss Application Server and set the <code class="envar">JBOSS_HOME</code> environment variable, we will next download the Mobicents source with Subversion and then build it.</p>
               <div class="procedure">
                  <a name="procedure-Downloading_the_Source_and_Building_Mobicents"/>
                  <ol class="1">
                     <li>
                        <p>First, move to a directory where you want to place the files for Mobicents, create a subdirectory named <code class="filename">mobicents</code> into which you will download everything, and then use Subversion to get the latest version of the sources:</p>
                        <pre class="screen">cd &lt;directory_to_install_mobicents_source_into&gt;
mkdir mobicents
svn co http://mobicents.googlecode.com/svn/trunk mobicents</pre>
                     </li>
                     <li>
                        <p>Building Mobicents from source is a simple affair consisting of issuing a <code class="command">mvn install</code> command in the <code class="filename">&lt;mobicents&gt;</code> directory into which you checked out the sources with Subversion (this directory is named <code class="filename">trunk</code> on the Google Code Subversion repository):</p>
                        <pre class="screen">cd &lt;mobicents&gt;
mvn install</pre>
                        <p>If the build command is successful, you will see a <code class="literal">BUILD SUCCESSFUL</code> message in the terminal:</p>
                        <pre class="programlisting">[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 22 seconds
[INFO] Finished at: Wed May 28 13:42:42 CEST 2008
[INFO] Final Memory: 17M/117M
[INFO] ------------------------------------------------------------------------</pre>
                        <p>On the other hand, if the build fails, you can either:</p>
                        <div class="itemizedlist">
                           <a name="itemlist-build_fails"/>
                           <ul>
                              <li>
                                 <p>Install and use the Mobicents binary distribution, at least for the time being.</p>
                              </li>
                              <li>
                                 <p>Wait a day or so and hope that the build failure is fixed in the Subversion sources. Update your copy of the sources by issuing a <code class="command">svn update</code> command in the <code class="filename">&lt;mobicents&gt;</code> directory and try to build by invoking the <code class="command">mvn install</code> command again.</p>
                              </li>
                              <li>
                                 <p>Create a new issue on the Google Code issue tracker, located at <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://code.google.com/p/mobicents/issues/list">http://code.google.com/p/mobicents/issues/list</a>.</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ol>
               </div>
               <p>TBD: Close with a sentence and direct the reader with a ulink to the Running Mobicents (which was installed from source) chapter. Issues that need to be addressed in this chapter include: installing GWT 1.3, which only comes in source for x86 (not version 1.4) and then building the management console.This chapter will have to be expanded with those instructions.</p>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Installing_EclipSLEE"/>2.3. Installing EclipSLEE: The JAIN SLEE Eclipse Plugin</h2>
                     </div>
                  </div>
               </div>
               <p>The Mobicents project's EclipSLEE Plugin for the Eclipse <acronym class="acronym">IDE</acronym> enables and facilitates working with Mobicents and JAIN SLEE. In particular, EclipSLEE is designed to help in the creation of the following <acronym class="acronym">JAIN SLEE</acronym> components:</p>
               <div class="itemizedlist">
                  <ul>
                     <li>
                        <p>Profile Specifications</p>
                     </li>
                     <li>
                        <p>Events</p>
                     </li>
                     <li>
                        <p>Service Building Blocks (<acronym class="acronym">SBB</acronym>s)</p>
                     </li>
                     <li>
                        <p>Service XML Descriptors</p>
                     </li>
                     <li>
                        <p>Deployable Units</p>
                     </li>
                  </ul>
               </div>
               <p>With the EclipSLEE plugin, developers can construct complete services quickly and easily. The plug-in takes care of ensuring that the XML descriptors are correct, as well as creating skeleton Java classes to which developers can add service logic.</p>
               <h5 class="formalpara">How to Install the EclipSLEE Eclipse Plugin</h5>
               <p class="formalpara">EclipSLEE can be installed simply by adding the URL of the Update site. In Eclipse, click on 
			<span>
                     <strong class="guimenu">Help</strong>
                  </span> → <span>
                     <strong class="guimenuitem">Software Updates</strong>
                  </span> → <span>
                     <strong class="guimenuitem">Find and Install...</strong>
                  </span>. The <code class="literal">Install/Update</code> dialog box will pop up. Choose the second option, <span>
                     <strong class="guimenuitem">Search for new features to install</strong>
                  </span>, and click next to be presented with the <code class="literal">Install</code> dialog. On the right-hand side, click the <span>
                     <strong class="guibutton">New Remote Site...</strong>
                  </span> button to be presented with the <code class="literal">New Update Site</code> dialog. For the Name field, enter <strong class="userinput">
                     <code>EclipSLEE</code>
                  </strong>, and in the <code class="literal">URL</code> field, enter the URL of the remote site: <strong class="userinput">
                     <code>http://people.redhat.com/vralev/eclipslee/update/</code>
                  </strong>. Press <span>
                     <strong class="guibutton">OK</strong>
                  </span> to return to the <code class="literal">Install</code> dialog. Check the just-added <code class="literal">EclipSLEE</code> site and click the <span>
                     <strong class="guibutton">Finish</strong>
                  </span> button. Eclipse will then prompt you to read and accept the license agreement, and will also ask you whether you want to install all components. After following the instructions of Eclipse's plugin install wizard, the EclipSLEE plugin will be downloaded and installed (usually to the shared Eclipse plugins directory, unless you have directed Eclipse to install to another location). Restarting Eclipse is required in order to initialize the EclipSLEE plugin so that it can be used.</p>
            </div>
            <div class="footnotes">
               <br/>
               <hr width="100" align="left"/>
               <div class="footnote">
                  <p>
                     <sup>[<a name="ftn.d0e513" href="#d0e513">2</a>] </sup>For the Mobicents 1.20 (<code class="literal">BETA3</code>) binary release, the relevant file names are <code class="filename">mobicents-all-1_2_0_BETA3.zip</code> and <code class="filename">mobicents-all-1_2_0_BETA3.zip.sha1.asc</code>.</p>
               </div>
               <div class="footnote">
                  <p>
                     <sup>[<a name="ftn.jboss_sourceforge_link" href="#jboss_sourceforge_link">3</a>] </sup>If the given direct link to JBoss 4.2.2 <acronym class="acronym">GA</acronym> doesn't work for you, the binary JBoss distribution can also be found at <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://surfnet.dl.sourceforge.net/sourceforge/jboss/">http://surfnet.dl.sourceforge.net/sourceforge/jboss/</a>, or by searching for the project on <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://sourceforge.net">Sourceforge.net</a>
						
                  </p>
               </div>
            </div>
         </div>
         <div class="chapter" lang="en-US">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title">
                        <a name="chapter-Running_Mobicents"/>Chapter 3. Running Mobicents</h2>
                  </div>
               </div>
            </div>
            <div class="toc">
               <dl>
                  <dt>
                     <span class="section">
                        <a href="#Running_the_Mobicents_Application_Server">3.1. Running the Mobicents Application Server</a>
                     </span>
                  </dt>
               </dl>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="Running_the_Mobicents_Application_Server"/>3.1. Running the Mobicents Application Server</h2>
                     </div>
                  </div>
               </div>
               <p>Once installed, running Mobicents simply consists in changing to the <code class="filename">
                     <em class="replaceable">
                        <code>&lt;topmost_mobicents_directory&gt;</code>
                     </em>/server/bin</code> directory and invoking <code class="command">run.sh</code> (Linux) or <code class="command">run.bat</code> (Windows) The precise instructions depend on which platform you are running Mobicents on.</p>
               <div class="variablelist">
                  <p class="title">
                     <b>Platform Mobicents is Running On</b>
                  </p>
                  <dl>
                     <dt>
                        <span class="term">Linux</span>
                     </dt>
                     <dd>
                        <div class="orderedlist">
                           <ol>
                              <li>
                                 <p>Change your working directory to the <code class="filename">
                                       <em class="replaceable">
                                          <code>&lt;topmost_mobicents_directory&gt;</code>
                                       </em>/server/bin</code> directory:</p>
                                 <pre class="screen">cd &lt;topmost_mobicents_directory&gt;/server/bin</pre>
                              </li>
                              <li>
                                 <p>Ensure that the <code class="filename">run.sh</code> file is executable. If it isn't, modify its permissions so that it is:</p>
                                 <pre class="screen">chmod +x run.sh</pre>
                              </li>
                              <li>
                                 <p>Finally, start the Mobicents Application Server:.</p>
                                 <pre class="screen">./run.sh</pre>
                                 <div class="note">
                                    <h2>Note</h2>
                                    <p>The above command is a shortened version of this equivalent command:</p>
                                    <pre class="screen">./run.sh -c all -b 127.0.0.1</pre>
                                 </div>
                              </li>
                           </ol>
                        </div>
                     </dd>
                     <dt>
                        <span class="term">Windows</span>
                     </dt>
                     <dd>
                        <div class="orderedlist">
                           <ol>
                              <li>
                                 <p>Change your working directory to the <code class="filename">
                                       <em class="replaceable">
                                          <code>&lt;mobicents_folder&gt;</code>
                                       </em>\server\bin</code> folder.</p>
                              </li>
                              <li>
                                 <p>Start the Mobicents Application Server:</p>
                                 <pre class="screen">run.bat</pre>
                                 <div class="note">
                                    <h2>Note</h2>
                                    <p>The above command is a shortened version of this equivalent command:</p>
                                    <pre class="screen">run.bat -c all -b 127.0.0.1</pre>
                                 </div>
                              </li>
                           </ol>
                        </div>
                     </dd>
                  </dl>
               </div>
            </div>
         </div>
         <div class="chapter" lang="en-US">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title">
                        <a name="chapter-Working_with_the_Mobicents_Management_Console"/>Chapter 4. Working with the Mobicents Management Console</h2>
                  </div>
               </div>
            </div>
            <p>Once Mobicents is running, you can access the management console by pointing your browser to <code class="systemitem">
                  <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://localhost:8080/management-console/">http://localhost:8080/management-console/</a>
		
               </code>. If you are working with a remote machine, replace <strong class="userinput">
                  <code>localhost</code>
               </strong> with the name of the remote machine's host, and <strong class="userinput">
                  <code>8080</code>
               </strong> with the correct port.</p>
            <p>The management console screen has the following components:</p>
            <div class="itemizedlist">
               <ul>
                  <li>
                     <p>The <code class="literal">Main Menu</code>, on the left.</p>
                  </li>
                  <li>
                     <p>The <code class="literal">Current View</code>, on the right.</p>
                  </li>
                  <li>
                     <p>The <code class="literal">Log Console</code>, on the bottom.</p>
                  </li>
               </ul>
            </div>
            <div class="figure">
               <a name="top-ss-mmc-initial_view.png"/>
               <div class="figure-contents">
                  <div class="mediaobject" align="center">
                     <img src="images/top-ss-mmc-initial_view.png" align="middle" alt="The Mobicents Management Console, initial view"/>
                  </div>
               </div>
               <p class="title">
                  <b>Figure 4.1. The Mobicents Management Console, initial view</b>
               </p>
            </div>
            <br class="figure-break"/>
            <p>New views my be selected by clicking on the <code class="literal">Main Menu</code> items. The <code class="literal">Log Console</code> displays important and relevant notifications when operations are executed, such as error and status messages.</p>
            <p>The initial management console view, which can also be accessed by clicking on <code class="literal">SLEE</code> at the top of the <code class="literal">Main Menu</code>, displays a status message indicating whether Mobicents is currently running or not, and provides controls to start, stop, and shut down the Mobicents Converged Application Server.</p>
            <h5 class="formalpara">
			
               <code class="literal">Deployable Units</code>
		
            </h5>
            <p class="formalpara">This view can be selected by clicking on <code class="literal">Deployable Units</code> from the Main Menu, and shows a list of all deployable units that can be deployed with the Mobicents Converged Application Server.</p>
            <div class="figure">
               <a name="figure-top-ss-mmc-deployable_units.png"/>
               <div class="figure-contents">
                  <div class="mediaobject" align="center">
                     <img src="images/top-ss-mmc-deployable_units.png" align="middle" alt="The Deployable Units view"/>
                  </div>
               </div>
               <p class="title">
                  <b>Figure 4.2. The <code class="literal">Deployable Units</code> view</b>
               </p>
            </div>
            <br class="figure-break"/>
            <p>A tab bar at the top of the view allows one to browse, search for, and install deployable units.</p>
            <h5 class="formalpara">
			
               <code class="literal">Components</code>
		
            </h5>
            <p class="formalpara">The next view on the Main Menu is the <code class="literal">Components</code> view, which displays a list of component types, such as services, <acronym class="acronym">SBB</acronym>s, resource adapters, <abbr class="abbrev">etc.</abbr>, and their current count. Clicking on a component type will cause the management console to show a list of components for that type. From there, you can click on the different components to see their details.</p>
            <div class="figure">
               <a name="figure-top-ss-mmc-components.png"/>
               <div class="figure-contents">
                  <div class="mediaobject" align="center">
                     <img src="images/top-ss-mmc-components.png" align="middle" alt="The Compenents view"/>
                  </div>
               </div>
               <p class="title">
                  <b>Figure 4.3. The <code class="literal">Compenents</code> view</b>
               </p>
            </div>
            <br class="figure-break"/>
            <h5 class="formalpara">
			
               <code class="literal">Services</code>
		
            </h5>
            <p class="formalpara">The <code class="literal">Services</code> view naturally shows the list of available services, their state, whether <code class="literal">ACTIVE</code> or <code class="literal">INACTIVE</code>, and all currently possible actions for that resource adapter, such as <code class="literal">activate</code>, <code class="literal">deactivate</code> or <code class="literal">remove</code>.</p>
            <div class="figure">
               <a name="figure-top-ss-mmc-services.png"/>
               <div class="figure-contents">
                  <div class="mediaobject" align="center">
                     <img src="images/top-ss-mmc-services.png" align="middle" alt="The Services view"/>
                  </div>
               </div>
               <p class="title">
                  <b>Figure 4.4. The <code class="literal">Services</code> view</b>
               </p>
            </div>
            <br class="figure-break"/>
            <p>The tab bar at the top of the <code class="literal">Services</code> view also allows you to control the usage parameters of services.</p>
            <h5 class="formalpara">
			
               <code class="literal">Resource Adapters</code>
		
            </h5>
            <p class="formalpara">Choosing <code class="literal">Resources</code> from the <code class="literal">Main Menu</code> will put the currently-deployed resource adapters in view. There, you can see their name, type, vendor and version. Clicking on one of the resource adapters will provide further information such as the name of the deployable unit, its state, whether <code class="literal">ACTIVE</code> or <code class="literal">INACTIVE</code>, and the currenty possible actions for specific services, such as activating, deactivating, or removing them.</p>
            <div class="figure">
               <a name="figure-top-ss-mmc-resources.png"/>
               <div class="figure-contents">
                  <div class="mediaobject" align="center">
                     <img src="images/top-ss-mmc-resources.png" align="middle" alt="The Resources view"/>
                  </div>
               </div>
               <p class="title">
                  <b>Figure 4.5. The <code class="literal">Resources</code> view</b>
               </p>
            </div>
            <br class="figure-break"/>
            <h5 class="formalpara">
			
               <code class="literal">Activity Contexts</code>
		
            </h5>
            <p class="formalpara">The Activity Contexts view can be displayed by clicking on <code class="literal">Activities</code> from the <code class="literal">Main Menu</code>, and shows the current activity contexts. The <code class="literal">TTL</code> field shows how much time the activity can remain idle before being marked for garbage collection.</p>
            <div class="figure">
               <a name="figure-top-ss-mmc-activities.png"/>
               <div class="figure-contents">
                  <div class="mediaobject" align="center">
                     <img src="images/top-ss-mmc-activities.png" align="middle" alt="The Activities view"/>
                  </div>
               </div>
               <p class="title">
                  <b>Figure 4.6. The <code class="literal">Activities</code> view</b>
               </p>
            </div>
            <br class="figure-break"/>
         </div>
         <div class="chapter" lang="en-US">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title">
                        <a name="chapter-Resource_Adapters"/>Chapter 5. Resource Adapters</h2>
                  </div>
               </div>
            </div>
            <div class="toc">
               <dl>
                  <dt>
                     <span class="section">
                        <a href="#section-Deploying_and_Undeploying_Resource_Adapters">5.1. Deploying and Undeploying Resource Adapters</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Before_You_Begin_Resource_Adapters_and_Deployable_Unit_Files">5.1.1. Before You Begin: Resource Adapters and Deployable Unit Files</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Deploying_Resource_Adapters">5.1.2. Deploying Resource Adapters</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Undeploying_Resource_Adapters">5.1.3. Undeploying Resource Adapters</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-SIP_Resource_Adapter">5.2. SIP Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_JAIN_SIP_Resource_Adapter">5.2.1. Installing the JAIN SIP Resource Adapter</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Configuration_of_the_JAIN_SIP_Resource_Adapter">5.2.2. Configuration of the JAIN SIP Resource Adapter</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-End-to-End_SIP_Example">5.2.3. Example: End-to-End SIP</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Wake-Up_Call_Example">5.2.4. Example: Wake-Up Call</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Third-Party_Call_Control_Example">5.2.5. Example: Third-Party Call Control</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Back-to-Back_User_Agent_Example">5.2.6. Example: Back-to-Back User Agent</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-The_XMPP_and_Google_Talk_Resource_Adapter">5.3. The XMPP and Google Talk Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Google_Talk_Bot_Example">5.3.1. Example: Google Talk Bot</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-Asterisk_Resource_Adapter">5.4. Asterisk Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_Asterisk_Resource_Adapter">5.4.1. Installing the Asterisk Resource Adapter</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-J2EE_and_CA_Resource_Adapter">5.5. J2EE and CA Resource Adapter</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-Diameter_Resource_Adapter">5.6. Diameter Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_Diameter_Resource_Adapter">5.6.1. Installing the Diameter Resource Adapter</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-Media_Resource_Adapter">5.7. Media Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_Media_Resource_Adapter">5.7.1. Installing the Media Resource Adapter</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-SMPP_Resource_Adapter">5.8. SMPP Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_SMPP_Resource_Adapter">5.8.1. Installing the SMPP Resource Adapter</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-Media_Gateway_Resource_Adapter">5.9. Media Gateway Resource Adapter</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-JCC_INAP_Resource_Adapter">5.10. JCC INAP Resource Adapter</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-HTTP_Servlet_Resource_Adapter">5.11. HTTP Servlet Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_HTTP_Servlet_Resource_Adapter">5.11.1. Installing the HTTP Servlet Resource Adapter</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Understanding_the_HTTP_Servlet_Resource_Adapter">5.11.2. Understanding the HTTP Servlet Resource Adapter</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-HTTP_Client_Resource_Adapter">5.12. The HTTP Client Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_HTTP_Client_Resource_Adapter">5.12.1. Installing the HTTP Client Resource Adapter</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Understanding_the_HTTP_Client_Resource_Adapter">5.12.2. Understanding the HTTP Client Resource Adapter</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-Persistence_Resource_Adapter">5.13. Persistence Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_Persistence_Resource_Adapter">5.13.1. Installing the Persistence Resource Adapter</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-XCAP_Client_Resource_Adapter">5.14. XCAP Client Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_XCAP_Client_Resource_Adapter">5.14.1. Installing the XCAP Client Resource Adapter</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-Rules_Resource_Adapter">5.15. Rules Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_Rules_Resource_Adapter">5.15.1. Installing the Rules Resource Adapter</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-TTS_Resource_Adapter">5.16. TTS Resource Adapter</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_the_TTS_Resource_Adapter">5.16.1. Installing the TTS Resource Adapter</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-SAP_Resource_Adapter">5.17. SAP Resource Adapter</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-Third-Party_Resource_Adapters">5.18. Third-Party Resource Adapters</a>
                     </span>
                  </dt>
               </dl>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Deploying_and_Undeploying_Resource_Adapters"/>5.1. Deploying and Undeploying Resource Adapters</h2>
                     </div>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Before_You_Begin_Resource_Adapters_and_Deployable_Unit_Files"/>5.1.1. Before You Begin: Resource Adapters and Deployable Unit Files</h3>
                        </div>
                     </div>
                  </div>
                  <p>Resource adapters are JAIN SLEE components that can be deployed (i.e. “<span class="quote">loaded</span>” or “<span class="quote">installed</span>”) into the Mobicents Converged Application Server, and undeployed (“<span class="quote">uninstalled</span>”) from it. At the file level, resource adapters consist of specially-named files called deployable unit files. Two of these deployable unit files must be loaded/installed before the Mobicents Converged Application Server will deploy the resource adapter. The next few sections will teach you how to locate where resource adapters and their files live, and how to deploy them and undeploy them through several different, though equivalent ways: via the command line; by copying the correct files to a special directory, or removing them from it; or with the Mobicents Management Console.</p>
                  <p>Which of these various ways of accomplishing the same task is easier depends on you. If you are comfortable with the command line, or like to script behavior, then deploying via the command line will probably be the preferred way for you. If you would prefer to simply copy or delete some files with the file manager, you can do it that way. And for those who prefer graphical user interfaces (<acronym class="acronym">GUI</acronym>s), the Management Console provides an interface to the Mobicents Converged Application Server, and can easily be used to accomplish such tasks both locally and remotely. Note that if you are running Mobicents on the Windows platform, then you will want to deploy resource adapters by either copying files or using the Management Console. However, no matter which method you eventually choose, it will be necessary to read the following explanatory paragraphs, on where to find the directories corresponding to the resource adapters you want to install, and on how to recognize deployable unit files, and on the correct order in which to install the deployable unit files, before reading any or all of the method sections.</p>
                  <p class="formalpara">
                     <a name="fpara-Where_to_Find_Resource_Adapters_in_the_Mobicents_Installation"/>
                  </p>
                  <h5 class="formalpara">Where to Find Resource Adapters in the Mobicents Installation</h5>
                  <p class="formalpara">The files belonging to resource adapters, and which you will need to access in order to deploy and undeploy them, are located in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code>. It is trivial to figure out which directory in <code class="filename">resources</code> corresponds to the resource adapter that you wish to deploy or undeploy. For example, the <code class="filename">sipra</code> directory holds the files necessary for running the <acronym class="acronym">SIP</acronym> resource adapter, and the <code class="filename">xmppra</code> directory holds the <acronym class="acronym">XMPP</acronym> and Google Talk resource adapter.</p>
                  <p class="formalpara">
                     <a name="fpara-How_to_Recognize_Deployable_Unit_Files"/>
                  </p>
                  <h5 class="formalpara">How to Recognize Deployable Unit Files</h5>
                  <p class="formalpara">Deployable unit files are <acronym class="acronym">JAR</acronym> (Java ARchive) files. There are two deployable unit files in each resource adapter's directory. The following two patterns describe the file names:</p>
                  <div class="variablelist">
                     <a name="varlist-Deployable_Unit_File_Name_Conventions"/>
                     <p class="title">
                        <b>Deployable Unit File Name Conventions</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">
					
                              <code class="filename">
						
                                 <em class="replaceable">
                                    <code>&lt;resource_adapter_abbreviation&gt;</code>
                                 </em>-ra-DU.jar</code>
				
                           </span>
                        </dt>
                        <dd>
                           <p>...where <span class="emphasis">
                                 <em>ra</em>
                              </span> stands for “<span class="quote">resource adapter</span>”, and <span class="emphasis">
                                 <em>DU</em>
                              </span> stands for "Deployable Unit (file). For example, if we want to deploy the <acronym class="acronym">SIP</acronym> resource adapter, and we are located in <code class="filename">
                                 <em class="replaceable">
                                    <code>&lt;topmost_mobicents_directory&gt;</code>
                                 </em>/resources/sipra</code>, then this deployable unit file will be named <code class="filename">sip-ra-DU.jar</code>.</p>
                        </dd>
                        <dt>
                           <span class="term">
					
                              <code class="filename">
						
                                 <em class="replaceable">
                                    <code>&lt;resource_adapter_abbreviation&gt;</code>
                                 </em>-ratype-DU.jar</code>
				
                           </span>
                        </dt>
                        <dd>
                           <p>...where <span class="emphasis">
                                 <em>ratype</em>
                              </span> stands intuitively for “<span class="quote">resource adapter type</span>”, and <span class="emphasis">
                                 <em>DU</em>
                              </span> again for “<span class="quote">Deployable Unit (file)</span>”. The file name for the “<span class="quote">ratype</span>” deployable unit file for the <acronym class="acronym">SIP</acronym> resource adapter is therefore <code class="filename">sip-ratype-DU.jar</code>.</p>
                        </dd>
                     </dl>
                  </div>
                  <p class="formalpara">
                     <a name="fpara-How_to_Determine_the_Correct_Order_for_Installing_Deployable_Unit_Files"/>
                  </p>
                  <h5 class="formalpara">How to Determine the Correct Order for Installing Deployable Unit Files</h5>
                  <p class="formalpara">Deployable unit files must be installed in a certain order, starting with the <span class="emphasis">
                        <em>ratype</em>
                     </span> deployable unit file, whose file name has the form: <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter_abbreviation&gt;</code>
                        </em>-ratype-DU.jar</code>.</p>
                  <p>The second (and last) deployable unit file you must install is the <span class="emphasis">
                        <em>ra</em>
                     </span> file: <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter_abbreviation&gt;</code>
                        </em>-ra-DU.jar</code>.</p>
                  <p>For example, if you wanted to deploy the SIP resource adapter, then you would want to first install the deployable unit file named <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter_abbreviation&gt;</code>
                        </em>-ratype-DU.jar</code>, followed by the <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter_abbreviation&gt;</code>
                        </em>-ra-DU.jar</code> file. </p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Deploying_Resource_Adapters"/>5.1.2. Deploying Resource Adapters</h3>
                        </div>
                     </div>
                  </div>
                  <div class="note">
                     <h2>Note</h2>
                     <p>The introductory section titled <a href="#section-Before_You_Begin_Resource_Adapters_and_Deployable_Unit_Files" title="5.1.1. Before You Begin: Resource Adapters and Deployable Unit Files">Section 5.1.1, “Before You Begin: Resource Adapters and Deployable Unit Files”</a> should be read before proceeding to one of the following sections.</p>
                  </div>
                  <p>
			
                     <a href="#section-Deploying_Resource_Adapters_Via_the_Command_Line" title="5.1.2.1. Deploying Resource Adapters Via the Command Line">Section 5.1.2.1, “Deploying Resource Adapters Via the Command Line”</a>
		
                  </p>
                  <p>
			
                     <a href="#section-Deploying_Resource_Adapters_By_Copying_Deployable_Unit_Files" title="5.1.2.2. Deploying Resource Adapters By Copying Deployable Unit Files">Section 5.1.2.2, “Deploying Resource Adapters By Copying Deployable Unit Files”</a>
		
                  </p>
                  <p>
				
                     <a href="#section-Deploying_Resource_Adapters_With_the_Management_Console" title="5.1.2.3. Deploying Resource Adapters With the Management Console">Section 5.1.2.3, “Deploying Resource Adapters With the Management Console”</a>
			
                  </p>
                  <div class="section" lang="en-US">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title">
                                 <a name="section-Deploying_Resource_Adapters_Via_the_Command_Line"/>5.1.2.1. Deploying Resource Adapters Via the Command Line</h4>
                           </div>
                        </div>
                     </div>
                     <p>Resource adapters can be deployed by simply issuing an ant task command from the topmost Mobicents directory. Make sure that the Mobicents Converged Application Server has been started, and then change to the topmost directory:</p>
                     <pre class="screen">cd &lt;topmost_mobicents_directory&gt;</pre>
                     <p>Run the ant build-and-deploy script, remembering to replace <code class="filename">
                           <em class="replaceable">
                              <code>&lt;resource_adapter&gt;</code>
                           </em>
				
                        </code> with the correct directory name (refer to <a href="#fpara-Where_to_Find_Resource_Adapters_in_the_Mobicents_Installation" title="Where to Find Resource Adapters in the Mobicents Installation">Where to Find Resource Adapters in the Mobicents Installation</a> if you are unsure):</p>
                     <pre class="screen">tools/ant/bin/ant -f resources/&lt;resource_adapter&gt;/build.xml ra-deploy</pre>
                     <p>For example, the directory name in <code class="filename">
                           <em class="replaceable">
                              <code>&lt;topmost_mobicents_directory&gt;</code>
                           </em>/resources</code> corresponding to the JAIN SIP resource adapter is (currently) named <code class="filename">sipra</code> ("SIP Resource Adapter"). To deploy the SIP resource adapter, therefore, you would issue the following command:</p>
                     <pre class="screen">tools/ant/bin/ant -f resources/sipra/build.xml ra-deploy</pre>
                     <p>If the resource adapter builds successfully, then a message similar to the following will be written to standard output:</p>
                     <pre class="screen">ra-activate:

ra-deploy:

BUILD SUCCESSFUL
Total time: 5 seconds</pre>
                     <p>To undeploy a resource adapter via the command line, refer to <a href="#section-Undeploying_Resource_Adapters_Via_the_Command_Line" title="5.1.3.1. Undeploying Resource Adapters Via the Command Line">Section 5.1.3.1, “Undeploying Resource Adapters Via the Command Line”</a>.</p>
                  </div>
                  <div class="section" lang="en-US">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title">
                                 <a name="section-Deploying_Resource_Adapters_By_Copying_Deployable_Unit_Files"/>5.1.2.2. Deploying Resource Adapters By Copying Deployable Unit Files</h4>
                           </div>
                        </div>
                     </div>
                     <p>It is essential to have read the previous sections on locating resource adapter directories, recognizing deployable unit files, and determining the correct order for installing the files, before continuing. See <a href="#section-Before_You_Begin_Resource_Adapters_and_Deployable_Unit_Files" title="5.1.1. Before You Begin: Resource Adapters and Deployable Unit Files">Section 5.1.1, “Before You Begin: Resource Adapters and Deployable Unit Files”</a>.</p>
                     <p>You can deploy resource adapters by simply copying deployable unit files to a special directory with your file manager, or by doing the same via the command line. These instructions assume that you are using the file manager. You can also copy the two necessary files simultaneously, or one-after-the-other in the correct order, which is the way we will do it.</p>
                     <div class="warning">
                        <h2>Warning</h2>
                        <p>Make sure that you <span class="emphasis">
                              <em>copy</em>
                           </span> the deployable unit files, instead of <span class="emphasis">
                              <em>moving</em>
                           </span> them. If you accidentally move them, then make sure you copy them back to the correct resource adapter directory where they came from. If you accidentally move them and then delete them, you will probably have to reinstall Mobicents, so be careful to copy instead of move!</p>
                     </div>
                     <p>Open your file manager and move to the directory corresponding to the resource adapter you want to deploy. Find the <code class="filename">
                           <em class="replaceable">
                              <code>&lt;resource_adapter_abbreviation&gt;</code>
                           </em>-ratype-DU.jar</code> file and copy it.</p>
                     <div class="figure">
                        <a name="figure-top-deploying-ss-selecting_the_ratype_dependency.png"/>
                        <div class="figure-contents">
                           <div class="mediaobject" align="center">
                              <img src="images/top-deploying-ss-selecting_the_ratype_dependency.png" align="middle" alt="Locating and Copying the First Deployable Unit File"/>
                              <div class="caption">
                                 <p>Copying the first deployable unit file, the ratype file, in order to deploy the SIP resource adatper.</p>
                              </div>
                           </div>
                        </div>
                        <p class="title">
                           <b>Figure 5.1. Locating and Copying the First Deployable Unit File</b>
                        </p>
                     </div>
                     <br class="figure-break"/>
                     <div class="mediaobject" align="center">
                        <a name="mediaobj-top-deploying-ss-selecting_the_ratype_dependency.png"/>
                        <img src="images/top-deploying-ss-selecting_the_ratype_dependency.png" align="middle"/>
                        <div class="caption">
                           <p>Copying the first deployable unit file, the ratype file, in order to deploy the SIP resource adatper.</p>
                        </div>
                     </div>
                     <p>Where you will paste it to depends on whether you installed the Mobicents binary release, or built Mobicents from source. If you installed the binary version, then the correct directory to copy the files into is <code class="filename">
                           <em class="replaceable">
                              <code>&lt;topmost_mobicents_directory&gt;</code>
                           </em>/server/server/default/deploy</code> (remembering that the bundled JBoss installation that comes with the binary Mobicents release is located in <code class="filename">
                           <em class="replaceable">
                              <code>&lt;topmost_mobicents_directory&gt;</code>
                           </em>/server/server/default</code>; you are actually copying the file into JBoss's <code class="filename">deploy</code> directory). If, on the other hand, you installed Mobicents and JBoss separately and set the <code class="envar">JBOSS_HOME</code> environment variable, then the correct directory to copy the file to is <code class="filename">
                           <code class="envar">$JBOSS_HOME</code>/deploy</code>.</p>
                     <p>After copying the <span class="emphasis">
                           <em>ratype</em>
                        </span> deployable unit file, Mobicents will send a message like the following to standard output, indicating that the file was successfully installed.</p>
                     <pre class="screen">19:59:03,651 INFO  [RaTypeDeployer] Added RA Type with id ResourceAdaptorTypeID[JAIN SIP#javax.sip#1.2]
19:59:03,683 INFO  [STDOUT] 19:59:03,682 INFO  [DeploymentMBeanImpl] Deployable unit with URL file:/home/silas/Desktop/temp/apps/mobicents/mobicents-all-1_2_0_BETA2/server/server/default/deploy/sip-ratype-DU.jar deployed as DeployableUnitID[0]</pre>
                     <p>After successfully copying the <code class="filename">
                           <em class="replaceable">
                              <code>&lt;resource_adapter_abbreviation&gt;</code>
                           </em>-ratype-DU.jar</code> file, proceed to copy the <code class="filename">
                           <em class="replaceable">
                              <code>&lt;resource_adapter_abbreviation&gt;</code>
                           </em>-ra-DU.jar</code> file to the same directory. Copying the <span class="emphasis">
                           <em>ra</em>
                        </span> file (after the <span class="emphasis">
                           <em>ratype</em>
                        </span> file, of course) will lead to successful installation of the resource adapter, and the Mobicents Converged Application Server will output information similar to the following to standard output:</p>
                     <pre class="screen">19:59:59,940 INFO  [STDOUT] 19:59:59,940 INFO  [ResourceManagementMBeanImpl] Activated RA Entity SipRA
20:00:00,191 INFO  [STDOUT] 20:00:00,190 INFO  [ResourceManagementMBeanImpl] Created Link between RA Entity SipRA and Name SipRA</pre>
                     <p>The easier way is simply to select and copy both deployable unit files and paste them simultaneously into <code class="filename">
                           <em class="replaceable">
                              <code>&lt;topmost_mobicents_directory&gt;</code>
                           </em>/server/server/default/deploy</code> (or <code class="filename">
                           <code class="envar">$JBOSS_HOME</code>/deploy</code> if you installed JBoss separately). When you do it that way, Mobicents can figure out in which order it should install the files.</p>
                     <p>To undeploy a resource adapter by removing or deleting deployable unit files, refer to <a href="#section-Undeploying_Resource_Adapters_By_Removing_Files" title="5.1.3.2. Undeploying Resource Adapters By Removing Files">Section 5.1.3.2, “Undeploying Resource Adapters By Removing Files”</a>.</p>
                  </div>
                  <div class="section" lang="en-US">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title">
                                 <a name="section-Deploying_Resource_Adapters_With_the_Management_Console"/>5.1.2.3. Deploying Resource Adapters With the Management Console</h4>
                           </div>
                        </div>
                     </div>
                     <p>The Mobicents Management Console provides a graphical way to deploy and undeploy resource adapters. This section requires that you are familiar with the Management Console; for an introduction to the Console, refer first to <a href="#chapter-Working_with_the_Mobicents_Management_Console" title="Chapter 4. Working with the Mobicents Management Console">Chapter 4, <i xmlns:xlink="http://www.w3.org/1999/xlink">Working with the Mobicents Management Console</i>
                        </a>.</p>
                     <div class="important">
                        <h2>Important</h2>
                        <p>The following instructions also assume that you have already read introductory sections on locating resource adapter directories, recognizing deployable unit files, and determining their correct order for installation. It is essential to read those sections before attempting to deploy a resource adapter with the Management Console. See <a href="#section-Before_You_Begin_Resource_Adapters_and_Deployable_Unit_Files" title="5.1.1. Before You Begin: Resource Adapters and Deployable Unit Files">Section 5.1.1, “Before You Begin: Resource Adapters and Deployable Unit Files”</a>
				
                        </p>
                     </div>
                     <p>Once the Mobicents Converged Application Server is running, point your browser to <code class="systemitem">
                           <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://localhost:8080/management-console/">http://localhost:8080/management-console/</a>
				
                        </code> to open the Management Console. Click on <span>
                           <strong class="guimenuitem">Deployable Units</strong>
                        </span> in the Main Menu; this will open the <span>
                           <strong class="guilabel">Deployable Units</strong>
                        </span> main view, where you will see a list of currently-deployed units under the <span>
                           <strong class="guimenuitem">Browse</strong>
                        </span> tab, which will read <code class="literal">No deployable unit found</code> at first. Two other tabs provide the possibility of searching for and installing deployable units. Click on the <span>
                           <strong class="guimenuitem">Install</strong>
                        </span> tab, and you will see a <span>
                           <strong class="guilabel">Package file:</strong>
                        </span> prompt and a text-entry field in which the name of the deployable unit file you want to install will be listed. <em>
                           <span class="remark">But first we must locate the correct deployable unit file, so click the <span>
                                 <strong class="guibutton">Browse</strong>
                              </span> button to the right of the text-entry field.</span>
                        </em>
			
                     </p>
                     <div class="figure">
                        <a name="figure-top-deploying-ss-install.png"/>
                        <div class="figure-contents">
                           <div class="mediaobject" align="center">
                              <img src="images/top-deploying-ss-install.png" align="middle" alt="The Install tab of the Deployable Units view in the Management Console"/>
                           </div>
                        </div>
                        <p class="title">
                           <b>Figure 5.2. The Install tab of the Deployable Units view in the Management Console</b>
                        </p>
                     </div>
                     <br class="figure-break"/>
                     <p>Before continuing, make sure that you know which deployable unit file to install first by reading the section titled <a href="#fpara-How_to_Determine_the_Correct_Order_for_Installing_Deployable_Unit_Files" title="How to Determine the Correct Order for Installing Deployable Unit Files">How to Determine the Correct Order for Installing Deployable Unit Files</a>.</p>
                     <p>Once armed with this knowledge, click the <span>
                           <strong class="guibutton">Browse</strong>
                        </span> button to find and install the first deployable unit file, whose file name will appear in the text entry field, and then click the <span>
                           <strong class="guibutton">Install</strong>
                        </span> button. Then install the second deployable unit file. If you install the files in the incorrect order, a message similar to the following will appear in the <span>
                           <strong class="guilabel">Log Console</strong>
                        </span> at the bottom of the Management Console main view:</p>
                     <pre class="screen">[ERROR] javax.slee.management.DeploymentException: Could not deploy: No DeployableUniDeploymentDescriptor descriptor (META-INF/deployable-unit.xml) was found in deployable...</pre>
                     <p>If you receive this error message, try installing the other deployable unit file first. Installing the right files in the correct order will lead to <code class="computeroutput">[INFO] Deployable unit installed</code> messages in the <span>
                           <strong class="guilabel">Log Console</strong>
                        </span>.</p>
                     <p>If you see the name of the resource adapter you wanted to install listed in the <span>
                           <strong class="guimenuitem">Resources</strong>
                        </span> view of the Management Console, then that resource adapter has been successfully deployed.</p>
                     <div class="figure">
                        <a name="figure-top-deploying-ss-installation_success.png"/>
                        <div class="figure-contents">
                           <div class="mediaobject" align="center">
                              <img src="images/top-deploying-ss-installation_success.png" align="middle" alt="Successful Deployment of the SIP Resource Adapter with the Mobicents Management Console"/>
                           </div>
                        </div>
                        <p class="title">
                           <b>Figure 5.3. Successful Deployment of the SIP Resource Adapter with the Mobicents Management Console</b>
                        </p>
                     </div>
                     <br class="figure-break"/>
                     <p>To undeploy a resource adapter with the Management Console, refer to <a href="#section-Undeploying_Resource_Adapters_With_the_Management_Console" title="5.1.3.3. Undeploying Resource Adapters With the Management Console">Section 5.1.3.3, “Undeploying Resource Adapters With the Management Console”</a>.</p>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Undeploying_Resource_Adapters"/>5.1.3. Undeploying Resource Adapters</h3>
                        </div>
                     </div>
                  </div>
                  <div class="note">
                     <h2>Note</h2>
                     <p>The introductory section titled <a href="#section-Before_You_Begin_Resource_Adapters_and_Deployable_Unit_Files" title="5.1.1. Before You Begin: Resource Adapters and Deployable Unit Files">Section 5.1.1, “Before You Begin: Resource Adapters and Deployable Unit Files”</a> should be read before proceeding to one of the following sections.</p>
                  </div>
                  <p>
			
                     <a href="#section-Undeploying_Resource_Adapters_Via_the_Command_Line" title="5.1.3.1. Undeploying Resource Adapters Via the Command Line">Section 5.1.3.1, “Undeploying Resource Adapters Via the Command Line”</a>
		
                  </p>
                  <p>
			
                     <a href="#section-Undeploying_Resource_Adapters_By_Removing_Files" title="5.1.3.2. Undeploying Resource Adapters By Removing Files">Section 5.1.3.2, “Undeploying Resource Adapters By Removing Files”</a>
		
                  </p>
                  <p>
			
                     <a href="#section-Undeploying_Resource_Adapters_With_the_Management_Console" title="5.1.3.3. Undeploying Resource Adapters With the Management Console">Section 5.1.3.3, “Undeploying Resource Adapters With the Management Console”</a>
		
                  </p>
                  <div class="section" lang="en-US">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title">
                                 <a name="section-Undeploying_Resource_Adapters_Via_the_Command_Line"/>5.1.3.1. Undeploying Resource Adapters Via the Command Line</h4>
                           </div>
                        </div>
                     </div>
                     <p>It is as easy to undeploy resource adapters via the command line as it is to deploy them that way: by simply issuing an ant task command from the topmost Mobicents directory, after the Mobicents Converged Application Server has been started, of course.</p>
                     <pre class="screen">cd &lt;topmost_mobicents_directory&gt;</pre>
                     <p>You will run the same ant script that you ran to build and deploy the resource adapter, but note that the last argument has changed from <code class="option">ra-deploy</code> to <code class="option">ra-undeploy</code>:</p>
                     <pre class="screen">tools/ant/bin/ant -f resources/&lt;resource_adapter&gt;/build.xml ra-undeploy</pre>
                     <p>For example, to undeploy the SIP resource adapter you would issue the following command:</p>
                     <pre class="screen">tools/ant/bin/ant -f resources/sipra/build.xml ra-undeploy</pre>
                     <p>Upon success, a message similar to the following will be written to standard output:</p>
                     <pre class="screen">ra-uninstall:
     [echo] Uninstalling SipRA.
[slee-management] Apr 8, 2008 8:49:12 PM org.mobicents.ant.tasks.UninstallTask run
[slee-management] INFO: No response
[slee-management] Apr 8, 2008 8:49:12 PM org.mobicents.ant.tasks.UninstallTask run
[slee-management] INFO: No response

ra-undeploy:

BUILD SUCCESSFUL
Total time: 2 seconds</pre>
                  </div>
                  <div class="section" lang="en-US">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title">
                                 <a name="section-Undeploying_Resource_Adapters_By_Removing_Files"/>5.1.3.2. Undeploying Resource Adapters By Removing Files</h4>
                           </div>
                        </div>
                     </div>
                     <p>If you deployed a resource adapter by copying the deployable unit files from the resource adapter's directory to the <code class="filename">
                           <em class="replaceable">
                              <code>&lt;topmost_jboss_directory&gt;</code>
                           </em>/deploy</code> directory<sup>[<a name="d0e1633" href="#ftn.d0e1633">4</a>]</sup>, then you can undeploy that same resource adapter merely by removing the two deployable unit files from the <code class="filename">deploy</code> directory. In the file manager or on the command line, simply go to <code class="filename">
                           <em class="replaceable">
                              <code>&lt;topmost_jboss_directory&gt;</code>
                           </em>/deploy</code>  and either move the correct two deployable unit files out of it, or delete both of them from it.</p>
                     <div class="warning">
                        <a name="warning-Dont_Delete_if_You_Didnt_Copy"/>
                        <h2>Don't Delete if You Didn't Copy!</h2>
                        <p>If you choose to delete the two deployable unit files, <span class="emphasis">
                              <em>make sure</em>
                           </span> that you indeed <span class="emphasis">
                              <em>copied</em>
                           </span> them into the <code class="filename">deploy</code> directory, and that they both still exist in the directory of the resource adapter you want to undeploy!</p>
                     </div>
                     <p>Successfully removing or deleting both files from the <code class="filename">deploy</code> directory will result in a long string of messages sent to standard output, and ending with a line similar to: <code class="computeroutput">17:48:10,705 INFO  [STDOUT] 17:48:10,705 INFO  [DeploymentMBeanImpl] Uninstalled DU with id DeployableUnitID[6]</code>. It is also possible to simply remove or delete only the <code class="filename">
                           <em class="replaceable">
                              <code>&lt;resource_adapter_abbreviation&gt;</code>
                           </em>-ra-DU.jar</code> file and have Mobicents undeploy the resource adapter, but it is recommended to always remove or delete both files.</p>
                     <div class="note">
                        <a name="note-Leaving_Resource_Adapters_Deployed"/>
                        <h2>Leaving Resource Adapters Deployed</h2>
                        <p>One convenient way to have the Mobicents Converged Application Server deploy the correct resource adapters every time you start the server is to leave the deployable unit files in the <code class="filename">
                              <em class="replaceable">
                                 <code>&lt;topmost_jboss_directory&gt;</code>
                              </em>/deploy</code> directory. Upon startup, Mobicents will notice that the two files are still there, and will automatically deploy the resource adapter.</p>
                     </div>
                  </div>
                  <div class="section" lang="en-US">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h4 class="title">
                                 <a name="section-Undeploying_Resource_Adapters_With_the_Management_Console"/>5.1.3.3. Undeploying Resource Adapters With the Management Console</h4>
                           </div>
                        </div>
                     </div>
                     <p>If you are looking to undeploy a resource adapter with the Management Console, then it is assumed that you have first read <a href="#section-Before_You_Begin_Resource_Adapters_and_Deployable_Unit_Files" title="5.1.1. Before You Begin: Resource Adapters and Deployable Unit Files">Section 5.1.1, “Before You Begin: Resource Adapters and Deployable Unit Files”</a> and <a href="#section-Deploying_Resource_Adapters_With_the_Management_Console" title="5.1.2.3. Deploying Resource Adapters With the Management Console">Section 5.1.2.3, “Deploying Resource Adapters With the Management Console”</a>. </p>
                     <p>You can undeploy resource adapters from the <span>
                           <strong class="guilabel">Deployable Units</strong>
                        </span> view in the Management Console by uninstalling the two deployable unit files. Click on <span>
                           <strong class="guimenuitem">Deployable Units</strong>
                        </span> from the Main Menu, and then make sure that the <span>
                           <strong class="guimenuitem">Browse</strong>
                        </span> tab is selected at the top of the view. You will see a list of deployable unit files for the currently-installed resource adapters.</p>
                     <div class="figure">
                        <a name="figure-Uninstalling_Deployable_Unit_Files_with_the_Management_Console"/>
                        <div class="figure-contents">
                           <div class="mediaobject" align="center">
                              <img src="images/top-deploying-ss-uninstalling.png" align="middle" alt="Uninstalling Deployable Unit Files with the Management Console"/>
                              <div class="caption">
                                 <p>The Browse tab of the Deployable Units view shows all deployable unit files for all resource adapters that are currently deployed</p>
                              </div>
                           </div>
                        </div>
                        <p class="title">
                           <b>Figure 5.4. Uninstalling Deployable Unit Files with the Management Console</b>
                        </p>
                     </div>
                     <br class="figure-break"/>
                     <p>Find the deployable unit file that corresponds to the <code class="filename">
                           <em class="replaceable">
                              <code>&lt;resource_adapter_abbreviation&gt;</code>
                           </em>-ra-DU.jar</code> pattern, and click on the <span>
                           <strong class="guilabel">Uninstall</strong>
                        </span> link in the <span>
                           <strong class="guilabel">Actions</strong>
                        </span> column. This will uninstall the file, and a message similar to <code class="computeroutput">[INFO] Deployable unit sip-ra-DU uninstalled</code> will appear in the <span>
                           <strong class="guilabel">Console Log</strong>
                        </span> below. After uninstalling the <span class="emphasis">
                           <em>ra</em>
                        </span> file, then uninstall the <code class="filename">
                           <em class="replaceable">
                              <code>&lt;resource_adapter_abbreviation&gt;</code>
                           </em>-ratype-DU.jar</code> file, which will print a success message like the previous one to the <span>
                           <strong class="guilabel">Console Log</strong>
                        </span>.</p>
                     <p>If you try to uninstall the <span class="emphasis">
                           <em>ratype</em>
                        </span> deployable unit file before the <span class="emphasis">
                           <em>ra</em>
                        </span> file, then you will receive a message similar to the following one, alerting you to the mistake: <code class="computeroutput">[ERROR] javax.slee.management.ManagementException: Exception removing deployable Unit</code>.</p>
                  </div>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-SIP_Resource_Adapter"/>5.2. SIP Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p class="formalpara">
                  <a name="fpara-Introduction_to_the_SIP_Resource_Adapter"/>
               </p>
               <h5 class="formalpara">Introduction to the SIP Resource Adapter</h5>
               <p class="formalpara">The Mobicents <acronym class="acronym">SIP</acronym> resource adapter is a Mobicents sub-project that aims to create a high-performance <acronym class="acronym">SLEE </acronym> extenson for the Session Iniation Protocol (<acronym class="acronym">SIP</acronym>).</p>
               <p>The most recent version of the <acronym class="acronym">SIP</acronym> resource adapter includes several enhancements which allow for more convenient development of <acronym class="acronym">SIP</acronym> resources for a wide range of applications. The type name of this latest version is <code class="literal">JSIP v1.2</code>, the type vendor is <code class="literal">net.java.slee.sip</code>, and the type version is <code class="literal">1.2</code>.</p>
               <p class="formalpara">
                  <a name="fpara-The_JAIN_SIP_Resource_Adapter_Version_1.1"/>
               </p>
               <h5 class="formalpara">The JAIN SIP Resource Adapter Version 1.1</h5>
               <p class="formalpara">In Java Specification Request 22 (JSR-22), this resource adapter type name is denoted as <code class="literal">JAIN SIP</code>, and the type vendor as <code class="literal">javax.sip</code>. This resource adapter type version is 1.1. Mobicents provides a fully-compliant implementation of this specification.</p>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_JAIN_SIP_Resource_Adapter"/>5.2.1. Installing the JAIN SIP Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>To install the JAIN SIP Resource Adapter, you must first acquire the latest version. Navigate to the <a xmlns:xlink="http://www.w3.org/1999/xlink" href="https://sourceforge.net/projects/mobicents">Mobicents Sourceforge project page</a> and click on the <span class="emphasis">
                        <em>Download Mobicents</em>
                     </span> link. On the next page, click on the <span class="emphasis">
                        <em>SLEE SIP RA</em>
                     </span> link so that it expands to reveal the necessary <acronym class="acronym">JAR</acronym> file, which you can click to download<sup>[<a name="sip_ra_filename" href="#ftn.sip_ra_filename">5</a>]</sup> As of the time of this writing, the latest version was <span class="emphasis">
                        <em>1.2 RC1 - core rc2</em>
                     </span>.</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Configuration_of_the_JAIN_SIP_Resource_Adapter"/>5.2.2. Configuration of the JAIN SIP Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>Currently, the <acronym class="acronym">JAIN</acronym> 
                     <acronym class="acronym">SIP</acronym> resource adapter can be configured in three different ways.</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>
					
                              <a href="#fpara-Configuring_the_SIP_RA_Via_the_Provisioning_Mechanism" title="Configuring the SIP RA Via the Provisioning Mechanism">Via the provisioning mechanism</a>, by altering the <code class="filename">resource-adaptor.xml</code> configuration file.</p>
                        </li>
                        <li>
                           <p>
					“<span class="quote">Via properites file jared with classes ( atleast to configure port and ip, it still is place to put gov.nist properties to configure other stack props)</span>”
				</p>
                           <p>Baranowb: is this deprecated? You wrote: “<span class="quote">Properties also can be present in properties file present in ra/src/org/mobicents/slee/resources/sip/ diretory. It will be packed to jar with all classes, and wil be used to configure RA and stack(however its deprecated!!!).</span>”
				</p>
                        </li>
                        <li>
                           <p>
					
                              <a href="#fpara-Configuring_the_SIP_RA_Via_Passing_Properties_to_an_MBean" title="Configuring the SIP RA Via Passing Properties to an MBean">Via properties passed to the MBean which created the Resource Adapter Entity</a>
				
                           </p>
                        </li>
                     </ul>
                  </div>
                  <p class="formalpara">
                     <a name="fpara-Configuring_the_SIP_RA_Via_the_Provisioning_Mechanism"/>
                  </p>
                  <h5 class="formalpara">Configuring the SIP RA Via the Provisioning Mechanism</h5>
                  <p>You can set provisioned properties in the <code class="filename">resource-adaptor.xml</code> file, which is located in <code class="filename">resources/sipra/ra/xml/</code> [TBD: this directory does not exist in the binary installation: exactly which files should we be modifying?]. </p>
                  <p>Provided here are explanations of the various property values which you can set. All of the following configuration entries, which are <code class="literal">&lt;config-property&gt;</code> elements in the XML file, should be unordered children of their parent <code class="literal">&lt;resource-adapter&gt;</code> element <sup>[<a name="footnote-resource-adaptor.xml" href="#ftn.footnote-resource-adaptor.xml">6</a>]</sup>
		
                  </p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">dialogIdleTimeTimeout</span>
                        </dt>
                        <dd>
                           <p>This configuration property sets the timeout on dialogs, in milliseconds. After this amount of time, if the dialog hasn't received any requests or responses, and didn't send any, it is considered to be a “<span class="quote">dead end</span>” and is terminated.</p>
                           <a name="proglist-dialogIdleTimeTimeout"/>
                           <pre class="programlisting">
&lt;config-property&gt;
	&lt;description&gt;uS after which dialog if it has not received/send any message is considered to be dead and is expunged&lt;/description&gt;
	&lt;config-property-name&gt;dialogIdleTimeTimeout&lt;/config-property-name&gt;
	&lt;config-property-type&gt;java.lang.Long&lt;/config-property-type&gt;
	&lt;config-property-value&gt;360000&lt;/config-property-value&gt;
&lt;/config-property&gt;</pre>
                        </dd>
                        <dt>
                           <span class="term">cancelWait</span>
                        </dt>
                        <dd>
                           <p>This configuration property sets the amount of time, in milleseconds, between receiving a <code class="literal">CANCEL</code> and triggering logic to handle it.</p>
                           <a name="proglist-cancelWait"/>
                           <pre class="programlisting">
&lt;config-property&gt;
	&lt;description&gt;uS after CANCEL event is going to be fired into SLEE. This atleast gives Sbbs chance to see INVITE and respond, rather than receiving INVITE in on Tx that is in terminated state.&lt;/description&gt;
	&lt;config-property-name&gt;cancelWait&lt;/config-property-name&gt;
	&lt;config-property-type&gt;java.lang.Long&lt;/config-property-type&gt;
	&lt;config-property-value&gt;1000&lt;/config-property-value&gt;
&lt;/config-property&gt;
</pre>
                        </dd>
                        <dt>
                           <span class="term">port</span>
                        </dt>
                        <dd>
                           <p>This configuration property sets the port number on which the underlying <acronym class="acronym">SIP</acronym> stack will listen.</p>
                           <a name="proglist-port"/>
                           <pre class="programlisting">
&lt;config-property&gt;
	&lt;config-property-name&gt;port&lt;/config-property-name&gt;
	&lt;config-property-type&gt;java.lang.Integer&lt;/config-property-type&gt;
	&lt;config-property-value&gt;5060&lt;/config-property-value&gt;
&lt;/config-property&gt;
</pre>
                        </dd>
                        <dt>
                           <span class="term">ip</span>
                        </dt>
                        <dd>
                           <p>This configuration property sets the <acronym class="acronym">IP</acronym> address of the underlying stack. If it is set to <code class="varname">null</code>, then the <acronym class="acronym">SIP</acronym> resource adapter will use the binding address of the container as its <acronym class="acronym">IP</acronym> address.</p>
                           <a name="proglist-ip"/>
                           <pre class="programlisting">
&lt;config-property&gt;
	&lt;description&gt;IP to which SIP RAs stack should attach - if "null" it will cause RA to pick up Container bind address address&lt;/description&gt;
	&lt;config-property-name&gt;ip&lt;/config-property-name&gt;
	&lt;config-property-type&gt;java.lang.String&lt;/config-property-type&gt;
	&lt;config-property-value&gt;null&lt;/config-property-value&gt;
&lt;/config-property&gt;
</pre>
                        </dd>
                        <dt>
                           <span class="term">transports</span>
                        </dt>
                        <dd>
                           <p>This configuration property sets the transports to be used by the stack. It is a string.</p>
                           <a name="proglist-transports"/>
                           <pre class="programlisting">
&lt;config-property&gt;
	&lt;description&gt;List of transports, separated with ","&lt;/description&gt;
	&lt;config-property-name&gt;transports&lt;/config-property-name&gt;
	&lt;config-property-type&gt;java.lang.String&lt;/config-property-type&gt;
	&lt;config-property-value&gt;UDP&lt;/config-property-value&gt;
&lt;/config-property&gt;
</pre>
                        </dd>
                     </dl>
                  </div>
                  <p class="formalpara">
                     <a name="fpara-Configuring_the_SIP_RA_Via_Passing_Properties_to_an_MBean"/>
                  </p>
                  <h5 class="formalpara">Configuring the SIP RA Via Passing Properties to an MBean</h5>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-End-to-End_SIP_Example"/>5.2.3. Example: End-to-End SIP</h3>
                        </div>
                     </div>
                  </div>
                  <p/>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Wake-Up_Call_Example"/>5.2.4. Example: Wake-Up Call</h3>
                        </div>
                     </div>
                  </div>
                  <p/>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Third-Party_Call_Control_Example"/>5.2.5. Example: Third-Party Call Control</h3>
                        </div>
                     </div>
                  </div>
                  <p/>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Back-to-Back_User_Agent_Example"/>5.2.6. Example: Back-to-Back User Agent</h3>
                        </div>
                     </div>
                  </div>
                  <p/>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-The_XMPP_and_Google_Talk_Resource_Adapter"/>5.3. The XMPP and Google Talk Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Google_Talk_Bot_Example"/>5.3.1. Example: Google Talk Bot</h3>
                        </div>
                     </div>
                  </div>
                  <p/>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Asterisk_Resource_Adapter"/>5.4. Asterisk Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_Asterisk_Resource_Adapter"/>5.4.1. Installing the Asterisk Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The Asterisk resource adapter can be installed by referring to <a href="#section-Deploying_and_Undeploying_Resource_Adapters" title="5.1. Deploying and Undeploying Resource Adapters">Section 5.1, “Deploying and Undeploying Resource Adapters”</a>.</p>
                  <p>Remember to replace <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter&gt;</code>
                        </em>
			
                     </code> with the name of the directory in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code> corresponding to the Asterisk resource adapter (currently this directory is named <code class="filename">
                        <em class="replaceable">
                           <code>asteriskra</code>
                        </em>
			
                     </code>, but this could change in the future).
		</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-J2EE_and_CA_Resource_Adapter"/>5.5. J2EE and CA Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Diameter_Resource_Adapter"/>5.6. Diameter Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_Diameter_Resource_Adapter"/>5.6.1. Installing the Diameter Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The Diameter resource adapter can be installed by referring to <a href="#section-Deploying_and_Undeploying_Resource_Adapters" title="5.1. Deploying and Undeploying Resource Adapters">Section 5.1, “Deploying and Undeploying Resource Adapters”</a>.</p>
                  <p>Remember to replace <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter&gt;</code>
                        </em>
			
                     </code> with the name of the directory in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code> corresponding to the Diameter resource adapter (currently this directory is named <code class="filename">
                        <em class="replaceable">
                           <code>diameterra</code>
                        </em>
			
                     </code>, but this could change in the future).
		</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Media_Resource_Adapter"/>5.7. Media Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_Media_Resource_Adapter"/>5.7.1. Installing the Media Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The Media resource adapter can be installed by referring to <a href="#section-Deploying_and_Undeploying_Resource_Adapters" title="5.1. Deploying and Undeploying Resource Adapters">Section 5.1, “Deploying and Undeploying Resource Adapters”</a>.</p>
                  <p>Remember to replace <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter&gt;</code>
                        </em>
			
                     </code> with the name of the directory in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code> corresponding to the Media resource adapter (currently this directory is named <code class="filename">
                        <em class="replaceable">
                           <code>media-ra</code>
                        </em>
			
                     </code>, but this could change in the future).
		</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-SMPP_Resource_Adapter"/>5.8. SMPP Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_SMPP_Resource_Adapter"/>5.8.1. Installing the SMPP Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The SMPP resource adapter can be installed by referring to <a href="#section-Deploying_and_Undeploying_Resource_Adapters" title="5.1. Deploying and Undeploying Resource Adapters">Section 5.1, “Deploying and Undeploying Resource Adapters”</a>.</p>
                  <p>Remember to replace <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter&gt;</code>
                        </em>
			
                     </code> with the name of the directory in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code> corresponding to the SMPP resource adapter (currently this directory is named <code class="filename">
                        <em class="replaceable">
                           <code>smppra</code>
                        </em>
			
                     </code>, but this could change in the future).
		</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Media_Gateway_Resource_Adapter"/>5.9. Media Gateway Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-JCC_INAP_Resource_Adapter"/>5.10. JCC INAP Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-HTTP_Servlet_Resource_Adapter"/>5.11. HTTP Servlet Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_HTTP_Servlet_Resource_Adapter"/>5.11.1. Installing the HTTP Servlet Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The HTTP Servlet resource adapter can be installed by referring to <a href="#section-Deploying_and_Undeploying_Resource_Adapters" title="5.1. Deploying and Undeploying Resource Adapters">Section 5.1, “Deploying and Undeploying Resource Adapters”</a>.</p>
                  <p>Remember to replace <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter&gt;</code>
                        </em>
			
                     </code> with the name of the directory in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code> corresponding to the HTTP Servlet resource adapter (currently this directory is named <code class="filename">
                        <em class="replaceable">
                           <code>http-servlet-ra</code>
                        </em>
			
                     </code>, but this could change in the future).
		</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Understanding_the_HTTP_Servlet_Resource_Adapter"/>5.11.2. Understanding the HTTP Servlet Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>A servlet is used to extend the capabilities of servers which host accesses to applications via a request-response programming model. Although servlets can respond to any type of request, they are commonly used to extend the applications hosted by web servers. The aim of the HTTP Servlet resource adapter is to provide the ease of same request-response programming model in the Service Logic Execution Environment (SLEE). The HTTP resource adapter is not a replacement for a servlet but is supposed to work in close proximity with servlets to smooth the integration between web applications hosted in the web server and applications developed using Service Building Blocks (SBBs) hosted in the SLEE Server.</p>
                  <div class="figure">
                     <a name="figure-ras-http-servlet-orig-http-servlet-ratype.png"/>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <a name="mediaobj-ras-http-servlet-orig-http-servlet-ratype.png"/>
                           <img src="images/ras-http-servlet-orig-http-servlet-ratype.png" align="middle" alt="The Class Diagram for the HTTP Servlet Resource Adapter"/>
                           <div class="caption">
                              <p>HttpSessionActivity is the only activity involved in the HTTP Servlet resource adapter</p>
                           </div>
                        </div>
                     </div>
                     <p class="title">
                        <b>Figure 5.5. The Class Diagram for the HTTP Servlet Resource Adapter</b>
                     </p>
                  </div>
                  <br class="figure-break"/>
                  <p>
			
                     <code class="literal">HttpSessionActivity</code> represents the <code class="literal">HttpSession</code> created from the incoming <code class="literal">javax.servlet.http.HttpServletRequest</code> received by <code class="literal">HttpServletRaServlet</code>, which in turn passes it on to HttpServletResourceEntryPoint.</p>
                  <p>
			
                     <code class="literal">HttpServletResourceEntryPoint</code> is the link between the servlet and HttpServletResourceAdaptor. <code class="literal">HttpServletResourceAdaptor</code> fires the appropriate event like <code class="literal">GET</code>, <code class="literal">POST</code>, <code class="literal">PUT</code>, <code class="literal">DELETE</code>, etc., depending on the method of <code class="literal">HttpServletRequest</code>, and the service interested in these events will receive it as initial event. The service will use the HttpServletRequestEvent passed as an argument to an <code class="varname">on<em class="replaceable">
                           <code>something</code>
                        </em>
			
                     </code> event method to get an <code class="literal">HttpServletResponse</code> object. A service can add content to the response, modify headers etc. Calling the <code class="function">flushBuffer()</code> function on an <code class="literal">HttpServletResponse</code> will flush the buffer and the response will be committed.</p>
                  <p>The service can explicitly end the <code class="literal">HttpSessionActivity</code> by calling the <code class="function">invalidate()</code> function on HttpSession. Calling <code class="function">invalidate()</code> will invoke the <code class="function">sessionDestroyed()</code> method of <code class="literal">HttpServletRaSessionListener</code> by the web container. Within the <code class="function">sessionDestroyed()</code> method, the resource adapter's <code class="function">endHttpSessionActivity()</code> is called to end the activity. If <code class="literal">HttpSession</code> times out, then it is the responsibility of the container to invoke the <code class="function">sessionDestroyed()</code> function and the above steps in order to end activity.</p>
                  <p>
			
                     <code class="literal">HttpServletResourceAdaptor</code> uses the <code class="function">request.getPathInfo()</code> function to form the web address used to fire the Event:</p>
                  <pre class="programlisting">//PathInfo can be an empty string and the creation of Address will throw exception
//for empty String hence hardcoding prefix /mobicents
String pathInfo = "/mobicents" + request.getPathInfo();

Address address = new Address(AddressPlan.URI, pathInfo);
sleeEndpoint.fireEvent(ah, event, eventID, address);</pre>
                  <p>SBBs which are interested in events emmitted by <code class="literal">HttpServletResourceAdaptor</code> should use </p>
                  <pre class="programlisting">&lt;initial-event-select variable="Address" /&gt;</pre>
                  <p> for calculating the convergence name, this way we can make sure that URL's submitted to HttpServletResourceAdaptor are mapped to convergence names</p>
                  <p>For example:</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>The URL <code class="literal">URL http://localhost:8080/mobicents/x/y</code> maps to the convergence name <code class="literal">/mobicents/x/y</code>.</p>
                        </li>
                        <li>
                           <p>URL <code class="literal">http://localhost:8080/mobicents/sum/dum</code> maps to the convergence name <code class="literal">/mobicents/sum/dum</code>.</p>
                        </li>
                     </ul>
                  </div>
                  <h5 class="formalpara">A Service Building Block Example</h5>
                  <p class="formalpara">An SBB can be inetersted in any of the HTTP Methods <code class="literal">OPTIONS</code>, <code class="literal">GET</code>, <code class="literal">HEAD</code>, <code class="literal">POST</code>, <code class="literal">PUT</code>, <code class="literal">DELETE</code>, <code class="literal">TRACE</code>, and for each <code class="literal">HttpMethod</code>, the resource adapter fires a corresponding event.</p>
                  <p>The following code is an example of Service Building Block code:</p>
                  <pre class="programlisting">public void onPost(HttpServletRequestEvent event,
            ActivityContextInterface aci) {
        try {

            HttpServletResponse response = event.getResponse();
            PrintWriter w = response.getWriter();
            w.print("onPost OK! Served by SBB = " + getSbbId());
            w.flush();
            response.flushBuffer();
            log
                    .info("HttpServletRAExampleSbb: POST Request received and OK! response sent.");
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    public void onGet(HttpServletRequestEvent event,
            ActivityContextInterface aci) {
        .....
        .....

    }

    public void onHead(HttpServletRequestEvent event,
            ActivityContextInterface aci) {
        // The HEAD method is identical to GET except that the server MUST NOT
        // return a message-body in the response.
        log.info("HttpServletRAExampleSbb: HEAD Request received.");

    }

    public void onPut(HttpServletRequestEvent event,
            ActivityContextInterface aci) {
        ...........

    }

    public void onDelete(HttpServletRequestEvent event,
            ActivityContextInterface aci) {
           .............

    }

    public void onOptions(HttpServletRequestEvent event,
            ActivityContextInterface aci) {
               .............
    }

    public void onTrace(HttpServletRequestEvent event,
            ActivityContextInterface aci) {
               ..............
    }</pre>
                  <div class="example">
                     <a name="example-sbb-jar.xml"/>
                     <div class="example-contents">
                        <a name="proglist-sbb-jar.xml"/>
                        <pre class="programlisting">sbb-jar.xml

&lt;?xml version="1.0" encoding="utf-8"?&gt;

&lt;sbb-jar&gt;
    &lt;sbb&gt;
        &lt;description/&gt;
        &lt;sbb-name&gt;HttpServletRAExampleSBB&lt;/sbb-name&gt;
        &lt;sbb-vendor&gt;org.mobicents&lt;/sbb-vendor&gt;
        &lt;sbb-version&gt;1.0&lt;/sbb-version&gt;        
        &lt;sbb-classes&gt;
            &lt;sbb-abstract-class&gt;
                &lt;sbb-abstract-class-name&gt;org.mobicents.slee.service.httpservletra.example.HttpServletRAExampleSbb&lt;/sbb-abstract-class-name&gt;       
                &lt;/sbb-abstract-class&gt;
        &lt;/sbb-classes&gt;
       
        &lt;event initial-event="True" event-direction="Receive"&gt;
            &lt;event-name&gt;Post&lt;/event-name&gt;
            &lt;event-type-ref&gt;
                &lt;event-type-name&gt;net.java.slee.resource.http.events.incoming.POST&lt;/event-type-name&gt;
                &lt;event-type-vendor&gt;net.java.slee&lt;/event-type-vendor&gt;
                &lt;event-type-version&gt;1.0&lt;/event-type-version&gt;
            &lt;/event-type-ref&gt;
            &lt;initial-event-select variable="Address" /&gt;
        &lt;/event&gt;
        
        
        &lt;event initial-event="True" event-direction="Receive"&gt;
            &lt;event-name&gt;Get&lt;/event-name&gt;
            ..................
        &lt;/event&gt;

    .....
       ....
     &lt;event-name&gt;Head&lt;/event-name&gt;
    ...
    &lt;event-name&gt;Put&lt;/event-name&gt;
    .....
     ....
 
        &lt;resource-adaptor-type-binding&gt;
            &lt;resource-adaptor-type-ref&gt;
                &lt;resource-adaptor-type-name&gt;HttpServletResourceAdaptorType&lt;/resource-adaptor-type-name&gt;
                &lt;resource-adaptor-type-vendor&gt;org.mobicents&lt;/resource-adaptor-type-vendor&gt;
                &lt;resource-adaptor-type-version&gt;1.0&lt;/resource-adaptor-type-version&gt;
            &lt;/resource-adaptor-type-ref&gt;
            &lt;activity-context-interface-factory-name&gt;
                slee/resources/http-servlet-ra/http-servlet-ra-acif
            &lt;/activity-context-interface-factory-name&gt;
            &lt;resource-adaptor-entity-binding&gt;
                &lt;resource-adaptor-object-name&gt;slee/resources/http-servlet-ra/org.mobicents/1.0.00/http-servlet-ra/factoryprovider&lt;/resource-adaptor-object-name&gt;
                &lt;resource-adaptor-entity-link&gt;HttpServletRA&lt;/resource-adaptor-entity-link&gt;
            &lt;/resource-adaptor-entity-binding&gt;
        &lt;/resource-adaptor-type-binding&gt;
              
    &lt;/sbb&gt;
&lt;/sbb-jar&gt;
</pre>
                     </div>
                     <p class="title">
                        <b>Example 5.1. A sample sbb-jar.xml configuration file</b>
                     </p>
                  </div>
                  <br class="example-break"/>
                  <p>In order to deploy the HTTP Servlet resource adapter, execute 'ant build-and-deploy-ra' from mobicents/ra/http-servlet-ra folder. Make sure to set the MOBICENTS_HOME and JBOSS_HOME.</p>
                  <p>TBD: is this correct? Format and ensure the correctness of these last 2-3 paragraphs</p>
                  <p>To execute the test-case, follow the steps in mobicents/ra/http-servlet-ra/tests/build.xml</p>
                  <p>There is a working example httpservletra-example to demonstarte the usage of http-servlet-ra. Follow the link to download example https://mobicents-examples.dev.java.net/source/browse/mobicents-examples/httpservletra-example/ and read instructions README.txt to deploy the example</p>
                  <p>Note: Http Servlet RA is only for processing incoming HttpServletRequest and sending back the HttpServletResponse. If there is a need to create the Request from within the service make use of Http Client RA.</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-HTTP_Client_Resource_Adapter"/>5.12. The HTTP Client Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_HTTP_Client_Resource_Adapter"/>5.12.1. Installing the HTTP Client Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The HTTP Client resource adapter can be installed by referring to <a href="#section-Deploying_and_Undeploying_Resource_Adapters" title="5.1. Deploying and Undeploying Resource Adapters">Section 5.1, “Deploying and Undeploying Resource Adapters”</a>.</p>
                  <p>Remember to replace <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter&gt;</code>
                        </em>
			
                     </code> with the name of the directory in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code> corresponding to the HTTP Client resource adapter (currently this directory is named <code class="filename">
                        <em class="replaceable">
                           <code>http-client-ra</code>
                        </em>
			
                     </code>, but this could change in the future).
		</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Understanding_the_HTTP_Client_Resource_Adapter"/>5.12.2. Understanding the HTTP Client Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The Hypertext Transfer Protocol (HTTP) is probably the most significant protocol used on the Internet today. Web services, network-enabled appliances and the growth of network computing continue to expand the role of the HTTP protocol beyond user-driven web browsers, while increasing the number of applications that require HTTP support. Applications developed using the Service Logic Execution Environment fall into this category. The Jakarta Commons <code class="literal">HttpClient</code> component provides an efficient, up-to-date, and feature-rich package implementing the client side of the most recent HTTP standards and recommendations. The HTTP Client resource adapter provides the client-side HTTP standard within the SLEE execution environment using the popular Apache Commons HTTP Client library.</p>
                  <p>A Service Building Block (SBB) can use the HTTP Client resource adapter to make a request and get the response either synchronously or asynchronously.</p>
                  <div class="figure">
                     <a name="d0e2374"/>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <a name="mediaobj-ras-http-client-orig-http-client-ra.png"/>
                           <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="700">
                              <tr>
                                 <td align="center">
                                    <img src="images/ras-http-client-orig-http-client-ra.png" align="middle" width="700" alt="The Class Diagram for the HTTP Client Resource Adapter"/>
                                 </td>
                              </tr>
                           </table>
                        </div>
                     </div>
                     <p class="title">
                        <b>Figure 5.6. The Class Diagram for the HTTP Client Resource Adapter</b>
                     </p>
                  </div>
                  <br class="figure-break"/>
                  <div class="variablelist">
                     <a name="varlist-HTTP_Client_Resource_Adapter_Methods"/>
                     <p class="title">
                        <b>HTTP Client Resource Adapter Methods</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">HttpClientResourceAdaptorSbbInterface</span>
                        </dt>
                        <dd>
                           <p>Provides the SBB with the interface to interact with the HTTP Client resource adapter. <code class="function">HttpClientResourceAdaptorSbbInterface</code> is a wrapper over <code class="literal">org.apache.commons.httpclient.HttpClient</code> and exposes the most commonly-used methods of <code class="literal">HttpClient</code>.</p>
                           <h5 class="formalpara">
							
                              <code class="function">createHttpMethod(String method, String uri)</code>
						
                           </h5>
                           <p class="formalpara">
							
                              <code class="literal">HttpClientResourceAdaptorSbbInterface</code> is used by the SBB to generate the GET, POST, HEAD (etc.) requests (HttpMethod) by calling this method. The URI can be any external URI.</p>
                           <h5 class="formalpara">
							
                              <code class="function">public void executeMethod(HttpMethod method)</code>
						
                           </h5>
                           <p class="formalpara">Calling this method will send the request synchronously and the calling application can then process the <code class="function">HttpMethod</code> to get the response.</p>
                           <h5 class="formalpara">
							
                              <code class="function">public HttpClientActivity createHttpClientActivity()</code>
						
                           </h5>
                           <p class="formalpara">Creates an instance of <code class="literal">HttpClientActivity</code> for a service that wants to send the request asynchronously. By default the value for <code class="literal">endOnReceivingResponse</code> is set to false, and the service has to explicitly end activity.</p>
                           <h5 class="formalpara">
							
                              <code class="function">public HttpClientActivity createHttpClientActivity(boolean endOn&gt;&gt;&gt;ReceivingResponse)</code>
						
                           </h5>
                           <p class="formalpara">Same method as above, with the only difference being that the service can pass <code class="literal">endOnReceivingResponse</code> as true, which means the activity ends as soon as the resource adapter executes the method and emits a <code class="literal">ResponseEvent</code>.</p>
                        </dd>
                        <dt>
                           <span class="term">Methods Inherited from <code class="literal">HttpClient</code>
				
                           </span>
                        </dt>
                        <dd>
                           <h5 class="formalpara">public HttpClientParams getParams()</h5>
                           <p class="formalpara">The HTTP protocol parameters associated with this <code class="literal"> HttpClient</code>.</p>
                           <h5 class="formalpara">public HttpClientParams getState()</h5>
                           <p class="formalpara">The HTTP state associated with the <code class="literal">HttpClient</code>.</p>
                           <h5 class="formalpara">public void setParams(HttpClientParams params)</h5>
                           <p class="formalpara">The HTTP protocol parameters for this <code class="literal">HttpClient</code>.</p>
                           <h5 class="formalpara">public void setState(HttpState state)</h5>
                           <p class="formalpara">Assigns the HTTP state for the <code class="literal">HttpClient</code>.</p>
                           <h5 class="formalpara">HttpClientActivity</h5>
                           <p class="formalpara">The HTTP Client resource adapter can be used in a synchronous or asynchronous way. <code class="literal">HttpClientActivity</code> is useful only when the HTTP Client resource adapter is used to send the Request asynchronously.</p>
                           <h5 class="formalpara">public String getSessionId()</h5>
                           <p class="formalpara">Gets the unique Session ID.</p>
                           <h5 class="formalpara">public void endActivity();</h5>
                           <p class="formalpara">To end the <code class="literal">HttpClientActivity</code>. If <code class="literal">endOnReceivingResponse</code> is set to true and if the SBB tries to forcefully end activity by calling <code class="function">endActivity()</code>, it should throw an exception. <code class="function">endActivity()</code> should only be allowed when <code class="literal">endOnReceivingResponse</code> is set to false.</p>
                           <h5 class="formalpara">public boolean getEndOnReceivingResponse()</h5>
                           <p class="formalpara">Returns true or false depending on the value passed when the request is sent asynchronously.</p>
                           <h5 class="formalpara">public void executeMethod(HttpMethod httpMethod)</h5>
                           <p class="formalpara">The service that wants to send the request asynchronously first has to create an instance of <code class="literal">HttpMethod</code> by calling <code class="function">createHttpMethod()</code> of <code class="literal">HttpClientResourceAdaptorSbbInterface</code> The service also creates an activity, attaches itself to this activity, and then calls <code class="function">executeMethod</code>, passing the instance of <code class="literal">HttpMethod</code>.</p>
                           <h5 class="formalpara">ResponseEvent</h5>
                           <p class="formalpara">
							
                              <code class="literal">ResponseEvent</code> is fired by the HTTP Client resource adapter as soon as <code class="function">HttpClient.executeMethod()</code> returns. The response can be a proper response or an exception depending on the environment and application logic.</p>
                           <h5 class="formalpara">public Response getResponse()</h5>
                           <p class="formalpara">The interested SBB receives this event and can act on a response.</p>
                           <h5 class="formalpara">public Exception getException()</h5>
                           <p class="formalpara">There may be exception due to a network failure or application logic. Interested SBBs can get the exact Exception using this method.</p>
                           <h5 class="formalpara">Response</h5>
                           <p class="formalpara">This is the wrapper over the response part of <code class="function">org.apache.commons.httpclient.HttpMethod</code>.</p>
                           <h5 class="formalpara">public byte[] getResponseBody()</h5>
                           <p class="formalpara">Returns the response body of the HTTP method, if any, as an array of bytes.</p>
                           <h5 class="formalpara">public String getResponseBodyAsString()</h5>
                           <p class="formalpara">The response body of the HTTP method, if any, as a String.</p>
                           <h5 class="formalpara">public int getStatusCode()</h5>
                           <p class="formalpara">The status code associated with the latest response.</p>
                           <h5 class="formalpara">public Header[] getResponseHeaders()</h5>
                           <p class="formalpara">The response headers from the most recent execution of this request.</p>
                        </dd>
                        <dt>
                           <span class="term">Example</span>
                        </dt>
                        <dd>
                           <p>This is simple example of the code. To look at fully-working example, look at the httpclientra-example at <a xmlns:xlink="http://www.w3.org/1999/xlink" href="https://mobicents-examples.dev.java.net/source/browse/mobicents-examples/httpclientra-example/">https://mobicents-examples.dev.java.net/source/browse/mobicents-examples/httpclientra-example/</a>.</p>
                        </dd>
                        <dt>
                           <span class="term">The Synchronous Way to Send a Request</span>
                        </dt>
                        <dd>
                           <p>
						
                           </p>
                           <pre class="programlisting">//get the resource adapter Sbb Interface
HttpClientResourceAdaptorSbbInterface raSbbInterface = ;

//create HttpMethod by passing the link
HttpMethod httpMethod = raSbbInterface.createHttpMethod("GET", "http://www.mobicents.org-a.googlepages.com/index.html"));

//send the request and get a response
Response response = raSbbInterface.executeMethod(httpMethod);

//get ResponseBody
String responseBody = response.getResponseBodyAsString();</pre>
                           <p>
					
                           </p>
                        </dd>
                        <dt>
                           <span class="term">The Asynchronous Way to Send a Request</span>
                        </dt>
                        <dd>
                           <p>
						
                           </p>
                           <pre class="programlisting">//get the resource adapter sbb Interface and aci factory
HttpClientResourceAdaptorSbbInterface raSbbInterface = ;
HttpClientActivityContextInterfaceFactory httpClientAci = ;


//create HttpMethod by passing the link
HttpMethod httpMethod = raSbbInterface.createHttpMethod("GET", "http://www.mobicents.org-a.googlepages.com/index.html"));

//create HttpClientActivity
HttpClientActivity clientActivity = raSbbInterface.createHttpClientActivity(true);

// get the aci for the activity and attach an sbb local object
ActivityContextInterface clientAci = httpClientAci.getActivityContextInterface(clientActivity);
clientAci.attach(sbbContext.getSbbLocalObject());


//send a request by calling executeMethod
clientActivity.executeMethod(httpMethod);</pre>
                           <p>
					
                           </p>
                           <p>The response arrives asynchronously</p>
                           <pre class="programlisting">public void onResponseEvent(ResponseEvent event, ActivityContextInterface aci) {

//Get the Response from Event
Response response = event.getResponse();

//get ResponseBody
String responseBody = response.getResponseBodyAsString();</pre>
                        </dd>
                     </dl>
                  </div>
                  <p>The HTTP Servlet resource adapter and HTTP Client resource adapter compliment each other in creating a complete SLEE Application capable of receiving requests as well as initiating them.</p>
                  <p>TBD: eventually remove this: If you have any suggestions/feedback or find a bug please discuss at http://forums.java.net/jive/thread.jspa?messageID=228634&amp;#228634</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Persistence_Resource_Adapter"/>5.13. Persistence Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_Persistence_Resource_Adapter"/>5.13.1. Installing the Persistence Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The Persistence resource adapter can be installed by referring to <a href="#section-Deploying_and_Undeploying_Resource_Adapters" title="5.1. Deploying and Undeploying Resource Adapters">Section 5.1, “Deploying and Undeploying Resource Adapters”</a>.</p>
                  <p>Remember to replace <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter&gt;</code>
                        </em>
			
                     </code> with the name of the directory in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code> corresponding to the Persistence resource adapter (currently this directory is named <code class="filename">
                        <em class="replaceable">
                           <code>persistencera</code>
                        </em>
			
                     </code>, but this could change in the future).
		</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-XCAP_Client_Resource_Adapter"/>5.14. XCAP Client Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_XCAP_Client_Resource_Adapter"/>5.14.1. Installing the XCAP Client Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The XCAP Client resource adapter can be installed by referring to <a href="#section-Deploying_and_Undeploying_Resource_Adapters" title="5.1. Deploying and Undeploying Resource Adapters">Section 5.1, “Deploying and Undeploying Resource Adapters”</a>.</p>
                  <p>Remember to replace <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter&gt;</code>
                        </em>
			
                     </code> with the name of the directory in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code> corresponding to the XCAP Client resource adapter (currently this directory is named <code class="filename">
                        <em class="replaceable">
                           <code>xcapclientra</code>
                        </em>
			
                     </code>, but this could change in the future).
		</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Rules_Resource_Adapter"/>5.15. Rules Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_Rules_Resource_Adapter"/>5.15.1. Installing the Rules Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The Rules resource adapter can be installed by referring to <a href="#section-Deploying_and_Undeploying_Resource_Adapters" title="5.1. Deploying and Undeploying Resource Adapters">Section 5.1, “Deploying and Undeploying Resource Adapters”</a>.</p>
                  <p>Remember to replace <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter&gt;</code>
                        </em>
			
                     </code> with the name of the directory in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code> corresponding to the Rules resource adapter (currently this directory is named <code class="filename">
                        <em class="replaceable">
                           <code>rulesra</code>
                        </em>
			
                     </code>, but this could change in the future).
		</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-TTS_Resource_Adapter"/>5.16. TTS Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_the_TTS_Resource_Adapter"/>5.16.1. Installing the TTS Resource Adapter</h3>
                        </div>
                     </div>
                  </div>
                  <p>The TTS resource adapter can be installed by referring to <a href="#section-Deploying_and_Undeploying_Resource_Adapters" title="5.1. Deploying and Undeploying Resource Adapters">Section 5.1, “Deploying and Undeploying Resource Adapters”</a>.</p>
                  <p>Remember to replace <code class="filename">
                        <em class="replaceable">
                           <code>&lt;resource_adapter&gt;</code>
                        </em>
			
                     </code> with the name of the directory in <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/resources</code> corresponding to the TTS resource adapter (currently this directory is named <code class="filename">
                        <em class="replaceable">
                           <code>ttsra</code>
                        </em>
			
                     </code>, but this could change in the future).
		</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-SAP_Resource_Adapter"/>5.17. SAP Resource Adapter</h2>
                     </div>
                  </div>
               </div>
               <p/>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Third-Party_Resource_Adapters"/>5.18. Third-Party Resource Adapters</h2>
                     </div>
                  </div>
               </div>
               <p/>
            </div>
            <div class="footnotes">
               <br/>
               <hr width="100" align="left"/>
               <div class="footnote">
                  <p>
                     <sup>[<a name="ftn.d0e1633" href="#d0e1633">4</a>] </sup>The location of the <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_jboss_directory&gt;</code>
                        </em>/deploy</code> directory depends on whether you installed the binary distribution of Mobicents, in which case it is <code class="filename">
                        <em class="replaceable">
                           <code>&lt;topmost_mobicents_directory&gt;</code>
                        </em>/server/server/default/deploy</code>, or downloaded and installed JBoss yourself, in which case it is <code class="filename">
                        <code class="envar">$JBOSS_HOME</code>/deploy</code>.</p>
               </div>
               <div class="footnote">
                  <p>
                     <sup>[<a name="ftn.sip_ra_filename" href="#sip_ra_filename">5</a>] </sup>As of the time this was written, the <acronym class="acronym">JAR</acronym> file was named <code class="filename">jsipv1.2ra-package-10-02-2007.jar</code>.</p>
               </div>
               <div class="footnote">
                  <p>
                     <sup>[<a name="ftn.footnote-resource-adaptor.xml" href="#footnote-resource-adaptor.xml">6</a>] </sup>Here is an example of the complete <code class="filename">resource-adaptor.xml</code> configuration file.</p>
                  <pre class="programlisting">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;!DOCTYPE resource-adaptor-jar PUBLIC "-//Sun Microsystems, Inc.//DTD JAIN SLEE Resource Adaptor 1.0//EN" "http://java.sun.com/dtd/slee-resource-adaptor-jar_1_0.dtd"&gt;
&lt;resource-adaptor-jar&gt;
	&lt;resource-adaptor
		id="jain-sip_1.1_RA"&gt;
		&lt;description&gt;JAIN SIP Resource Adaptor&lt;/description&gt;
		&lt;resource-adaptor-name&gt;JainSipResourceAdaptor&lt;/resource-adaptor-name&gt;
		&lt;resource-adaptor-vendor&gt;net.java.slee.sip&lt;/resource-adaptor-vendor&gt;
		&lt;resource-adaptor-version&gt;1.2&lt;/resource-adaptor-version&gt;
					
		&lt;resource-adaptor-type-ref&gt;
			&lt;resource-adaptor-type-name&gt;JAIN SIP&lt;/resource-adaptor-type-name&gt;
			&lt;resource-adaptor-type-vendor&gt;javax.sip&lt;/resource-adaptor-type-vendor&gt;
			&lt;resource-adaptor-type-version&gt;1.2&lt;/resource-adaptor-type-version&gt;
		&lt;/resource-adaptor-type-ref&gt;

	&lt;!--added oc-resource-adaptor.xml lines here altogether--&gt;
		&lt;resource-adaptor-classes&gt;
			&lt;resource-adaptor-class&gt;
				&lt;resource-adaptor-class-name&gt;
                    org.mobicents.slee.resource.sip.SipResourceAdaptor
                &lt;/resource-adaptor-class-name&gt;
			&lt;/resource-adaptor-class&gt;
		&lt;/resource-adaptor-classes&gt;
					
		&lt;config-property&gt;
			&lt;description&gt;uS after which dialog if it has not received/send any message is considered to be dead and is expunged&lt;/description&gt;
			&lt;config-property-name&gt;dialogIdleTimeTimeout&lt;/config-property-name&gt;
			&lt;config-property-type&gt;java.lang.Long&lt;/config-property-type&gt;
			&lt;config-property-value&gt;360000&lt;/config-property-value&gt;
		&lt;/config-property&gt;
					
		&lt;config-property&gt;
			&lt;description&gt;uS after CANCEL event is going to be fired into SLEE. This atleast gives Sbbs chance to see INVITE and respond, rather than receiving INVITE in on Tx that is in terminated state.&lt;/description&gt;
			&lt;config-property-name&gt;cancelWait&lt;/config-property-name&gt;
			&lt;config-property-type&gt;java.lang.Long&lt;/config-property-type&gt;
			&lt;config-property-value&gt;1000&lt;/config-property-value&gt;
		&lt;/config-property&gt;
					
		&lt;config-property&gt;
			&lt;config-property-name&gt;port&lt;/config-property-name&gt;
			&lt;config-property-type&gt;java.lang.Integer&lt;/config-property-type&gt;
			&lt;config-property-value&gt;5060&lt;/config-property-value&gt;
		&lt;/config-property&gt;
					
		&lt;config-property&gt;
			&lt;description&gt;IP to which SIP RAs stack should attach - if "null" it will cause RA to pick up Container bind address address&lt;/description&gt;
			&lt;config-property-name&gt;ip&lt;/config-property-name&gt;
			&lt;config-property-type&gt;java.lang.String&lt;/config-property-type&gt;
			&lt;config-property-value&gt;null&lt;/config-property-value&gt;
		&lt;/config-property&gt;
					
		&lt;config-property&gt;
			&lt;description&gt;List of transports, separated with ","&lt;/description&gt;
			&lt;config-property-name&gt;transports&lt;/config-property-name&gt;
			&lt;config-property-type&gt;java.lang.String&lt;/config-property-type&gt;
			&lt;config-property-value&gt;UDP&lt;/config-property-value&gt;
		&lt;/config-property&gt;
	&lt;/resource-adaptor&gt;
&lt;/resource-adaptor-jar&gt;</pre>
               </div>
            </div>
         </div>
         <div class="chapter" lang="en-US">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title">
                        <a name="chapter-Other_Examples"/>Chapter 6. Other Examples</h2>
                  </div>
               </div>
            </div>
            <div class="toc">
               <dl>
                  <dt>
                     <span class="section">
                        <a href="#section-SLEE_Graph_Viewer_Example">6.1. Example: SLEE Graph Viewer</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-Call_Blocking_and_Call_Forwarding_and_Voice_Mail_Example">6.2. Example: Call-Blocking, Call-Forwarding and Voice Mail</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-Multi-Service_Example">6.3. Example: Multiple Services</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-Parent-Child_Interaction_Example">6.4. Example: Parent-Child Interaction</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-LDAP-Enabled_JSLEE_Example">6.5. Example: LDAP-Enabled JSLEE</a>
                     </span>
                  </dt>
               </dl>
            </div>
            <p/>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-SLEE_Graph_Viewer_Example"/>6.1. Example: SLEE Graph Viewer</h2>
                     </div>
                  </div>
               </div>
               <p/>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Call_Blocking_and_Call_Forwarding_and_Voice_Mail_Example"/>6.2. Example: Call-Blocking, Call-Forwarding and Voice Mail</h2>
                     </div>
                  </div>
               </div>
               <p/>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Multi-Service_Example"/>6.3. Example: Multiple Services</h2>
                     </div>
                  </div>
               </div>
               <p/>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Parent-Child_Interaction_Example"/>6.4. Example: Parent-Child Interaction</h2>
                     </div>
                  </div>
               </div>
               <p/>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-LDAP-Enabled_JSLEE_Example"/>6.5. Example: LDAP-Enabled JSLEE</h2>
                     </div>
                  </div>
               </div>
               <p/>
            </div>
         </div>
         <div class="chapter" lang="en-US">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title">
                        <a name="chapter-Mobicents_SIP_Presence_Service"/>Chapter 7. Mobicents SIP Presence Service</h2>
                  </div>
               </div>
            </div>
            <div class="toc">
               <dl>
                  <dt>
                     <span class="section">
                        <a href="#section-Mobicents_SIP_Presence_Service">7.1. Mobicents SIP Presence Service</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Architecture_of_the_Mobicents_SIP_Presence_Service">7.1.1. Architecture of the Mobicents SIP Presence Service</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-Mobicents_XML_Document_Management_Server">7.2. Mobicents XML Document Management Server</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Introduction_to_the_XDM_Server">7.2.1. Introduction to the XDM Server</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Configuring_Installing_and_Testing_the_XDM_Server">7.2.2. Configuring, Installing and Testing the XDM Server</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Functional_Architecture_of_the_XDM_Server">7.2.3. Functional Architecture of the XDM Soerver</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Resources_and_Further_Information_about_the_XDM_Server">7.2.4. Resources and Further Information about the XDM Server</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-Mobicents_SIP_Presence_Server">7.3. Mobicents SIP Presence Server</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Introduction_to_the_SIP_Presence_Server">7.3.1. Introduction to the SIP Presence Server</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Configuring_Installing_and_Testing_the_SIP_Presence_Server">7.3.2. Configuring, Installing and Testing the SIP Presence Server</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Functional_Architecture_of_the_SIP_Presence_Server">7.3.3. Functional Architecture of the SIP Presence Server</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Resources_and_Further_Information_about_the_SIP_Presence_Server">7.3.4. Resources and Further Information about the SIP Presence Server</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-Mobicents_Resource_List_Server">7.4. Mobicents_Resource_List_Server</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Introduction_to_the_Mobicents_Resource_List_Server">7.4.1. Introduction to the Mobicents Resource List Server</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
               </dl>
            </div>
            <p/>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Mobicents_SIP_Presence_Service"/>7.1. Mobicents SIP Presence Service</h2>
                     </div>
                  </div>
               </div>
               <p>The Mobicents SIP Presence Service provides presence functionalities to SIP-based networks using standards developed by the Internet Engineering Task Force (IETF), the Open Mobile Alliance (OMA), the 3rd Generation Partnership Project (3GPP) and the European Telecommunications Standards Institute (ETSI).</p>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Architecture_of_the_Mobicents_SIP_Presence_Service"/>7.1.1. Architecture of the Mobicents SIP Presence Service</h3>
                        </div>
                     </div>
                  </div>
                  <p>The Mobicents SIP Presence Service is comprised of three separate but interrelated servers.</p>
                  <div class="figure">
                     <a name="figure-sas-orig-dia-MobicentsSipPresenceServerArchitecture.jpg"/>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <a name="mediaobj-sas-orig-dia-MobicentsSipPresenceServerArchitecture.jpg"/>
                           <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="700">
                              <tr>
                                 <td align="center">
                                    <img src="images/sas-orig-dia-MobicentsSipPresenceServerArchitecture.jpg" align="middle" width="700" alt="The Mobicents SIP Presence Service"/>
                                 </td>
                              </tr>
                           </table>
                           <div class="caption">
                              <p>Functional Diagram of the Mobicents SIP Presence Service</p>
                           </div>
                        </div>
                     </div>
                     <p class="title">
                        <b>Figure 7.1. The Mobicents SIP Presence Service</b>
                     </p>
                  </div>
                  <br class="figure-break"/>
                  <div class="variablelist">
                     <a name="varlist-The_Three_Servers_Comprising_the_Mobicents_Presence_Service"/>
                     <p class="title">
                        <b>The Three Servers Comprising the Mobicents Presence Service</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">
					
                              <a href="#section-Mobicents_XML_Document_Management_Server" title="7.2. Mobicents XML Document Management Server">Section 7.2, “Mobicents XML Document Management Server”</a>
				
                           </span>
                        </dt>
                        <dd>
                           <p>The Mobicents XDM Server is a functional element of next-generation IP communications networks is responsible for handling the management of user XML documents stored on the network side, such as presence authorization rules, static presence information, contact and group lists (also known as “<span class="quote">resource lists</span>”), policy data, and many others.</p>
                        </dd>
                        <dt>
                           <span class="term">
					
                              <a href="#section-Mobicents_SIP_Presence_Server" title="7.3. Mobicents SIP Presence Server">Section 7.3, “Mobicents SIP Presence Server”</a>
				
                           </span>
                        </dt>
                        <dd>
                           <p>The Mobicents SIP Presence Server is an entity that accepts, stores and distributes Presence Information. The SIP Presence Server performs the following functions:</p>
                           <div class="itemizedlist">
                              <ul>
                                 <li>
                                    <p>It manages publications from one or multiple Presence Source(s) of a certain Presentity. This includes refreshing Presence Information, replacing existing Presence Information with newly-published information, or removing Presence Information.</p>
                                 </li>
                                 <li>
                                    <p>It manages subscriptions from Watchers to Presence Information and generates notifications about the Presence Information state changes, retrieving the presence authorization rules from the XDM Server.</p>
                                 </li>
                                 <li>
                                    <p>It manages subscriptions from Watcher Information Subscribers to Watcher information and generates notifications about Watcher information state changes.</p>
                                 </li>
                              </ul>
                           </div>
                        </dd>
                        <dt>
                           <span class="term">
					
                              <a href="#section-Mobicents_Resource_List_Server" title="7.4. Mobicents_Resource_List_Server">Section 7.4, “Mobicents_Resource_List_Server”</a>
				
                           </span>
                        </dt>
                        <dd>
                           <p>The Resource List Server (RLS) handles subscriptions to Presence Lists. It creates and manages back-end subscriptions to all resources in the Presence List. The list content is retrieved from the XDM Server.</p>
                        </dd>
                     </dl>
                  </div>
                  <p>To fill different needs you can deploy all servers separated, or all integrated in the same host, and on top of that, there are JAINSLEE internal client interfaces available for each, which can turn into a big advantage over other presence services.</p>
                  <p>For documentation on each server proceed to links under this page Resources section.</p>
                  <h5 class="formalpara">Resources and Further Information about the Mobicents Presence Service</h5>
                  <p class="formalpara">For further information on the Mobicents Presence Service, here is a list of additional resources:</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>Issue Tracker</p>
                        </li>
                        <li>
                           <p>
						
                              <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://mobicents.googlecode.com/svn/trunk/servers/sip-presence/">Source Code Location</a>
					
                           </p>
                        </li>
                        <li>
                           <p>
						
                              <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://forums.java.net/jive/category.jspa?categoryID=36">Java.net Forums</a>
					
                           </p>
                        </li>
                     </ul>
                  </div>
                  <p>TBD: This version of the documentation is from <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://groups.google.com/group/mobicents-public/web/mobicents-sip-presence-service">http://groups.google.com/group/mobicents-public/web/mobicents-sip-presence-service</a>, and the original author is Eduardo Martins, JBoss R &amp; D.</p>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Mobicents_XML_Document_Management_Server"/>7.2. Mobicents XML Document Management Server</h2>
                     </div>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Introduction_to_the_XDM_Server"/>7.2.1. Introduction to the XDM Server</h3>
                        </div>
                     </div>
                  </div>
                  <p>The Mobicents XML Document Management Server (XDMS) is part of the Mobicents SIP Presence Service; it is the first free and open source implementation of an XML Document Management Server as defined in the <a xmlns:xlink="http://www.w3.org/1999/xlink" href="Open Mobile Alliance (OMA) XML Document Management v1.1 specification">Open Mobile Alliance (OMA) XML Document Management v1.1 specification</a>. This functional element of next-generation IP communication networks is responsible for handling the management of user XML documents stored on the network side, such as presence authorization rules, contact and group lists (also known as resource lists), static presence information, and much more.</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Configuring_Installing_and_Testing_the_XDM_Server"/>7.2.2. Configuring, Installing and Testing the XDM Server</h3>
                        </div>
                     </div>
                  </div>
                  <p class="formalpara">
                     <a name="fpara-XDM_Requirements"/>
                  </p>
                  <h5 class="formalpara">Requirements</h5>
                  <p class="formalpara">The Mobicents XDM Server depends on the Mobicents JAIN SLEE server and the Mobicents SIP and HTTP Servlet resource adapters. Make sure that all of these requirements are deployed before deploying the XDM Server.</p>
                  <div class="important">
                     <a name="important-The_XDM_Server_is_Currently_Incompatible_with_Java_1.6"/>
                     <h2>The XDM Server is Currently Incompatible with Java 1.6</h2>
                     <p>Currently, the Mobicents XDM Server will not work with Java 1.6, although this will be fixed in the future. Therefore, if you are running the XDM Server, make sure that you are using Java 1.5.</p>
                  </div>
                  <h5 class="formalpara">Configuration</h5>
                  <p class="formalpara">The Mobicents XML Document Management Server can be customized in the following aspects before being built.</p>
                  <div class="variablelist">
                     <a name="varlist-Customizing_the_XDM_Server"/>
                     <p class="title">
                        <b>Customizing the XDM Server</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">XCAP Root</span>
                        </dt>
                        <dd>
                           <p>The Maven property <code class="literal">xdm.server.xcap.root</code>, in the <code class="filename">pom.xml</code> which is inside the Mobicents Presence Service root directory (in <code class="filename">/trunk/servers/sip-presence</code> to be exact) defines the relative path to root that is considered the XCAP Root for all XCAP URIs. This value must match the servlet name used in the Mobicents HTTP Servlet resource adapter. The default value is <em class="replaceable">
                                 <code>/mobicents</code>
                              </em>.</p>
                        </dd>
                        <dt>
                           <span class="term">Dynamic User Provisioning</span>
                        </dt>
                        <dd>
                           <p>The Maven property <code class="literal">dynamicUserProvisioning</code> in the <code class="filename">pom.xml</code> inside the Mobicents Presence Service root directory (in <code class="filename">/trunk/servers/sip-presence</code> to be exact) defines whether the XDM Server should provision the user when a <code class="literal">PUT</code> request is being processed and the user is not installed for the request's application usage. The default value is true.</p>
                        </dd>
                     </dl>
                  </div>
                  <p>Note that you do not need to touch or configure anything in order to deploy the server.</p>
                  <h5 class="formalpara">Installing the Mobicents XML Document Management Server</h5>
                  <p class="formalpara">How you install the XDM Server depends on whether you are using the Mobicents binary distribution, or running the source distribution.</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <h5 class="formalpara">Installing the XDM Server using the Mobicents Binary Distribution</h5>
                           <p class="formalpara">TBD: (Fix this with proper instructions): Using the binary release, you can install the XDM Server by doing an ant deploy on the <code class="filename">servers/sip-presence/xdms</code> directory.</p>
                        </li>
                        <li>
                           <h5 class="formalpara">Installing the XDM Server after Building Mobicents from Source</h5>
                           <p class="formalpara">TBD: (Fix this with proper instructions): From the source code repository, you can install the XDM Server by doing a mvn install on the <code class="filename">/trunk/servers/sip-presence/xdms</code> directory.</p>
                        </li>
                     </ul>
                  </div>
                  <h5 class="formalpara">Uninstalling the Mobicents XML Document Management Server</h5>
                  <p class="formalpara">How you uninstall the XDM Server depends on whether you are using the Mobicents binary distribution, or running the source distribution.</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <h5 class="formalpara">Uninstalling the XDM Server using the Mobicents Binary Distribution</h5>
                           <p class="formalpara">TBD: (Fix this with proper instructions): Using the binary release, you can uninstall the XDM Server by doing an ant undeploy on the <code class="filename">servers/sip-presence/xdms</code> directory.</p>
                        </li>
                        <li>
                           <h5 class="formalpara">Uninstalling the XDM Server after Building Mobicents from Source</h5>
                           <p class="formalpara">TBD: (Fix this with proper instructions): From the source code repository, you can uninstall the XDM Server by doing a mvn clean on the <code class="filename">/trunk/servers/sip-presence/xdms</code> directory.</p>
                        </li>
                     </ul>
                  </div>
                  <h5 class="formalpara">Testing the Mobicents XDM Server</h5>
                  <p class="formalpara">TBD (Make sure this is correct): is recommended that you test the XDM Server after you deploy it. For instructions on how to test the XDM Server, read and follow the instructions in <code class="filename">.../xdms/tests/README.txt</code>. No tests should fail.</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Functional_Architecture_of_the_XDM_Server"/>7.2.3. Functional Architecture of the XDM Soerver</h3>
                        </div>
                     </div>
                  </div>
                  <p>The Mobicents XDM Server includes the following XCAP application usages:</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>
					
                              <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://tools.ietf.org/html/rfc5025">IETF Presence Rules (RFC 5025)</a>
				
                           </p>
                        </li>
                        <li>
                           <p>
					
                              <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.openmobilealliance.org/Technical/release_program/Presence_simple_v1_1.aspx">OMA Presence Rules (OMA Presence Simple v1.1 Candidate Release)</a>
				
                           </p>
                        </li>
                        <li>
                           <p>
					
                              <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://tools.ietf.org/html/rfc4826">IETF Resource Lists</a>
				
                           </p>
                        </li>
                        <li>
                           <p>
					
                              <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://tools.ietf.org/html/rfc4826">IETF RLS Services (RFC 4826)</a>
				
                           </p>
                        </li>
                        <li>
                           <p>
					
                              <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://tools.ietf.org/html/rfc4825">IETF XCAP-CAPS (RFC 4825)</a>
				
                           </p>
                        </li>
                     </ul>
                  </div>
                  <div class="figure">
                     <a name="figure-sas-orig-dia-XDM_Functional_Architecture.jpg"/>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <a name="mediaobj-sas-orig-dia-XDM_Functional_Architecture.jpg"/>
                           <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="700">
                              <tr>
                                 <td align="center">
                                    <img src="images/sas-orig-dia-XDM_Functional_Architecture.jpg" align="middle" width="700" alt="The Mobicents XML Document Management Server"/>
                                 </td>
                              </tr>
                           </table>
                           <div class="caption">
                              <p>Functional Architecture of the XML Document Management Server</p>
                           </div>
                        </div>
                     </div>
                     <p class="title">
                        <b>Figure 7.2. The Mobicents XML Document Management Server</b>
                     </p>
                  </div>
                  <br class="figure-break"/>
                  <p>The XDM Server comprises the following functional elements:</p>
                  <div class="variablelist">
                     <a name="varlist-Functional_Elements_of_the_XDM_Server"/>
                     <p class="title">
                        <b>Functional Elements of the XDM Server</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">Data Source</span>
                        </dt>
                        <dd>
                           <p>The XDM Server data source is where all user XML documents are stored. Information related to the server itself is also stored in this element along with the user's provisioned data</p>
                           <p>The data source also handles subscriptions to updates on specific documents, or complete XCAP application usages.</p>
                        </dd>
                        <dt>
                           <span class="term">Aggregation Proxy</span>
                        </dt>
                        <dd>
                           <p>The aggregation proxy is responsible for handling an XDM client's XCAP requests, which includes authentication and authorization of the requester.</p>
                        </dd>
                        <dt>
                           <span class="term">Request Processor</span>
                        </dt>
                        <dd>
                           <p>This element includes the XCAP Server logic to process an XCAP request and return a proper response.</p>
                        </dd>
                        <dt>
                           <span class="term">XDM Event Subscription Control</span>
                        </dt>
                        <dd>
                           <p>This element, using the SIP protocol, is responsible for handling subscriptions to documents managed by the XDM. Its functions include the authentication and authorization of a subscription, attachment to update events on specific documents or application usages, and the sending of notifications when documents change.</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Implementation Architecture of the Mobicents XML Document Management Server</h5>
                  <p class="formalpara">The XDM Server is built on top of the Mobicents JAIN SLEE container. This figure depicts the architecture of the XDM Server implementation.</p>
                  <div class="figure">
                     <a name="figure-sas-orig-dia-XDMS_Implementation.jpg"/>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <a name="mediaobj-sas-orig-dia-XDMS_Implementation.jpg"/>
                           <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="700">
                              <tr>
                                 <td align="center">
                                    <img src="images/sas-orig-dia-XDMS_Implementation.jpg" align="middle" width="700" alt="Mobicents XML Document Management Server"/>
                                 </td>
                              </tr>
                           </table>
                           <div class="caption">
                              <p>Implementation Architecture of the XML Document Management Server</p>
                           </div>
                        </div>
                     </div>
                     <p class="title">
                        <b>Figure 7.3. Mobicents XML Document Management Server</b>
                     </p>
                  </div>
                  <br class="figure-break"/>
                  <div class="variablelist">
                     <a name="varlist-The_Functional_Elements_Which_Compose_the_XML_Document_Management_Server"/>
                     <p class="title">
                        <b>The Functional Elements Which Compose the XML Document Management Server</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">Data Source Resource Adapter</span>
                        </dt>
                        <dd>
                           <p>This Resource Adaptor implements the Data Source functional element.</p>
                           <p>The <code class="literal">RA Type</code> defines two activities objects, <code class="literal">DocumentActivity</code> and <code class="literal">AppUsageActivity</code>, both of which are used to fire events that signal that a document, element or attribute was updated.</p>
                           <p>The <code class="literal">RA Type</code> also defines a Service Building Block (SBB) RA interface to manage the users and documents stored in the XDM Server, and create activities, where events will be fired. The resource adapter will only fire events on activities that exist; that is, the RA won't create activities implicitly if a document is updated.</p>
                           <p>The <code class="literal">RA Type</code> also provides a base abstract implementation of the resource adapter, making it very simple to change the underlying resource used to store information, which is by default the internal JDBC datasource of the JBoss Application Server.</p>
                        </dd>
                        <dt>
                           <span class="term">AppUsage Cache Resource Adaptor</span>
                        </dt>
                        <dd>
                           <p>This resource adapter stores the XCAP application usages installed in the server.</p>
                           <p>Each <code class="literal">AppUsage</code> is an object that includes the logic to validate XCAP documents that result from XCAP requests and are expensive to create; this resource adapter  thus provides caching of AppUsages, using a pool model.</p>
                           <p>The resource adapter doesn't possess events or activities.</p>
                        </dd>
                        <dt>
                           <span class="term">AppUsage Service</span>
                        </dt>
                        <dd>
                           <p>XCAP Application Usages are installed through a  JAIN SLEE service, making it possible to add and/or remove application usages while the server is running.</p>
                        </dd>
                        <dt>
                           <span class="term">Aggregation Proxy Service</span>
                        </dt>
                        <dd>
                           <p>This JAIN SLEE service implements the aggregation proxy functional element. It handles events fired by the Mobicents HTTP Servlet resource adapter and then uses two child SBBs: the <code class="literal">User Profile Enabler SBB</code> to retrieve information regarding the user needed for authentication/authorization of the XCAP request, and the <code class="literal">Request Processor SBB</code>, which handles the XCAP request.</p>
                        </dd>
                        <dt>
                           <span class="term">Request Processor SBB</span>
                        </dt>
                        <dd>
                           <p>The <code class="literal">Request Processor SBB</code> implements the request processor functional element, providing a synchronous SBB interface to process XCAP requests. It uses the <code class="literal">AppUsage Cache</code> resource adapter to borrow AppUsage objects, and the Data Source resource adapter to retrieve or set documents stored in the server's data source.</p>
                        </dd>
                        <dt>
                           <span class="term">User Profile Enabler SBB (TBD: not available yet)</span>
                        </dt>
                        <dd>
                           <p>This SBB provides a synchronous SBB interface used in JAIN SLEE child relations in order to retrieve user information. Two different implementations of the interface are provided, one considers that the information is stored in the XDM Data Source, another interfaces to a Diameter Sh Server such as IMS HSS.</p>
                        </dd>
                        <dt>
                           <span class="term">XCAP Diff Subscription Control Service (TBD: not available yet)</span>
                        </dt>
                        <dd>
                           <p>TBD</p>
                        </dd>
                     </dl>
                  </div>
                  <p>The implementation architecture figure also contains client-side components:</p>
                  <div class="variablelist">
                     <a name="varlist-Client-Side_Components_of_the_XML_Document_Management_Server_"/>
                     <p class="title">
                        <b>Client-Side Components of the XML Document Management Server </b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">XCAP Client</span>
                        </dt>
                        <dd>
                           <p>The XCAP client is a simple API to interact with an XCAP Server that internally uses the Apache HTTP Client.</p>
                           <p>The API documentation and example code snippets can be found TBD</p>
                        </dd>
                        <dt>
                           <span class="term">XCAP Client Resource Adaptor</span>
                        </dt>
                        <dd>
                           <p>The XCAP Client Resource Adaptor adapts the XCAP Client API into JAIN SLEE domain. It provides methods to interact with the XCAP server in both syncronous and asyncronous ways.</p>
                           <p>The RA Type description and code snippets using the RA can be found here.</p>
                        </dd>
                        <dt>
                           <span class="term">XDM Client SBB</span>
                        </dt>
                        <dd>
                           <p>The XDMClientSBB is an interface of a JAIN SLEE SBB to be used as a client to the Mobicents XDM Server (and others compliant with same standards), in JAIN SLEE child relations.</p>
                           <p>Two implementations of this interface are provided:</p>
                           <div class="itemizedlist">
                              <ul>
                                 <li>
                                    <p>
								
                                       <code class="literal">InternalXDMClientSBB</code> is intended to be used on applications running in the Mobicents XDM Server JAIN SLEE container, and</p>
                                 </li>
                                 <li>
                                    <p>
								
                                       <code class="literal">ExternalXDMClientSBB</code>, which is intended to be used on applications running in a different JAIN SLEE container than the Mobicents XDM Server.</p>
                                 </li>
                              </ul>
                           </div>
                        </dd>
                     </dl>
                  </div>
                  <p>TBD: This version of the documentation is from http://groups.google.com/group/mobicents-public/web/mobicents-xdm-server and the original author is Eduardo Martins, JBoss R&amp;D.</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Resources_and_Further_Information_about_the_XDM_Server"/>7.2.4. Resources and Further Information about the XDM Server</h3>
                        </div>
                     </div>
                  </div>
                  <p>For further information on the Mobicents XDM Server, here is a list of additional resources:</p>
                  <div class="itemizedlist">
                     <a name="itemlist-Further_Information_on_the_Mobicents_XDM_Server"/>
                     <ul>
                        <li>
                           <p>How to Manage the Mobicents XDM Server</p>
                        </li>
                        <li>
                           <p>How to Create an XCAP App(lication)Usage</p>
                        </li>
                        <li>
                           <p>Integrating XDM in your JAIN SLEE Apps: Code Snippets for XDM Client SBB Usage</p>
                        </li>
                        <li>
                           <p>
					
                              <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://groups.google.com/group/mobicents-public/web/xcap-client-api">XCAP Client API Documentation</a>
				
                           </p>
                        </li>
                        <li>
                           <p>
					
                              <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://groups.google.com/group/mobicents-public/web/xcap-client-resource-adaptor">XCAP Client RA Type Description and Example Code Snippets</a>
				
                           </p>
                        </li>
                        <li>
                           <p>Mobicents SIP Presence Service</p>
                        </li>
                        <li>
                           <p>Want to contribute?</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Mobicents_SIP_Presence_Server"/>7.3. Mobicents SIP Presence Server</h2>
                     </div>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Introduction_to_the_SIP_Presence_Server"/>7.3.1. Introduction to the SIP Presence Server</h3>
                        </div>
                     </div>
                  </div>
                  <p>The Mobicents SIP Presence Server is a free and open source implementation of a SIP Presence Server, as defined by the Internet Engineering Task Force (IETF), the Open Mobile Alliance (OMA), the 3rd Generation Partnership Project (3GPP) and the European Telecommunications Standards Institute (ETSI).</p>
                  <p>The SIP Presence Server is an entity that accepts, stores and distributes SIP Presence Information.</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Configuring_Installing_and_Testing_the_SIP_Presence_Server"/>7.3.2. Configuring, Installing and Testing the SIP Presence Server</h3>
                        </div>
                     </div>
                  </div>
                  <h5 class="formalpara">Requirements</h5>
                  <p class="formalpara">The Mobicents SIP Presence Server depends on the Mobicents Converged Application Server and the Mobicents SIP resource adapter, which should be deloyed before starting the SIP Presence Server.</p>
                  <h5 class="formalpara">Configuration</h5>
                  <p class="formalpara">The Mobicents SIP Presence Server can be customized in the following aspects before being built.</p>
                  <div class="variablelist">
                     <a name="varlist-Customizing_the_Presence_Server"/>
                     <p class="title">
                        <b>Customizing the SIP Presence Server</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">XCAP Aware User Agent</span>
                        </dt>
                        <dd>
                           <p>The SIP Presence Server calculates the presence-rules XCAP URIs of users in a non-standard way by default, but one which is compatible with CounterPath eyeBeam. You can change this behavior to conform with standards by changing the contents of the <code class="literal">clientUAIsEyebeam</code> field of <code class="literal">PresenceSubscriptionControlSbb</code>, which is in <code class="filename">ps-core/subscription-sbb/src/main/java/..</code>.<sup>[<a name="footnote-temp_solution" href="#ftn.footnote-temp_solution">7</a>]</sup>
					
                           </p>
                           <p>Note that you do not need to touch or configure anything in order to deploy the server.</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Installing the Mobicents SIP Presence Server</h5>
                  <p class="formalpara">TBD (Fix this with proper instructions): Currently, the Mobicents SIP Presence Server can only be installed as integrated with the Mobicents XML Document Management Server, i.e. in an all-in-one SIP Presence Server architecture<sup>[<a name="footnote-integrated_presence_server" href="#ftn.footnote-integrated_presence_server">8</a>]</sup>.</p>
                  <div class="important">
                     <a name="important-Installing_the_Presence_Server_Also_Installs_the_XDM_Server"/>
                     <h2>Installing the SIP Presence Server Also Installs the XDM Server</h2>
                     <p>You should also make sure that all the install requirements of the Mobicents XDM Server are met before attempting to install the Mobicents SIP Presence Server. See <a href="#fpara-XDM_Requirements" title="Requirements">Requirements</a>.</p>
                  </div>
                  <h5 class="formalpara">Installing the Mobicents XML Document Management Server</h5>
                  <p class="formalpara">How you install the XDM Server depends on whether you are using the Mobicents binary distribution, or running the source distribution.</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <h5 class="formalpara">Installing the XDM Server using the Mobicents Binary Distribution</h5>
                           <p class="formalpara">TBD: (Fix this with proper instructions): Using the binary release, you can install the XDM Server by doing an ant deploy on the <code class="filename">servers/sip-presence/integrated</code> directory.</p>
                        </li>
                        <li>
                           <h5 class="formalpara">Installing the XDM Server after Building Mobicents from Source</h5>
                           <p class="formalpara">TBD: (Fix this with proper instructions): From the source code repository, you can install the XDM Server by doing a mvn install on the <code class="filename">/trunk/servers/sip-presence/integrated</code> directory.</p>
                        </li>
                     </ul>
                  </div>
                  <h5 class="formalpara">Uninstalling the Mobicents XML Document Management Server</h5>
                  <p class="formalpara">How you uninstall the XDM Server depends on whether you are using the Mobicents binary distribution, or running the source distribution.</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <h5 class="formalpara">Uninstalling the XDM Server using the Mobicents Binary Distribution</h5>
                           <p class="formalpara">TBD: (Fix this with proper instructions): Using the binary release, you can uninstall the XDM Server by doing an ant undeploy on the <code class="filename">servers/sip-presence/integrated</code> directory.</p>
                        </li>
                        <li>
                           <h5 class="formalpara">Uninstalling the XDM Server after Building Mobicents from Source</h5>
                           <p class="formalpara">TBD: (Fix this with proper instructions): From the source code repository, you can uninstall the XDM Server by doing a mvn clean on the <code class="filename">/trunk/servers/sip-presence/integrated</code> directory.</p>
                        </li>
                     </ul>
                  </div>
                  <h5 class="formalpara">Testing the Mobicents SIP Presence Server</h5>
                  <p class="formalpara">A test framework for the Mobicents SIP Presence Server is forthcoming but not available yet.</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Functional_Architecture_of_the_SIP_Presence_Server"/>7.3.3. Functional Architecture of the SIP Presence Server</h3>
                        </div>
                     </div>
                  </div>
                  <h5 class="formalpara">Functional Architecture of the Mobicents SIP Presence Server</h5>
                  <div class="figure">
                     <a name="figure-sas-orig-dia-PS_Functional_Architecture.jpg"/>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <a name="mediaobj-sas-orig-dia-PS_Functional_Architecture.jpg"/>
                           <img src="images/sas-orig-dia-PS_Functional_Architecture.jpg" align="middle" alt="The Mobicents SIP Presence Server"/>
                           <div class="caption">
                              <p>Functional Diagram of the Mobicents SIP Presence Server</p>
                           </div>
                        </div>
                     </div>
                     <p class="title">
                        <b>Figure 7.4. The Mobicents SIP Presence Server</b>
                     </p>
                  </div>
                  <br class="figure-break"/>
                  <p>The SIP Presence Server comprises the following functional elements:</p>
                  <div class="variablelist">
                     <a name="varlist-The_Functional_Elements_Which_Compose_the_Presence_Server"/>
                     <p class="title">
                        <b>The Functional Elements Which Compose the SIP Presence Server</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">Presence Publication Control</span>
                        </dt>
                        <dd>
                           <p>This functional element manages the publication of presence events, which includes not only the handling of new publications, but also the refreshing, modification or removal of, already-published information.</p>
                           <p>Because the presence resource, which is also called a “<span class="quote">presentity</span>”, can have multiple publications simultaneously, such as some state published by a user agent or device, and some location data published by a Presence Network Agent (on behalf of the presentity), this element is also responsible for composing all of the different publications for the same resource.</p>
                           <p>In some presence networks, it may be of interest to allow resources to have a static presence state, which is stored in the XDM Server. In cases like these, Presence Publication Control may need to interface with the XDM Server to retrieve and subscribe to (learn about changes to) that information, and use it when composing the final presence information document.</p>
                        </dd>
                        <dt>
                           <span class="term">Presence Subscription Control</span>
                        </dt>
                        <dd>
                           <p>This functional element handles subscriptions to presence events or to the list of subscribers (watchers), for any specific resource. It is, of course, responsible for emitting notifications related to those subscriptions.</p>
                           <p>Presence authorization rules, which define if a subscription is allowed or rejected and, if allowed, define which transformations to the original presence events are needed, are stored on the XDM Server by the user. Thus, Presence Subscription Control needs to retrieve and subscribe to (learn about changes to) that information.</p>
                        </dd>
                        <dt>
                           <span class="term">XDM Client Control</span>
                        </dt>
                        <dd>
                           <p>This last element is responsible for interfacing with the XDM Server that manages the user's XML documents, and is related to the main functions of the presence server. It's capable not only of retrieving a document (or part of one), but also of subscribing to either updates of a single, specific document, or to a full collection of documents of a specific type or application.</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Implementation Architecture of the Mobicents SIP Presence Server</h5>
                  <div class="figure">
                     <a name="figure-sas-orig-dia-PS_Implementation.jpg"/>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <a name="mediaobj-sas-orig-dia-PS_Implementation.jpg"/>
                           <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="700">
                              <tr>
                                 <td align="center">
                                    <img src="images/sas-orig-dia-PS_Implementation.jpg" align="middle" width="700" alt="Implementation Architecture of the Mobicents SIP Presence Server"/>
                                 </td>
                              </tr>
                           </table>
                           <div class="caption">
                              <p>The Mobicents SIP Presence Server</p>
                           </div>
                        </div>
                     </div>
                     <p class="title">
                        <b>Figure 7.5. Implementation Architecture of the Mobicents SIP Presence Server</b>
                     </p>
                  </div>
                  <br class="figure-break"/>
                  <p>The implementation of the Mobicents SIP Presence Server comprises the following functional elements:</p>
                  <div class="variablelist">
                     <a name="varlist-The_Two_Services_Which_Compose_the_Presence_Server"/>
                     <p class="title">
                        <b>The Two Services Which Compose the SIP Presence Server</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">Presence Publication Control Service</span>
                        </dt>
                        <dd>
                           <p>This JAIN SLEE service includes the root Service Building Block (SBB), <code class="literal">PresencePublicationControlSbb</code>, which is the implementation of the abstract SIP event <code class="literal">PublicationControlSbb</code>. It handles publications on the "presence" event package.</p>
                           <p>The <code class="literal">PresencePublicationControlSbb</code> provides the following capabilities:</p>
                           <div class="itemizedlist">
                              <ul>
                                 <li>
                                    <p>It provides the logic to authorize a publication; however, it only authorizes <code class="literal">PUBLISH</code> requests when the request URI matches the PIDF document “<span class="quote">entity</span>” attribute.</p>
                                 </li>
                                 <li>
                                    <p>It provides JAXB unmarshellers to validate and parse the PIDF document for the abstract <code class="literal">PublicationControlSbb</code>.</p>
                                 </li>
                                 <li>
                                    <p>It demands that notifying subscribers occur through a child relation to the root SBB of the Presence Subscription Control Service.</p>
                                 </li>
                                 <li>
                                    <p>Finally, it also provides an <code class="literal">SbbLocalObject</code> interface that can be used, in JAIN SLEE child relations, to obtain the composed presence information for a specific resource.</p>
                                 </li>
                              </ul>
                           </div>
                        </dd>
                        <dt>
                           <span class="term">Presence Subscription Control Service.</span>
                        </dt>
                        <dd>
                           <p>This JAIN SLEE service includes the root SBB <code class="literal">PresenceSubscriptionControlSbb</code>, which is the implementation of the abstract SIP Event <code class="literal">SubscriptionControlSbb</code>. It handles subscriptions on the "presence" event package.</p>
                           <p>The standout SBB logic item is the usage of presence-rules documents, obtained through the XDM Client SBB child relation, in order to authorize subscriptions and transform the content notified (TBD: feature not used yet). It also defines a child relation to the root SBB of <code class="literal">PresencePublicationService</code> to retrieve the composed PIDF document for the subscription's notifier.</p>
                           <p>The SBB also provides an <code class="literal">SbbLocalObject</code> interface that can be used, in JAIN SLEE child relations, to make the presence event known to the subscribers of a specific resource.</p>
                        </dd>
                     </dl>
                  </div>
                  <p>The implementation architecture of the SIP Presence Server also contains client-side components:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">Presence Client SBB (TBD: not yet available)</span>
                        </dt>
                        <dd>
                           <p>The <code class="literal">PresenceClientSBB</code> is the interface to a JAIN SLEE SBB intended to be used as a client for the Mobicents SIP Presence Server (and other servers compliant with same standards), in JAIN SLEE child relations.</p>
                           <p>Two implementations of this interface are provided: the <code class="literal">InternalPresenceClientSBB</code> that is used with applications running in the Mobicents SIP Presence Server JAIN SLEE container, and the <code class="literal">ExternalPresenceClientSBB</code>, used with applications running in a different JAIN SLEE container than the Mobicents SIP Presence Server.</p>
                        </dd>
                     </dl>
                  </div>
                  <p>TBD: This documentation is originally from http://groups.google.com/group/mobicents-public/web/mobicents-sip-presence-server by Eduardo Martins, JBoss R&amp;D.</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Resources_and_Further_Information_about_the_SIP_Presence_Server"/>7.3.4. Resources and Further Information about the SIP Presence Server</h3>
                        </div>
                     </div>
                  </div>
                  <p>For further information on the Mobicents SIP Presence Server, see the following list of additional resources:</p>
                  <div class="itemizedlist">
                     <a name="itemlist-Further_Information_on_the_Mobicents_SIP_Presence_Server"/>
                     <ul>
                        <li>
                           <p>How to Manage the Mobicents SIP Presence Server</p>
                        </li>
                        <li>
                           <p>Integrating the Mobicents SIP Presence Server into Your JAIN SLEE Applications: Code Snippets for Internal Presence Client SBB Usage.</p>
                        </li>
                        <li>
                           <p>Integrating the Mobicents SIP Presence Server into Your JAIN SLEE Applications: Code Snippets for External Presence Client SBB Usage.</p>
                        </li>
                        <li>
                           <p>
					
                              <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://groups.google.com/group/mobicents-public/web/mobicents-sip-event-components">Mobicents Sip Event Publication and Subscription Control Components</a>
				
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Mobicents_Resource_List_Server"/>7.4. Mobicents_Resource_List_Server</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Introduction_to_the_Mobicents_Resource_List_Server"/>7.4.1. Introduction to the Mobicents Resource List Server</h3>
                        </div>
                     </div>
                  </div>
                  <p/>
               </div>
            </div>
            <div class="footnotes">
               <br/>
               <hr width="100" align="left"/>
               <div class="footnote">
                  <p>
                     <sup>[<a name="ftn.footnote-temp_solution" href="#footnote-temp_solution">7</a>] </sup>This is a temporary solution due to a feature in the current JAIN SIP stack that removes invalid User Agent hedaers of SIP requests. In the future, this configuration is exected to be deprecated or removed.</p>
               </div>
               <div class="footnote">
                  <p>
                     <sup>[<a name="ftn.footnote-integrated_presence_server" href="#footnote-integrated_presence_server">8</a>] </sup>This limitation is due to the current lack of an external XDM Client SBB component.</p>
               </div>
            </div>
         </div>
         <div class="chapter" lang="en-US">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title">
                        <a name="chapter-Mobicents_Media_Server"/>Chapter 8. Mobicents Media Server</h2>
                  </div>
               </div>
            </div>
            <div class="toc">
               <dl>
                  <dt>
                     <span class="section">
                        <a href="#section-Mobicents_Media_Server">8.1. Mobicents Media Server</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Overview_of_Media_Servers">8.1.1. Overview of Media Servers</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Installing_Building_and_Uninstalling_the_MMS">8.1.2. Installing, Building and Uninstalling the MMS</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-Mobicents_Media_Server_Architecture">8.2. Mobicents Media Server Architecture</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Design_Overview_and_Typical_Deployment_Scenario">8.2.1. Design Overview and Typical Deployment Scenario</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Endpoints">8.2.2. Endpoints</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Endpoint_Identifiers">8.2.3. Endpoint Identifiers</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Connections">8.2.4. Connections</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Events_and_Signals">8.2.5. Events and Signals</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-MMS_Configuration">8.3. MMS Configuration</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Announcement_Server_Access_Points">8.3.1. Announcement Server Access Points</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Interactive_Voice_Response">8.3.2. Interactive Voice Response</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Packet_Relay_Endpoint">8.3.3. Packet Relay Endpoint</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Conference_Bridge_Endpoint">8.3.4. Conference Bridge Endpoint</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-MMS_Control_Protocols">8.4. MMS Control Protocols</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-MMS_Control_API">8.5. MMS Control API</a>
                     </span>
                  </dt>
                  <dd>
                     <dl>
                        <dt>
                           <span class="section">
                              <a href="#section-Basic_Components_of_the_MMS_API">8.5.1. Basic Components of the MMS API</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Basic_API_Patterns_Listeners">8.5.2. Basic API Patterns: Listeners</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-Events">8.5.3. Events</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-MSC_API_Objects_Finite_State_Machines">8.5.4. MSC API Objects: Finite State Machines</a>
                           </span>
                        </dt>
                        <dt>
                           <span class="section">
                              <a href="#section-API_Methods_and_Usage">8.5.5. API Methods and Usage</a>
                           </span>
                        </dt>
                     </dl>
                  </dd>
                  <dt>
                     <span class="section">
                        <a href="#section-MMS_Event_Packages">8.6. MMS Event Packages</a>
                     </span>
                  </dt>
                  <dt>
                     <span class="section">
                        <a href="#section-MMS_Demonstration_Example">8.7. MMS Demonstration Example</a>
                     </span>
                  </dt>
               </dl>
            </div>
            <p/>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Mobicents_Media_Server"/>8.1. Mobicents Media Server</h2>
                     </div>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Overview_of_Media_Servers"/>8.1.1. Overview of Media Servers</h3>
                        </div>
                     </div>
                  </div>
                  <h5 class="formalpara">The Reasoning and Need for Media Servers</h5>
                  <p class="formalpara">With the continued progress of globalization, more corporations than ever before have workgroups spread across countries and continents across the world. To support and increase the productivity of remote and telecommuting workgroups, communications companies are considering more cost effective network solutions that combine voice, wireless, data and video functionality. Businesses like these expect that the services they select and eventually implement will have call quality comparable to conventional telephone service, and they expect those services to boost productivity and reduce overall communications costs. Acquiring these desired network services requires connections from the Internet and wireless and wireline networks to Public Switched Telephone Networks (<acronym class="acronym">PSTN</acronym>s) using a flexible, robust, scalable and cost-effective media gateway. The ability of such gateways to reduce overall communications costs for dispersed workgroups forms the foundation for media services and servers.</p>
                  <h5 class="formalpara">Media Gateways Bridge Multiple Technologies</h5>
                  <p class="formalpara">Today, all communications can be routed through computers. Widespread access to broadband Internet and the ubiquity of Internet Protocol (<acronym class="acronym">IP</acronym>) enable the convergence of voice, data and video. Media gateways provide the ability to switch voice media between a network and its access point. Using Digital Subscriber Line (<acronym class="acronym">DSL</acronym>) and fast-Internet cable technology, a media gateway converts, compresses and packetizes voice data for transmission back-and-forth across the Internet backbone for wireline and wireless phones. Media gateways sit at the intersection of the PSTNs and wireless or IP-based networks.</p>
                  <h5 class="formalpara">The Justification for Media Gateways for VoIP</h5>
                  <p class="formalpara">Multiple market demands are pushing companies to converge all of their media services using media gateways with VoIP capabilities. Companies expect such a convergent architecture to:</p>
                  <div class="variablelist">
                     <p class="title">
                        <b>Company Expectations of a Convergent Architecture</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">Lower Initial Costs</span>
                        </dt>
                        <dd>
                           <p>Capital investment is decreased because low-cost commodity hardware can be used for multiple functions.</p>
                        </dd>
                        <dt>
                           <span class="term">Lower Development Costs</span>
                        </dt>
                        <dd>
                           <p>Open system hardware and software standards with well-defined applications mean lower costs, and Application Programmable Interfaces (<acronym class="acronym">API</acronym>s) accelerate development.</p>
                        </dd>
                        <dt>
                           <span class="term">Handle Multiple Media Types</span>
                        </dt>
                        <dd>
                           <p>Companies want <acronym class="acronym">VoIP</acronym> solutions today, but also need to choose extensible solutions that will handle video in the near future.</p>
                        </dd>
                        <dt>
                           <span class="term">Lower the Costs of Deployment and Maintenance</span>
                        </dt>
                        <dd>
                           <p>Standardized, modular systems reduce training costs and maintenance while also improving uptime.</p>
                        </dd>
                        <dt>
                           <span class="term">Enable Rapid Time-to-Market</span>
                        </dt>
                        <dd>
                           <p>Early market entry hits the window of opportunity and maximizes revenue.</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">What Is the Mobicents Media Server?</h5>
                  <p class="formalpara">The Mobicents Media Gateway is an open source Media Server based on the Java Media Framework and aimed to:</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>Deliver competitive, complete, best-of-breed media gateway functionality of the highest quality.</p>
                        </li>
                        <li>
                           <p>Meet the demands of converged wireless and wireline networks, DSL and cable broadband access, and fixed-mobile converged <acronym class="acronym">VoIP</acronym> networks from a singleand singularly-capablemedia gateway platform.</p>
                        </li>
                        <li>
                           <p>Increase flexibility with a media gateway that supports a wide variety of call control protocols and scales to meet the demands of enterprises and small-carrier providers.</p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Installing_Building_and_Uninstalling_the_MMS"/>8.1.2. Installing, Building and Uninstalling the MMS</h3>
                        </div>
                     </div>
                  </div>
                  <p class="formalpara">
                     <a name="fpara-Building_the_MMS"/>
                  </p>
                  <h5 class="formalpara">Building the MMS</h5>
                  <p class="formalpara">The server is available as a source code distribution. The source code is available from the server source repository located at http://code.google.com/p/mobicents/source/checkout. The source code availability allows you to debug the server, learn its inner workings and create customized versions for your personal use.</p>
                  <p class="formalpara">
                     <a name="fpara-Pre-requisites"/>
                  </p>
                  <h5 class="formalpara">Pre-requisites</h5>
                  <p class="formalpara">Before installing and running the media server, you should check that your have installed Mobicents SLEE server.</p>
                  <p class="formalpara">
                     <a name="fpara-Accessing_the_MMS_SVN_Source_Code_Repositories"/>
                  </p>
                  <h5 class="formalpara">Accessing the MMS SVN Source Code Repositories</h5>
                  <p class="formalpara">Access the source code repository for this project in one of following ways:</p>
                  <div class="procedure">
                     <a name="procedure-Procedure_for_Checking_Out_the_Source_Code_with_Subversion"/>
                     <ol class="1">
                        <li>
                           <p>Browse source code online to view this project's directory structure and files: <a xmlns:xlink="http://www.w3.org/1999/xlink" href="https://mobicents.googlecode.com/svn/trunk/servers/media">https://mobicents.googlecode.com/svn/trunk/servers/media</a>
				
                           </p>
                        </li>
                        <li>
                           <p>Check out source code with a Subversion client using the following command. Note: replace the last username with your own username:</p>
                           <pre class="screen">svn checkout http://mobicents.googlecode.com/svn/trunk/ mobicents-read-only</pre>
                        </li>
                     </ol>
                  </div>
                  <p>If you are new to Subversion, you may want to visit the <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://subversion.tigris.org/">Subversion Project website</a> and read
    <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://svnbook.red-bean.com/">Version Control with Subversion</a>.</p>
                  <p class="formalpara">
                     <a name="fpara-Subversion_Source_Code_Repository_Structure"/>
                  </p>
                  <h5 class="formalpara">Subversion Source Code Repository Structure</h5>
                  <p class="formalpara">The top-level directory structure under the /trunk/servers/media source tree is shown in the follwing table:</p>
                  <div class="informaltable">
                     <a name="informaltable-SVN_Source_Code_Repo_Structure"/>
                     <table border="1">
                        <colgroup>
                           <col align="left"/>
                           <col align="left"/>
                        </colgroup>
                        <thead>
                           <tr>
                              <th align="left">Path</th>
                              <th align="left">Description</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td align="left">/trunk/servers/media/constants</td>
                              <td align="left">Shared library for constants</td>
                           </tr>
                           <tr>
                              <td align="left">/trunk/servers/media/jar</td>
                              <td align="left">Media server SPI and implementation</td>
                           </tr>
                           <tr>
                              <td align="left">/trunk/servers/media/sar</td>
                              <td align="left">JBoss service deployment unit</td>
                           </tr>
                           <tr>
                              <td align="left">/trunk/servers/media/mgcpcontrol</td>
                              <td align="left">MGCP module</td>
                           </tr>
                           <tr>
                              <td align="left">/trunk/servers/media/mscontrol</td>
                              <td align="left">The API for media server control</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <p class="formalpara">
                     <a name="fpara-Building_the_MMS_from_Source_Code"/>
                  </p>
                  <h5 class="formalpara">Building the MMS from Source Code</h5>
                  <p class="formalpara">The build process is driven by maven configuration. The main maven script is the pom.xml file located in the project home directory. The purpose of the main pom.xml file is to compile the various module directories and then to integrate their output to produce the binary release. To build and install media server perform the following actions:</p>
                  <div class="procedure">
                     <a name="procedure-Steps_for_Building_and_Installing_the_MMS_"/>
                     <ol class="1">
                        <li>
                           <p class="title">
                              <b>Installing media server endpoints</b>
                           </p>
                           <p>switch to the /servers/media and run mvn install</p>
                        </li>
                        <li>
                           <p class="title">
                              <b>Installing Media Resource Adaptor with local link</b>
                           </p>
                           <p>switch to the /servers/jain-slee/resources/media and run mvn install</p>
                        </li>
                        <li>
                           <p class="title">
                              <b>Installing MGCP control module</b>
                           </p>
                           <p>switch to the /servers/jain-slee/resources/mgcp and run mvn install</p>
                        </li>
                     </ol>
                  </div>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-Mobicents_Media_Server_Architecture"/>8.2. Mobicents Media Server Architecture</h2>
                     </div>
                  </div>
               </div>
               <p>Media services have played an important role in the traditional Time Division Multiplexing (<acronym class="acronym">TDM</acronym>)-based telephone network. As the network migrates to an Internet Protocol (<acronym class="acronym">IP</acronym>)-based environment, media services are also moving to new environments.</p>
               <p>One of the most exciting trends is the emergence and adoption of complementary modular standards that leverage the Internet to enable media services to be developed, deployed and updated more rapidly than before in a network architecture that supports the two concepts we will call provisioning-on-demand and scaling-on-demand.</p>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Design_Overview_and_Typical_Deployment_Scenario"/>8.2.1. Design Overview and Typical Deployment Scenario</h3>
                        </div>
                     </div>
                  </div>
                  <h5 class="formalpara">General Design Overview</h5>
                  <p class="formalpara">Mobicents Media Server is developed on top of existing Java technologies. The Java platform is the ideal platform for network computing. It offers a single, unifying programming model that can connect all elements of a business infrastructure. The modularization effort is supported by the use of the Java Management Extension (<acronym class="acronym">JMX</acronym>) <acronym class="acronym">API</acronym>, and the industry-standard Service Logic Execution Environment (<acronym class="acronym">SLEE</acronym>) container. Using JMX enables easy management of both the server's media components and the control modules hosted by <acronym class="acronym">SLEE</acronym>.</p>
                  <p>This high degree of modularity benefits the application developer in several ways. The already-tight code can be further trimmed down to support applications that must have small footprints. For example, if <acronym class="acronym">PSTN</acronym> (Public Switched Telephone Network) interconnection is unnecessary in your application, then simply take the D-channel feature out of the server. If you later decide to deploy the same application within a Signaling System 7 (<acronym class="acronym">SS7</acronym>) network, then simply enable the appropriate endpoint. Another example is the freedom you have to drop your favorite media control protocol directly into the <acronym class="acronym">SLEE</acronym> container.</p>
                  <div class="figure">
                     <a name="figure-Media_Server_Overview"/>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <img src="images/sas-orig-dia-ms-general.jpg" align="middle" alt="Media Server Overview"/>
                        </div>
                     </div>
                     <p class="title">
                        <b>Figure 8.1. Media Server Overview</b>
                     </p>
                  </div>
                  <br class="figure-break"/>
                  <p>The components that are involved in media processing or endpoints are implemented with <acronym class="acronym">JMF</acronym>, the Java Media Framework. JMF provides a platform-neutral framework for displaying time-sensitive media. The <acronym class="acronym">JMF</acronym> 
                     <acronym class="acronym">API</acronym>:</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>Scales across different protocols and delivery mechanisms</p>
                        </li>
                        <li>
                           <p>Scales across different types of media data</p>
                        </li>
                        <li>
                           <p>Provides an event model for asynchnronous communication between JMF and applications or applets</p>
                        </li>
                     </ul>
                  </div>
                  <p>The <acronym class="acronym">JMF</acronym> architecture allows advanced developers nto create and integrate new types of controllers and data sources. The <acronym class="acronym">JMF</acronym> 
                     <acronym class="acronym">API</acronym> declares abstract interfaces which are used for handling new media sources and sinks such as audio and video files, <acronym class="acronym">PSTN</acronym> cards, webcams, etc.</p>
                  <p>The Media Server architecture assumes that call control intelligence is outside of the Media Server and handled by an external entity. The Mebia Server assumes that call controllers will use control procedures such as <acronym class="acronym">MGCP</acronym>, Mecago or <acronym class="acronym">MSML</acronym>, among others. Each specific control module can be plugged in directly to the server as a standard <acronym class="acronym">SLEE</acronym> deployable unit. The usage of a <acronym class="acronym">SLEE</acronym> container for the implementation of the control protocol-specific communication logic provides simple deployment and also the easy deployment of such control modules. The developer will not have to mess with low-level transaction and state management details, multi-threading, connection-pooling and other similar complex, low-level <acronym class="acronym">API</acronym>s.</p>
                  <div class="note">
                     <h2>Note</h2>
                     <p>The Mobicents Media Server uses <acronym class="acronym">SLEE</acronym> for implementing its own communication capabilities. The <acronym class="acronym">SLEE</acronym> container doesn't serve here as a call controller.</p>
                  </div>
                  <p>In addition to control protocol modules, the <acronym class="acronym">SLEE</acronym> container is aimed at providing high-level features like Interactive Voice Response (<acronym class="acronym">IVR</acronym>) and Drools or VoiceXML engines.</p>
                  <p>The modules deployed under <acronym class="acronym">SLEE</acronym> control interact with the Media Server Service Provider Interface (<acronym class="acronym">SPI</acronym>) through the Media Server Control Resource Adapter, or <acronym class="acronym">MSC-RA</acronym>. The <acronym class="acronym">MSC-RA</acronym> follows the recommendations of JSR-309 and implements asynchronous interconnection with the Media Server <acronym class="acronym">SPI</acronym> stack. This local implementation is restricted and does not all the use of high-level abstractions like VoiceXML dialogs, <abbr class="abbrev">etc.</abbr>.</p>
                  <h5 class="formalpara">Typical Deployment Scenario</h5>
                  <p class="formalpara">Mobicents Media Server offers a complete solution for all aspects of being a media gateway and server. This includes the Digital Signal Processors required to covert and compress <acronym class="acronym">TDB</acronym> voice circuits into <acronym class="acronym">IP</acronym> packets, announcement access points, conferencing, high-level IVR engines, <abbr class="abbrev">etc.</abbr> The gateway is able to provide signaling conversation and can operate as a Session Border Controller at the boundaries of Local Access Networks. The Media Server is always controlled by an external <acronym class="acronym">JBCP</acronym> application server which implements the call control logic.</p>
                  <div class="mediaobject" align="center">
                     <a name="mediaobj-ms-deplyment.gif"/>
                     <img src="images/ms-deplyment.gif" align="middle"/>
                     <div class="caption">
                        <p>Typical Deployment Scenario</p>
                     </div>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Endpoints"/>8.2.2. Endpoints</h3>
                        </div>
                     </div>
                  </div>
                  <h5 class="formalpara">Endpoints</h5>
                  <p class="formalpara">It is convenient to consider a media gateway as a collection of endpoints. An endpoint is a logical representation of a physical entity such as an analog phone or a channel in a trunk. Endpoints are sources or sinks of data and can be physical or virtual. Physical endpoint creation requires hardware installation whil esoftware is sufficient for creating a virtual endpoint. An interface on a gateway that terminates a trunk connected to a PSTN switch is an example of a physical endpoint. An audio source in an audio content server is an example of a virtual endpoint.</p>
                  <p>The type of the endpoint determines its functionality. Our analysis, so far, has led us to isolate the following basic endpoint types:</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>Digital Signal 0 (<acronym class="acronym">DS0</acronym>)</p>
                        </li>
                        <li>
                           <p>Analog line</p>
                        </li>
                        <li>
                           <p>Announcement server access point</p>
                        </li>
                        <li>
                           <p>Conference bridge acces point</p>
                        </li>
                        <li>
                           <p>Packet relay</p>
                        </li>
                        <li>
                           <p>Asynchronous Transfer Mode (<acronym class="acronym">ATM</acronym>) "trunk side" interface</p>
                        </li>
                     </ul>
                  </div>
                  <p>This list is not exhaustive: there may be other types of endpoints defined in the future, for example test endpoints that could be used to check network quality, or frame-relay endpoints that could be used to manage audio channels multiplexed over a frame-relay virtual circuit.</p>
                  <div class="variablelist">
                     <p class="title">
                        <b>Description of Various Access Point Types</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">Announcement Server Access Point</span>
                        </dt>
                        <dd>
                           <p>An announcement server endpoint naturally provides access to an announcement server. Upon receiving requests from the call agent, the announcement server will "play" a specified announcement. A given announcement endpoint is not expected to support more than one connection at a time. Connections to an announcement server are typically one-way, or "half-duplex":the announcement server is not expected to listen to the audio signals from the connection.</p>
                        </dd>
                        <dt>
                           <span class="term">Interactive Voice Response Access Point</span>
                        </dt>
                        <dd>
                           <p>An Interactive Voice Repsonse (<acronym class="acronym">IVR</acronym>) endpoint provides access to an <acronym class="acronym">IVR</acronym> service. Upon requests from the call agent, the <acronym class="acronym">IVR</acronym> server will "play" announcements and tones, and will "listen" to responses, such as (<acronym class="acronym">DTMF</acronym>) input or voice messages, from the user. A given <acronym class="acronym">IVR</acronym> endpoint is not expected to support more than one connection at a time.</p>
                        </dd>
                        <dt>
                           <span class="term">Conference Bridge Access Point</span>
                        </dt>
                        <dd>
                           <p>A conference bridge endpoint is used to provide access to a specific conference. Media gateways should be able to establish several connections between the endpoint and the packet networks, or between the endpoint and other endpoints in the same gateway. The signals originating from these connections shall be mixed according to the connection "mode" (as specified later in this document). The precise number of connections that an endpoint supports is characteristic of the gateway, and may in fact vary according to the alloction of resources within the gateway.</p>
                        </dd>
                        <dt>
                           <span class="term">Packet Relay</span>
                        </dt>
                        <dd>
                           <p>A packet relay endpoint is a specific form of conference bridge that typically only supports two connections. Packet relays can be found in firewalls between a protected and an open network, or in transcoding servers used to provide interoperation between incompatible gateways, such as gateways which don't support compatible compression algorithms, or gateways that operate over different transmission networks such as IP and ATM.</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Signal Generators (<acronym class="acronym">SG</acronym>s) and Signal Detectors (<acronym class="acronym">SD</acronym>s)</h5>
                  <p class="formalpara">This endpoint contains a set of resources which provide the media-processing functionality. It manages the interconnection of media streams between the resources, and arbitrates the flow of media stream data between them. Media servicesor commands are invoked by a client application on the endpoint; that endpoint causes the resources to perform the desired services, and directs events sent by the resources to the appropriate client. The resources in the endpoint include a primary resource and zero or more secondary resources. The primary resource is typically connected to an external media stream, and provides the data from that stream to the secondary resources. The secondary resources may process that stream (<abbr class="abbrev">e.g.</abbr> by recording it and/or performing automatic speech recognition on it), or may themselves generate generate media stream data (<abbr class="abbrev">e.g.</abbr> by playing a voice file) which is then transmitted to the primary resource.</p>
                  <p>A resource is statically prepared if the preparation takes place at the time of creation. A resource is dynamically prepared if preparation of a particular resource (and its associated media streams) does not occur until it is required by a media operation. Static preparation can lead to less efficient usage of a server's resources, because resources may tend to be allocated for a longer time before use. However, once a resource has been prepared, it is guaranteed to be available for use. Dynamic preparation may utilize resources more efficiently because of Just-In-Time (<acronym class="acronym">JIT</acronym>) allocation algorithms may be used.</p>
                  <p>An endpoint is divided logically into a Service Provider Interface (<acronym class="acronym">SPI</acronym>) that is used to implement specific a endpoint, and a management interface which is used for implementing manageable resources of that endpoint. All endpoints are plugged into the Mobicents <acronym class="acronym">SLEE</acronym> server by registering with the MBean server. The kernel in that sense is only an aggregator, and not a source of actual functionality. The functionality is provided by the <acronym class="acronym">SPI</acronym> implementation of the Mbeans, and in fact, all major endpoints are manageable MBeans interconnected through the MBean server. The best way to add endpoints to a Media Server is to write a new <acronym class="acronym">JMX</acronym> bean which provides implementation of the endpoint's <acronym class="acronym">SPI</acronym>.</p>
                  <p>The <acronym class="acronym">SPI</acronym> layer is an abstraction that endpoint providers must implement to enable their media-processing features. An implementation of <acronym class="acronym">SPI</acronym> for an endpoint is referred to as an <span class="emphasis">
                        <em>Endpoint Provider</em>
                     </span>.</p>
                  <div class="figure">
                     <a name="figure-EndpointManagementMBean_UML_Diagram"/>
                     <div class="figure-contents">
                        <div class="mediaobject" align="center">
                           <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="700">
                              <tr>
                                 <td align="center">
                                    <img src="images/sas-orig-dia-endpoint.png" align="middle" width="700" alt="EndpointManagementMBean UML Diagram"/>
                                 </td>
                              </tr>
                           </table>
                        </div>
                     </div>
                     <p class="title">
                        <b>Figure 8.2. EndpointManagementMBean UML Diagram</b>
                     </p>
                  </div>
                  <br class="figure-break"/>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Endpoint_Identifiers"/>8.2.3. Endpoint Identifiers</h3>
                        </div>
                     </div>
                  </div>
                  <p>The endpoint is identified by its local name. The syntax of the local name depends on the type of endpoint being named. However, the local name for each of these types is naturally hierarchical, beginning with a term which identifies the physical  gateway containing the given endpoint, and ending in a term which specifies the individual endpoint concerned.  With this in mind,  the JNDI naming rules are applied to the endpoint identifiers</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Connections"/>8.2.4. Connections</h3>
                        </div>
                     </div>
                  </div>
                  <p>Connections are created on the call agent on each endpoint that will be involved in the "call."  In the classic example of a connection between two "DS0" endpoints (EP1 and EP2), the call agents controlling the end points will establish two connections (C1 and C2):</p>
                  <div class="mediaobject" align="center">
                     <a name="mediaobj-msconn.jpg"/>
                     <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="672">
                        <tr>
                           <td align="center">
                              <img src="images/msconn.jpg" align="middle" width="672"/>
                           </td>
                        </tr>
                     </table>
                     <div class="caption">
                        <p>Media Server Connections</p>
                     </div>
                  </div>
                  <p>Each connection will be designated locally by a connection identifier, and will be characterized by connection attributes.</p>
                  <h5 class="formalpara">Resources and Connection Attributes</h5>
                  <p class="formalpara">Many types of resources will be associated to a connection, such as specific signal processing functions or packetization functions. Generally, these resources fall in two categories:</p>
                  <div class="variablelist">
                     <a name="varlist-Two_Types_of_Resources"/>
                     <p class="title">
                        <b>Two Types of Resources</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">Externally-Visible Resources</span>
                        </dt>
                        <dd>
                           <p>Externally visible resources, that affect the format of "the bits on the network" and must be communicated to the second endpoint involved in the connection.</p>
                        </dd>
                        <dt>
                           <span class="term">Internal Resources</span>
                        </dt>
                        <dd>
                           <p>Internal resources, that determine which signal is being sent over the connection and how the received signals are processed by the endpoint</p>
                        </dd>
                     </dl>
                  </div>
                  <p>The resources allocated to a connection, and more generally the handling of the connection, are chosen by the media server under instructions from the call agent.  The call agent will provide these  instructions by sending two set of parameters to the media server:</p>
                  <div class="itemizedlist">
                     <a name="itemlist-Two_Sets_of_Parameters"/>
                     <ul>
                        <li>
                           <p>The local directives instruct the gateway on the choice of resources that should be used for a connection.</p>
                        </li>
                        <li>
                           <p>When available, the "session description" provided by the other end of the connection.</p>
                        </li>
                     </ul>
                  </div>
                  <p>The local directives specify such parameters as the mode of the connection (e.g. send only, send-receive), preferred coding or packetization methods, usage of echo cancellation or silence suppression.  (A detailed list can be found in the specification of   the LocalConnectionOptions parameter of the CreateConnection command.) For each of these parameters, the call agent can either specify a value, a range of value, or no value at all.  This allow various implementations to implement various level of control, from a very tight control where the call agent specifies minute details of   the connection handling to a very loose control where the call agent only specifies broad guidelines, such as the maximum bandwidth, and let the gateway choose the detailed values.</p>
                  <p>Based on the value of the local directives, the gateway will determine the resources allocated to the connection.  When this is possible, the gateway will choose values that are in line with the remote session description - but there is no absolute requirement that the parameters be exactly the same.</p>
                  <p>Once the resource have been allocated, the gateway will compose a "session description" that describes the way it intends to receive packets.  Note that the session description may in some cases present a range of values.  For example, if the gateway is ready to accept one of several compression algorithm, it can provide a list of these accepted algorithms.</p>
                  <p class="formalpara">
                     <a name="fpara-Local_Connections_are_a_Special_Case"/>
                  </p>
                  <h5 class="formalpara">Local Connections are a Special Case</h5>
                  <p class="formalpara">Large gateways include a large number of endpoints which are often of different types.  In some networks, we may often have to setup connections between endpoints that are located within the same gateway.  Examples of such connections may be:</p>
                  <div class="itemizedlist">
                     <a name="itemlist-Examples_of_Local_Connections"/>
                     <ul>
                        <li>
                           <p>Connecting a trunk line to a wiretap device,</p>
                        </li>
                        <li>
                           <p>Connecting a call to an Interactive Voice-Response unit</p>
                        </li>
                        <li>
                           <p>Connecting a call to a Conferencing unit</p>
                        </li>
                        <li>
                           <p>Routing a call from on endpoint to another, something often described as a "hairpin" connection.</p>
                        </li>
                     </ul>
                  </div>
                  <p>Local connections are much simpler to establish than network connections. In most cases, the connection will be established through some local interconnecting device, such as for example a TDM bus.</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Events_and_Signals"/>8.2.5. Events and Signals</h3>
                        </div>
                     </div>
                  </div>
                  <p>The concept of events and signals is central to the Media Server.  A Call Controller may ask to be notified about certain events occurring in an endpoint  (e.g., off-hook events) by passing event's identifier as parameter to endpoint's subscribe(...) method.</p>
                  <p>A Call Controller may also request certain signals to be applied to an endpoint (e.g., dial-tone) by supplying the identifier of the event in as argument to endpoint's apply(...) method.</p>
                  <p>Events and signals are grouped in packages, within which they share the same name space which we will refer to as event identifier in the following. Event identifiers are integer constants. Some of the events may be parametrized with additional data such as DTMF mask.</p>
                  <p>Signals are divided into different types depending on their behavior:</p>
                  <div class="variablelist">
                     <a name="varlist-Types_of_Signals"/>
                     <p class="title">
                        <b>Types of Signals</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">On/off (OO)</span>
                        </dt>
                        <dd>
                           <p>Once applied, these signals last until they are turned off.  This can only happen as the result of a reboot/restart or a new signal request where the signal is explicitly turned off.  Signals of type OO are defined to be idempotent, thus multiple requests to turn a given OO signal on (or off) are perfectly valid.  An On/Off signal could be a visual message-waiting indicator (VMWI).  Once turned on, it MUST NOT be turned off until explicitly instructed to by the Call Agent, or as a result of an endpoint restart, i.e., these signals will not turn off as a result of the detection of a requested event.</p>
                        </dd>
                        <dt>
                           <span class="term">Time-out (TO)</span>
                        </dt>
                        <dd>
                           <p>Once applied, these signals last until they are either cancelled (by the occurrence of an event or by explicit releasing of signal generator), or a signal-specific period of time has elapsed.  A TO signal that times out will generate an "operation complete" event.  If an event occurs prior to the 180 seconds, the signal will, by default, be stopped (the "Keep signals active" action - will override this behavior).  If the signal is not stopped, the signal will time out, stop and generate an "operation complete" event, about which the server controller may or may not have requested to be notified.  A TO signal that fails after being started, but before having generated an "operation complete" event will generate an "operation failure" event which will include the name of the signal that failed.  Deletion of a connection with an active TO signal will result in such a failure.</p>
                        </dd>
                        <dt>
                           <span class="term">Brief (BR)</span>
                        </dt>
                        <dd>
                           <p>The duration of these signals is normally so short that they stop on their own.  If a signal stopping event occurs, or a new signal requests is applied, a currently active BR signal will not stop.  However, any pending BR signals not yet applied will be cancelled (a BR signal becomes pending if a signal request includes a BR signal, and there is already an active BR signal). As an example, a brief tone could be a DTMF digit. If the DTMF digit "1" is currently being played, and a signal stopping event occurs, the "1" would play to completion.  If a request to play DTMF digit "2" arrives before DTMF digit "1" finishes playing, DTMF digit "2" would become pending.</p>
                        </dd>
                     </dl>
                  </div>
                  <p>Signal(s) may be generated on endpoints or on connections. To each event is associated one or more actions, which can be:</p>
                  <div class="itemizedlist">
                     <a name="itemlist-Types_of_Actions_Which_Can_Be_Associated_with_Events"/>
                     <ul>
                        <li>
                           <p>Notify the event immediately, together with the accumulated list of observed events</p>
                        </li>
                        <li>
                           <p>Accumulate the event in an event buffer, but don't notify yet</p>
                        </li>
                        <li>
                           <p>Keep Signal(s) active</p>
                        </li>
                        <li>
                           <p>Ignore the event</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-MMS_Configuration"/>8.3. MMS Configuration</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <p>All endpoints are plugged into Mobicents SLEE server by registering with the MBean server. After Media server has succesfully started you can locate the JMX console at <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://localhost:8080/jmx-console">http://localhost:8080/jmx-console</a> in the default distribution. Notice that if you have configured the servlet container (Tomcat) to service a different port then you need to supply another port number in the URL.</p>
               <div class="mediaobject" align="center">
                  <a name="mediaobj-jmx-console.GIF"/>
                  <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="700">
                     <tr>
                        <td align="center">
                           <img src="images/jmx-console.GIF" align="middle" width="700"/>
                        </td>
                     </tr>
                  </table>
                  <div class="caption">
                     <p/>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Announcement_Server_Access_Points"/>8.3.1. Announcement Server Access Points</h3>
                        </div>
                     </div>
                  </div>
                  <p>An announcement server endpoint provides access to an announcement service.Under requests from the Call Agent,the announcement server will “<span class="quote">play</span>” a specified announcement. A given announcement endpoint is not expected to support more than one connection at a time. Connections to an announcement server are typically one way,or “<span class="quote">half duplex</span>”the announcement server is not expected to listen to the audio signals from the connection.</p>
                  <h5 class="formalpara">Configuration of an Announcement Server Access Point</h5>
                  <p class="formalpara">The configurable attributes of the announcment player are as follows:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">JndiName</span>
                        </dt>
                        <dd>
                           <p>The JNDI name under which endpoint is to be bound.</p>
                        </dd>
                        <dt>
                           <span class="term">BindAddress</span>
                        </dt>
                        <dd>
                           <p>The IP address to which this endpoint will be bound.</p>
                        </dd>
                        <dt>
                           <span class="term">Jitter</span>
                        </dt>
                        <dd>
                           <p>The size of jitter buffer in milliseconds.</p>
                        </dd>
                        <dt>
                           <span class="term">PacketizationPeriod</span>
                        </dt>
                        <dd>
                           <p>the period of media stream packetization in milliseconds.</p>
                        </dd>
                        <dt>
                           <span class="term">PCMA</span>
                        </dt>
                        <dd>
                           <p>enable or disable G711 (A-law) codec support.</p>
                        </dd>
                        <dt>
                           <span class="term">PCMU</span>
                        </dt>
                        <dd>
                           <p>enable or disable G711 (U-law) codec support.</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Supported Media Types and Formats</h5>
                  <p class="formalpara">Supported the media types and formats are listed below:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">WAVE (.wav)</span>
                        </dt>
                        <dd>
                           <p>16-bit mono/stereo linear	</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Supported RTP Formats</h5>
                  <p class="formalpara">Endpoint is able to receive the follwing RTP media  types:</p>
                  <div class="informaltable">
                     <table border="1">
                        <colgroup>
                           <col align="left"/>
                           <col align="left"/>
                        </colgroup>
                        <thead>
                           <tr>
                              <th align="left">Media Type</th>
                              <th align="left">Payload Number</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td align="left">Audio: G711 (A-law) 8bit, 8kHz</td>
                              <td align="left">8</td>
                           </tr>
                           <tr>
                              <td align="left">Audio: G711 (U-law) 8bit, 8kHz</td>
                              <td align="left">0</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <h5 class="formalpara">Supported Packages</h5>
                  <p class="formalpara">Supported packages are as follows:</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>
					
                              <code class="literal">org.mobicents.media.server.spi.events.Announcement</code>
				
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Interactive_Voice_Response"/>8.3.2. Interactive Voice Response</h3>
                        </div>
                     </div>
                  </div>
                  <p>An Interactive Voice Response (IVR) endpoint provides access to an IVR service. Under requests from the Call Agent, the IVR server will “<span class="quote">play</span>” announcements and tones, and will “<span class="quote">listen</span>” to voice messages, from the user. A given IVR endpoint is not expected to support more than one connection at a time. If several connections were established to the same endpoint, then the same tones and announcements would be played simultaneously over all the connections.</p>
                  <div class="example">
                     <a name="example-The_IVREndpointManagement_MBean"/>
                     <div class="example-contents">
                        <a name="proglist-The_IVREndpointManagement_MBean"/>
                        <pre class="programlisting">&lt;mbean   code="org.mobicents.media.server.impl.ivr.IVREndpointManagement"    name="media.mobicents:endpoint=ivr"&gt;
        &lt;attribute name="JndiName"&gt;media/endpoint/IVR&lt;/attribute&gt;
        &lt;attribute name="BindAddress"&gt;${jboss.bind.address}&lt;/attribute&gt;
        &lt;attribute name="Jitter"&gt;60&lt;/attribute&gt;
        &lt;attribute name="PacketizationPeriod"&gt;20&lt;/attribute&gt;
        &lt;attribute name="PortRange"&gt;1024-65535&lt;/attribute&gt;
        &lt;attribute name="PCMU"&gt;true&lt;/attribute&gt;
        &lt;attribute name="PCMA"&gt;false&lt;/attribute&gt;
        &lt;attribute name="MediaType"&gt;audio.x_wav&lt;/attribute&gt;
        &lt;attribute name="RecordDir"&gt;${jboss.server.data.dir}&lt;/attribute&gt;
        &lt;attribute name="DTMF"&gt;detector.mode=AUTO&lt;/attribute&gt;
    &lt;/mbean&gt;</pre>
                     </div>
                     <p class="title">
                        <b>Example 8.1. The IVREndpointManagement MBean</b>
                     </p>
                  </div>
                  <br class="example-break"/>
                  <h5 class="formalpara">Configuration of the Announcement Player</h5>
                  <p class="formalpara">The configurable attributes of the announcment player are as follows:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">JndiName</span>
                        </dt>
                        <dd>
                           <p>The JNDI name under which endpoint is to be bound.</p>
                        </dd>
                        <dt>
                           <span class="term">BindAddress</span>
                        </dt>
                        <dd>
                           <p>The IP address to which this endpoint will be bound.</p>
                        </dd>
                        <dt>
                           <span class="term">Jitter</span>
                        </dt>
                        <dd>
                           <p>The size of jitter buffer in milliseconds.</p>
                        </dd>
                        <dt>
                           <span class="term">PacketizationPeriod</span>
                        </dt>
                        <dd>
                           <p>the period of media stream packetization in milliseconds.</p>
                        </dd>
                        <dt>
                           <span class="term">PCMA</span>
                        </dt>
                        <dd>
                           <p>enable or disable G711 (A-law) codec support.</p>
                        </dd>
                        <dt>
                           <span class="term">PCMU</span>
                        </dt>
                        <dd>
                           <p>enable or disable G711 (U-law) codec support.</p>
                        </dd>
                        <dt>
                           <span class="term">RecordDir</span>
                        </dt>
                        <dd>
                           <p>The record directory where the recorded files should be created and stored </p>
                        </dd>
                        <dt>
                           <span class="term">DTMF</span>
                        </dt>
                        <dd>
                           <p>The DTMF supported. By default its AUTO, but you can also specify INBAND or RFC2833. If its RFC2833, you need to specify the DTMF Paylod property also. For example:</p>
                           <pre class="programlisting">&lt;attribute name="DTMF"&gt;
                                                               detector.mode=INBAND
                                                               dtmf.payload = 101
                                                      &lt;/attribute&gt;</pre>
                           <div class="variablelist">
                              <dl>
                                 <dt>
                                    <span class="term">detector.mode.</span>
                                 </dt>
                                 <dd>
                                    <p>Configures DTMF detector mode. Possible values are AUTO, INBAND and RFC2833</p>
                                 </dd>
                                 <dt>
                                    <span class="term">dtmf.payload.</span>
                                 </dt>
                                 <dd>
                                    <p>Configures the payload number if RFC2833 mode is specified</p>
                                 </dd>
                              </dl>
                           </div>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Supported Media Types and Formats</h5>
                  <p class="formalpara">Supported the media types and formats are listed below:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">WAVE (.wav)</span>
                        </dt>
                        <dd>
                           <p>16-bit mono/stereo linear</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Supported RTP Formats</h5>
                  <p class="formalpara">Endpoint is able to receive the follwing RTP media  types:</p>
                  <div class="informaltable">
                     <a name="informaltable-"/>
                     <table border="1">
                        <colgroup>
                           <col align="left"/>
                           <col align="left"/>
                        </colgroup>
                        <thead>
                           <tr>
                              <th align="left">Media Type</th>
                              <th align="left">Payload Number</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td align="left">Audio: G711 (A-law) 8bit, 8kHz</td>
                              <td align="left">8</td>
                           </tr>
                           <tr>
                              <td align="left">Audio: G711 (U-law) 8bit, 8kHz</td>
                              <td align="left">0</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <h5 class="formalpara">Record Directory Configuration</h5>
                  <p class="formalpara">You can specify the common directory where all the recorded files will be stored or don't use this attribute at all in which case default directory is null and the application needs to pass the absolute path for recording.</p>
                  <h5 class="formalpara">Supported Packages</h5>
                  <p class="formalpara">Supported packages are as follows:</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>
					
                              <code class="literal">org.mobicents.media.server.spi.events.Announcement</code>
				
                           </p>
                        </li>
                        <li>
                           <p>
					
                              <code class="literal">org.mobicents.media.server.spi.events.Basic</code>
				
                           </p>
                        </li>
                        <li>
                           <p>
					
                              <code class="literal">org.mobicents.media.server.spi.events.AU</code>
				
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Packet_Relay_Endpoint"/>8.3.3. Packet Relay Endpoint</h3>
                        </div>
                     </div>
                  </div>
                  <p>A packet relay endpoint is a specific form of conference bridge, that typically only supports two connections.  Packets relays can be found in firewalls between a protected and an open network, or in transcoding servers used to provide interoperation between incompatible gateways, for example gateways that do not support compatible compression algorithms, or gateways that operate over different transmission networks such as IP and ATM.</p>
                  <h5 class="formalpara">Configuration of the Packet Relay Endpoint</h5>
                  <p class="formalpara">The configurable attributes of the announcment player are as follows:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">JndiName</span>
                        </dt>
                        <dd>
                           <p>The JNDI name under which endpoint is to be bound.</p>
                        </dd>
                        <dt>
                           <span class="term">BindAddress</span>
                        </dt>
                        <dd>
                           <p>The IP address to which this endpoint will be bound.</p>
                        </dd>
                        <dt>
                           <span class="term">Jitter</span>
                        </dt>
                        <dd>
                           <p>The size of jitter buffer in milliseconds.</p>
                        </dd>
                        <dt>
                           <span class="term">PacketizationPeriod</span>
                        </dt>
                        <dd>
                           <p>the period of media stream packetization in milliseconds.</p>
                        </dd>
                        <dt>
                           <span class="term">PCMA</span>
                        </dt>
                        <dd>
                           <p>enable or disable G711 (A-law) codec support.</p>
                        </dd>
                        <dt>
                           <span class="term">PCMU</span>
                        </dt>
                        <dd>
                           <p>enable or disable G711 (U-law) codec support.</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Supported RTP Formats</h5>
                  <p class="formalpara">Endpoint is able to receive the follwing RTP media  types:</p>
                  <div class="informaltable">
                     <table border="1">
                        <colgroup>
                           <col align="left"/>
                           <col align="left"/>
                        </colgroup>
                        <thead>
                           <tr>
                              <th align="left">Media Type</th>
                              <th align="left">Payload Number</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td align="left">Audio: G711 (A-law) 8bit, 8kHz</td>
                              <td align="left">8</td>
                           </tr>
                           <tr>
                              <td align="left">Audio: G711 (U-law) 8bit, 8kHz</td>
                              <td align="left">0</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <h5 class="formalpara">DTMF Configuration</h5>
                  <p class="formalpara">The DTMF configuration is determinted by DTMF attribute. The properties are as follows:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">detector.mode.</span>
                        </dt>
                        <dd>
                           <p>Configures DTMF detector mode. Possible values are AUTO, INBAND and RFC2833.</p>
                        </dd>
                        <dt>
                           <span class="term">dtmf.payload</span>
                        </dt>
                        <dd>
                           <p>Configures the payload number if RFC2833 mode is specified</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Supported Packages</h5>
                  <p class="formalpara">Supported packages are as follows:</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>
					
                              <code class="literal">org.mobicents.media.server.spi.events.Basic</code>
				
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Conference_Bridge_Endpoint"/>8.3.4. Conference Bridge Endpoint</h3>
                        </div>
                     </div>
                  </div>
                  <p>Media server should be able to establish several connections between the endpoint and the packet networks, or between the endpoint and other endpoints in the same gateway.  The signals originating from these connections shall be mixed according to the connection “<span class="quote">mode</span>”, as specified later in this document. The precise number of connections that an endpoint support is a characteristic of the gateway, and may in fact vary according with the allocation of resource within the gateway.</p>
                  <h5 class="formalpara">Configuration of the Conference Bridge Endpoint</h5>
                  <p class="formalpara">The configurable attributes of the announcment player are as follows:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">JndiName</span>
                        </dt>
                        <dd>
                           <p>The JNDI name under which endpoint is to be bound.</p>
                        </dd>
                        <dt>
                           <span class="term">BindAddress</span>
                        </dt>
                        <dd>
                           <p>The IP address to which this endpoint will be bound.</p>
                        </dd>
                        <dt>
                           <span class="term">Jitter</span>
                        </dt>
                        <dd>
                           <p>The size of jitter buffer in milliseconds.</p>
                        </dd>
                        <dt>
                           <span class="term">PacketizationPeriod</span>
                        </dt>
                        <dd>
                           <p>the period of media stream packetization in milliseconds.</p>
                        </dd>
                        <dt>
                           <span class="term">PCMA</span>
                        </dt>
                        <dd>
                           <p>enable or disable G711 (A-law) codec support.</p>
                        </dd>
                        <dt>
                           <span class="term">PCMU</span>
                        </dt>
                        <dd>
                           <p>enable or disable G711 (U-law) codec support.</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Supported RTP Formats</h5>
                  <p class="formalpara">This endpoint is able to receive the follwing RTP media  types:</p>
                  <div class="informaltable">
                     <a name="informaltable-RTP_Formats_Supported_by_the_Conference_Bridge_Endpoint"/>
                     <table border="1">
                        <colgroup>
                           <col align="left"/>
                           <col align="left"/>
                        </colgroup>
                        <thead>
                           <tr>
                              <th align="left">Media Type</th>
                              <th align="left">Payload Number</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td align="left">Audio: G711 (A-law) 8bit, 8kHz</td>
                              <td align="left">8</td>
                           </tr>
                           <tr>
                              <td align="left">Audio: G711 (U-law) 8bit, 8kHz</td>
                              <td align="left">0</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <h5 class="formalpara">DTMF Configuration</h5>
                  <p class="formalpara">The DTMF configuration is determinted by DTMF attribute. The properties are as follows:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">detector.mode</span>
                        </dt>
                        <dd>
                           <p>Configures DTMF detector mode. Possible values are AUTO, INBAND and RFC2833.</p>
                        </dd>
                        <dt>
                           <span class="term">
					
                              <code class="literal">dtmf.payload</code>
				
                           </span>
                        </dt>
                        <dd>
                           <p>Configures DTMF detector mode. Possible values are AUTO, INBAND and RFC2833.</p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">Supported Packages</h5>
                  <p class="formalpara">Supported packages are as follows:</p>
                  <div class="itemizedlist">
                     <ul>
                        <li>
                           <p>
					
                              <code class="literal">org.mobicents.media.server.spi.events.Basic</code>
				
                           </p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-MMS_Control_Protocols"/>8.4. MMS Control Protocols</h2>
                     </div>
                  </div>
               </div>
               <p>Media Server assumes a call control architecture where the call control “<span class="quote">intelligence</span>” is outside the Media Server and handled by external call control elements known as Call State Control Function.The media server assumes that these call control elements, or CSCF,will synchronize with each other to send coherent commands and responses to the media servers under their control. Server Control Protocols is, in essence, a master/slave asynchronous protocol, where the Server Control Modules are expected to execute commands sent by CSCF. Each Server Control Module is implemented as JSLEE application and consist of a set of SBBs which are in charge to communicate with media server's endpoints via SPI. It allows to avoid difficulties with programming concurrency, low level transaction and state management details, connection pooling and other complex-level APIs.</p>
               <h5 class="formalpara">The MGCP Module</h5>
               <p class="formalpara">The MGCP module is included in default binary distribution. The Call Agent uses MGCP to tell the Media Server:</p>
               <div class="itemizedlist">
                  <ul>
                     <li>
                        <p>what events should be reported to the Call Agent</p>
                     </li>
                     <li>
                        <p>how endpoints should be connected together</p>
                     </li>
                     <li>
                        <p>what signals should be played on endpoints</p>
                     </li>
                  </ul>
               </div>
               <h5 class="formalpara">Configuring the MGCP Module</h5>
               <p class="formalpara">The default port for MGCP is 2728. You can mobicents management console to override the default value.</p>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-MMS_Control_API"/>8.5. MMS Control API</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <p>The main objective of the Media Server control API is to provide multimedia application developers with a Media Server abstraction interface.</p>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Basic_Components_of_the_MMS_API"/>8.5.1. Basic Components of the MMS API</h3>
                        </div>
                     </div>
                  </div>
                  <p>In this section we describes the basic objects of the API as well as the common design patterns.</p>
                  <p>The API components consist of a related set of interfaces, classes, operations, events, capabilities, and exceptions. The API provides seven key objects, which are common MS and more advanced packages. We provide a very brief description of the API in this overview document; The seven key objects are:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">MsProvider</span>
                        </dt>
                        <dd>
                           <p>Represents the “window” through which an application views the call processing.</p>
                        </dd>
                        <dt>
                           <span class="term">MsSession</span>
                        </dt>
                        <dd>
                           <p>Represents a call and is a dynamic “collection of physical and logical entities” that bring two or more endpoints together.</p>
                        </dd>
                        <dt>
                           <span class="term">MsEndpoint</span>
                        </dt>
                        <dd>
                           <p>Represents a logical endpoint (e.g., announcement access server, IVR).</p>
                        </dd>
                        <dt>
                           <span class="term">MsConnection</span>
                        </dt>
                        <dd>
                           <p>Represents the dynamic relationship between a MsSession and an UA.</p>
                        </dd>
                        <dt>
                           <span class="term">MsLink</span>
                        </dt>
                        <dd>
                           <p>Represent the dynamic relationship between a two endpoint located on same Media server</p>
                        </dd>
                        <dt>
                           <span class="term">MsSignalGenerator</span>
                        </dt>
                        <dd>
                           <p>Represents the media resource which is responsible for generating media</p>
                        </dd>
                        <dt>
                           <span class="term">MsSignalDetector</span>
                        </dt>
                        <dd>
                           <p>Represents the media resource which is responsible for detecting media.</p>
                        </dd>
                     </dl>
                  </div>
                  <p>The purpose of a MsConnection object is to describe the relationship between a MsSession object and an UA. A MsConnection object exists if the UA is a part of the media session. MsConnection objects are immutable in terms of their MsSession and UA references. In other words, the MsSession and UA object references do not change throughout the lifetime of the MsConnection object instance. The same MsConnection object may not be used in another MsSession.</p>
                  <div class="mediaobject" align="center">
                     <a name="mediaobj-MSControlAPI.jpg"/>
                     <img src="images/MSControlAPI.jpg" align="middle"/>
                     <div class="caption">
                        <p/>
                     </div>
                  </div>
                  <p>MsProvider can be used to create the MsSession as well as SignalGenerator and SignalDetector.</p>
                  <p>MsSession is a transient association of (zero or more) connection for the purposes of engaging in a real-time communications interchange. The session and its associated connection objects describe the control and media flows taking place in a communication network. Applications create instances of a MsSession object with the MsProvider.createSession() method, which returns a MsSession object that has zero connections and is in the IDLE state. The MsProvider object instance does not change throughout the lifetime of the MsSession object. The MsProvider associated with a MsSession is obtained via the getProvider() method.</p>
                  <p>Application creates instance of MsConnection object with the MsSession.createNetworkConnection(String endpointName). The Application calls MsConnection.modify(String localDesc, String remoteDesc) passing the local SDP and remote SDP. The MsConnection at this time will find out corresponding EndPoint from JNDI using endPointName passed to it and call createConnection(int mode) to create instance of Connection. This Connection creates the instance of RtpSocketAdaptorImpl which opens up the socket for RTP data transfer. The transfer of data has not yet started.</p>
                  <p>Application creates instance of MsLink object with the MsSession.createLink(MsLinkMode mode). The Application calls MsLink.join(String endpointName1, String endpointName2) passing the endpoint names of two local endpoint to be joined. The MsLink at this time will find out corresponding EndPoint's from JNDI using endPointName passed to it and call createConnection(int mode) to create instance of Connection. This Connection creates the instance of RtpSocketAdaptorImpl which opens up the socket for RTP data transfer. The transfer of data has not yet started. As soon as Connections are created for both the Endpoint's, setOtherParty(Connection other) is called on each Connection passing the other Connection which starts the data transfer between two Connection's.</p>
                  <p>The Application creates instance of MsSignalGenerator using MsProvider.getSignalGenerator(endpointName) passing endPointName. Application calls MsGenerator.apply(Announcement.PLAY, new String[] { Audio file URL }) to play the audio file. At this point MsGenerator looks up the EndPoint corresponding the endpointName passed and simply calls play on it to start the transmission of audio via RTP.</p>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Basic_API_Patterns_Listeners"/>8.5.2. Basic API Patterns: Listeners</h3>
                        </div>
                     </div>
                  </div>
                  <p>The basic programming pattern of the API is that applications (which reside “<span class="quote">above</span>” the API) make synchronous calls to API methods. The platform or network element implementing the API can inform the application of underlying events (e.g. the arrival of incoming calls) by means of Java events. The application provides Listener objects corresponding to the events that it is interested in obtaining.</p>
                  <div class="variablelist">
                     <p class="title">
                        <b>Listeners</b>
                     </p>
                     <dl>
                        <dt>
                           <span class="term">MsSessionListener</span>
                        </dt>
                        <dd>
                           <p>For underlying application that is interested in receiving events for state change of MsSession should implement MsSessionListener.</p>
                        </dd>
                        <dt>
                           <span class="term">MsConnectionListener</span>
                        </dt>
                        <dd>
                           <p>For underlying application that is interested in receiving events for state change of MsConnection should implement MsConnectionListener.</p>
                        </dd>
                        <dt>
                           <span class="term">MsLinkListener</span>
                        </dt>
                        <dd>
                           <p>For underlying application that is interested in receiving events for state change of MsLink should implement MsLinkListener.</p>
                        </dd>
                        <dt>
                           <span class="term">MsResourceListener</span>
                        </dt>
                        <dd>
                           <p>For underlying application that is interested in receiving events for state change of MsSignalDetector or MsSignalGenerator should implement MsResourceListener.</p>
                        </dd>
                     </dl>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-Events"/>8.5.3. Events</h3>
                        </div>
                     </div>
                  </div>
                  <p>Each of the listener's defined above are listening to different type's of events that are fired by API.</p>
                  <h5 class="formalpara">Events related to MsSession</h5>
                  <p class="formalpara">MsSessionListener is listening for MsSessionEvent which carries the MsSessionEventID that represents state change of MsSession. The following table shows the different types of MsSessionEventID, when these events would be fired and corresponding methods of MsSessionListener that will be called.</p>
                  <div class="informaltable">
                     <a name="informaltable-Events_Related_to_MsSession"/>
                     <table border="1">
                        <colgroup>
                           <col align="left"/>
                           <col align="left"/>
                           <col align="left"/>
                        </colgroup>
                        <thead>
                           <tr>
                              <th align="left">MsSessionEventID</th>
                              <th align="left">Description</th>
                              <th align="left">MsSessionListener Method Called</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td align="left">SESSION_CREATED</td>
                              <td align="left">Fired when MsProvider.createSession() is called and a new MsSession
        is created</td>
                              <td align="left">public void sessionCreated(MsSessionEvent evt)</td>
                           </tr>
                           <tr>
                              <td align="left">SESSION_CREATED</td>
                              <td align="left">Fired when MsProvider.createSession() is called and a new MsSession
        is created</td>
                              <td align="left">public void sessionCreated(MsSessionEvent evt)</td>
                           </tr>
                           <tr>
                              <td align="left">SESSION_ACTIVE</td>
                              <td align="left">When the MsConnection or MsLink is created on MsSession for first
        time it transitions to ACTIVE state and SESSION_ACTIVE is fired.
        After this the state remains ACTIVE even if application creates
        more MsConnections or MsLinks</td>
                              <td align="left">public void sessionActive(MsSessionEvent evt)</td>
                           </tr>
                           <tr>
                              <td align="left">SESSION_INVALID</td>
                              <td align="left">When all the MsConnection or MsLink objects are disassociated from
        MsSession, it transitions to INVALID state and SESSION_INVALID is
        fired</td>
                              <td align="left">public void sessionInvalid(MsSessionEvent evt)</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <h5 class="formalpara">Events Related to MsConnection</h5>
                  <p class="formalpara">MsConnectionListener is listening for MsConnectionEvent which carries the MsConnectionEventID that represents state change of MsConnection. The following table shows the different types of MsConnectionEventID and when these events would be fired and corresponding methods of MsConnectionListener that will be called.</p>
                  <div class="informaltable">
                     <a name="informaltable-Events_Related_to_MsConnection"/>
                     <table border="1">
                        <colgroup>
                           <col align="left"/>
                           <col align="left"/>
                           <col align="left"/>
                        </colgroup>
                        <thead>
                           <tr>
                              <th align="left">MsConnectionEventID</th>
                              <th align="left">Description</th>
                              <th align="left">MsConnectionListener Method Called</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td align="left">CONNECTION_INITIALIZED</td>
                              <td align="left">As soon as new MsConnection is created by calling MsSession.createNetworkConnection(String endpointName) CONNECTION_INITIALIZED is fired</td>
                              <td align="left">public void connectionInitialized(MsConnectionEvent event)</td>
                           </tr>
                           <tr>
                              <td align="left">CONNECTION_CREATED</td>
                              <td align="left">As soon as creation of RTP connection (by calling MsConnection.modify(String localDesc, String remoteDesc)) is successful, CONNECTION_CREATED is fired. When modify() is called, MsConnection checks if there is Endpoint associated with it and if there is no Endpoint means this is creation of RTP connection request</td>
                              <td align="left">public void connectionCreated(MsConnectionEvent event)</td>
                           </tr>
                           <tr>
                              <td align="left">CONNECTION_MODIFIED</td>
                              <td align="left">As soon as modification of MsConnection (by calling MsConnection.modify(String localDesc, String remoteDesc)) is successful CONNECTION_MODIFIED is fired. When modify() is called, MsConnection checks if there is Endpoint associated it and if there is Enpoint means this is modification request.</td>
                              <td align="left">public void connectionModifed(MsConnectionEvent event)</td>
                           </tr>
                           <tr>
                              <td align="left">CONNECTION_DELETED</td>
                              <td align="left">As soon as MsConnection is successfully released (MsConnection.release()) CONNECTION_DELETED is fired</td>
                              <td align="left">public void connectionDeleted(MsConnectionEvent event)</td>
                           </tr>
                           <tr>
                              <td align="left">@Deprecated TX_FAILED</td>
                              <td align="left">When ever creation of new RTP connection or modification of existing MsConnection fails, TX_FAILED is fired</td>
                              <td align="left">public void txFailed(MsConnectionEvent event)</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <h5 class="formalpara">Events Related to MsLink</h5>
                  <p class="formalpara">MsLinkListener is listening for MsLinkEvent which carries the MsLinkEventID that represents state change of MsLink. The following table shows the different types of MsLinkEventID and when these events would be fired and corresponding methods of MsLinkListener that will be called.</p>
                  <div class="informaltable">
                     <a name="informaltable-Events_Related_to_MsLink"/>
                     <table border="1">
                        <colgroup>
                           <col align="left"/>
                           <col align="left"/>
                           <col align="left"/>
                        </colgroup>
                        <thead>
                           <tr>
                              <th align="left">MsLinkEventID</th>
                              <th align="left">Description</th>
                              <th align="left">MsLinkListener Method Called</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td align="left">LINK_CREATED</td>
                              <td align="left">As soon as new MsLink is created by calling MsSession.createLink(MsLinkMode mode) LINK_CREATED is fired</td>
                              <td align="left">public void linkCreated(MsLinkEvent evt)</td>
                           </tr>
                           <tr>
                              <td align="left">LINK_JOINED</td>
                              <td align="left">Fired as soon as join(String a, String b) operation of MsLink is successful</td>
                              <td align="left">public void linkJoined(MsLinkEvent evt)</td>
                           </tr>
                           <tr>
                              <td align="left">INK_DROPPED</td>
                              <td align="left">Fired as soon as release() operation of MsLink is successful</td>
                              <td align="left">public void linkDropped(MsLinkEvent evt)</td>
                           </tr>
                           <tr>
                              <td align="left">LINK_FAILED</td>
                              <td align="left">Fired as soon as join(String a, String b) operation of MsLink fails</td>
                              <td align="left">public void linkFailed(MsLinkEvent evt)</td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-MSC_API_Objects_Finite_State_Machines"/>8.5.4. MSC API Objects: Finite State Machines</h3>
                        </div>
                     </div>
                  </div>
                  <p/>
                  <h5 class="formalpara">MsSessionState Finite State Machine</h5>
                  <p class="formalpara">The behavior of the MsSession is specified in terms of Finite State Machines (FSMs) represented by MsSessionState, shown below.</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">IDLE</span>
                        </dt>
                        <dd>
                           <p>This state indicates the Session has zero connections or links.</p>
                        </dd>
                        <dt>
                           <span class="term">ACTIVE</span>
                        </dt>
                        <dd>
                           <p>This state indicates the Session has one or more connections or links.</p>
                        </dd>
                        <dt>
                           <span class="term">INVALID</span>
                        </dt>
                        <dd>
                           <p>This state indicates the Session has lost all of its connections or links.</p>
                        </dd>
                     </dl>
                  </div>
                  <div class="mediaobject" align="center">
                     <a name="mediaobj-session_fsm.jpg"/>
                     <img src="images/session_fsm.jpg" align="middle"/>
                     <div class="caption">
                        <p/>
                     </div>
                  </div>
                  <h5 class="formalpara">MsConnection Finite State Machine</h5>
                  <p class="formalpara">MsConnection state is represented by MsConnectionState enum</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">IDLE</span>
                        </dt>
                        <dd>
                           <p>This state indicates that the MsConnection is just created and has no resources attached to it</p>
                        </dd>
                        <dt>
                           <span class="term">HALF_OPEN</span>
                        </dt>
                        <dd>
                           <p>This state indicates that the MsConnection has created the RTP Socket but doesn't yet have any information of Remote SDP to send the RTP Packets. MsConnection is still usable in HALF_OPEN state if its only receiving the RTP Packets but doesn't have to send any</p>
                        </dd>
                        <dt>
                           <span class="term">OPEN</span>
                        </dt>
                        <dd>
                           <p>state indicates that the MsConnection now has information of remote SDP and can send RTP Packates to the remote IP (for example UA)</p>
                        </dd>
                        <dt>
                           <span class="term">FAILED</span>
                        </dt>
                        <dd>
                           <p>This state indicates that creation or modification of MsConnection failed and is not reusable anymore</p>
                        </dd>
                        <dt>
                           <span class="term">CLOSED</span>
                        </dt>
                        <dd>
                           <p>state indicates that MsConnection has released all its resources and closed the RTP sockets. Its not usable any more. </p>
                        </dd>
                     </dl>
                  </div>
                  <h5 class="formalpara">MsLink Finite State Machine</h5>
                  <p class="formalpara">MsLink state is represented by MsLinkState enum:</p>
                  <div class="variablelist">
                     <dl>
                        <dt>
                           <span class="term">IDLE</span>
                        </dt>
                        <dd>
                           <p> This state indicates that the MsLink is created and has no endpoints associated with it</p>
                        </dd>
                        <dt>
                           <span class="term">JOINED</span>
                        </dt>
                        <dd>
                           <p> This state indicates that the Connection's from both the Endpoint's are created and data transfer has started</p>
                        </dd>
                        <dt>
                           <span class="term">FAILED</span>
                        </dt>
                        <dd>
                           <p> This state indicates that the creation of MsLink failed and is not usable anymore</p>
                        </dd>
                        <dt>
                           <span class="term">INVALID</span>
                        </dt>
                        <dd>
                           <p>state indicates that MsLink has closed Connection's of both the Endpoint's and is not usable anymore</p>
                        </dd>
                     </dl>
                  </div>
               </div>
               <div class="section" lang="en-US">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h3 class="title">
                              <a name="section-API_Methods_and_Usage"/>8.5.5. API Methods and Usage</h3>
                        </div>
                     </div>
                  </div>
                  <p>So far we have specified the key objects as well as their FSMs. To understand operationally how these objects are used and the methods they offer, we refer the user to the UML sequence diagram examples. The following call flow depicts the simple announcement.</p>
                  <div class="mediaobject" align="center">
                     <a name="mediaobj-IVR-msc-api.jpg"/>
                     <table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="700">
                        <tr>
                           <td align="center">
                              <img src="images/IVR-msc-api.jpg" align="middle" width="700"/>
                           </td>
                        </tr>
                     </table>
                     <div class="caption">
                        <p/>
                     </div>
                  </div>
                  <p class="remark">
                     <i>
                        <span class="remark">TBD: Replace this orderedlist with a callout list once the graphic is remade.</span>
                     </i>
                  </p>
                  <div class="orderedlist">
                     <ol>
                        <li>
                           <p>application receives underlying signaling message</p>
                        </li>
                        <li>
                           <p>application registers listeners</p>
                        </li>
                        <li>
                           <p>application registers listeners</p>
                        </li>
                        <li>
                           <p>application registers listeners</p>
                        </li>
                        <li>
                           <p>application creates MsSession object.</p>
                        </li>
                        <li>
                           <p>application creates MsConnection object using MsSession object.</p>
                        </li>
                        <li>
                           <p>application modify MsConnection passing SDP descriptor received on signaling channel.</p>
                        </li>
                        <li>
                           <p>MsConnection implementation sends request to the Media Server using one of the control protocol.</p>
                        </li>
                        <li>
                           <p>Server responds that connection on the Media server is created</p>
                        </li>
                        <li>
                           <p>Application receive ConnectionEvent.CONNECTION_CREATED</p>
                        </li>
                        <li>
                           <p>application obtains server's SDP and sends response to the UA. Media conversation started.</p>
                        </li>
                        <li>
                           <p>Application creates SignalGenerator and ask it to play announcement</p>
                        </li>
                        <li>
                           <p>Application creates SignalGenerator and ask it to play announcement</p>
                        </li>
                        <li>
                           <p>Application creates SignalGenerator and ask it to play announcement</p>
                        </li>
                        <li>
                           <p>Server report that announcement complete.</p>
                        </li>
                        <li>
                           <p>Server report that announcement complete.</p>
                        </li>
                     </ol>
                  </div>
                  <div class="example">
                     <a name="example-Example_Code"/>
                     <div class="example-contents">
                        <a name="proglist-Example_Code"/>
                        <pre class="programlisting">package org.mobicents.mscontrol;

import org.mobicents.media.msc.common.MsLinkMode;
import org.mobicents.media.server.impl.common.events.EventID;
import org.mobicents.mscontrol.impl.MsProviderImpl;

/**
 * This is just a psuedocode to show how to use the MSC Api. This example uses
 * the Packet Relay Endpoint and Announcement Endpoint as follows
 *
 * UA &lt;----&gt; RTP Connection &lt;---- (one side) Packet Relay Endpoint (other side) &lt;-----&gt; MsLink  &lt;----&gt; Announcement Endpoint
 *
 * @author amit bhayani
 *
 */
public class MyMSCTest implements MsSessionListener, MsConnectionListener, MsLinkListener {

    private MsSession session;
    private MsProvider msProvider;

    public void startMedia() {

        // Creating the provider
        MsProvider provider = new MsProviderImpl();

        // Registering the Listeners
        provider.addSessionListener(this);
        provider.addConnectionListener(this);
        provider.addLinkListener(this);

        // Creating the Session
        session = provider.createSession();

        // Creating the connection passing the Endpoint Name. Here we are
        // creating Packet Relay Endpoint which has only two connections. One is
        // connected to UA and other we can connect to Announcement Endpoint
        MsConnection connection = session.createNetworkConnection("media/trunk/PacketRelay/$");

        // Get the Remote SDP here and pass it to connection. If creation of
        // connection is successful connectionCreated method will be called
        connection.modify("$", remoteDesc);
    }

    public void sessionActive(MsSessionEvent evt) {

    }

    public void sessionCreated(MsSessionEvent evt) {

    }

    public void sessionInvalid(MsSessionEvent evt) {

    }

    public void connectionCreated(MsConnectionEvent event) {

        // Since the Endpoint name passed was having '$' MS would have picked
        // the endpoint that is free and hence we need the actual name here
        String userEndpoint = event.getConnection().getEndpoint();

        MsLink link = session.createLink(MsLinkMode.FULL_DUPLEX);
        link.join(userEndpoint, "media/trunk/Announcement/$");

    }

    public void connectionDeleted(MsConnectionEvent event) {

    }

    public void connectionInitialized(MsConnectionEvent event) {
        // TODO Auto-generated method stub

    }

    public void connectionModifed(MsConnectionEvent event) {
        // TODO Auto-generated method stub

    }

    public void txFailed(MsConnectionEvent event) {
        // TODO Auto-generated method stub

    }

    public void linkCreated(MsLinkEvent evt) {

    }

    public void linkDropped(MsLinkEvent evt) {
        // TODO Auto-generated method stub

    }

    public void linkFailed(MsLinkEvent evt) {
        // TODO Auto-generated method stub

    }

    public void linkJoined(MsLinkEvent evt) {
        // Get the MsLink when link between Packet Relay Endpoint and
        // Announcement Endpoint is created
        MsLink link = evt.getSource();

        // Get the Announcement Endpoint Name as we used '$'
        String announcementEndpoint = link.getEndpoints()[1];

        // let us create MsSignalGenerator for Announcement Endpoint to play
        // Announcement
        MsSignalGenerator generator = msProvider.getSignalGenerator(announcementEndpoint);

        // This is hosted audio file, it can be a local file on your machine
        // For example for windows file://c:/mobicents/loopinfo.wav" for linux
        // file://user/home/loopinfo.wav"
        String url = "http://localhost:8080/msdemo/audio/loopinfo.wav";

        // Pass the URL of audio file to be played
        generator.apply(EventID.PLAY, new String[] { url });

    }
}</pre>
                     </div>
                     <p class="title">
                        <b>Example 8.2. Example Code</b>
                     </p>
                  </div>
                  <br class="example-break"/>
               </div>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-MMS_Event_Packages"/>8.6. MMS Event Packages</h2>
                     </div>
                  </div>
               </div>
               <p/>
               <h5 class="formalpara">The Basic Package</h5>
               <p class="formalpara">Package name: <code class="literal">org.mobicents.media.server.spi.events.Basic</code>
		
               </p>
               <div class="informaltable">
                  <a name="informaltable-The_Basic_Package"/>
                  <table border="1">
                     <colgroup>
                        <col align="left"/>
                        <col align="left"/>
                        <col align="left"/>
                        <col align="left"/>
                     </colgroup>
                     <thead>
                        <tr>
                           <th align="left">Event ID</th>
                           <th align="left">Description</th>
                           <th align="left">Type</th>
                           <th align="left">Duration</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td align="left">
						
                              <code class="literal">org.mobicents.media.server.spi.events.Basic.DTMF</code>
					
                           </td>
                           <td align="left">DTMF Event</td>
                           <td align="left">BR</td>
                           <td align="left"> </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <h5 class="formalpara">The Announcement Package</h5>
               <p class="formalpara">Package name: <code class="literal">org.mobicents.media.server.spi.event.Announcement</code>
		
               </p>
               <div class="informaltable">
                  <a name="informaltable-The_Announcement_Package"/>
                  <table border="1">
                     <colgroup>
                        <col align="left"/>
                        <col align="left"/>
                        <col align="left"/>
                        <col align="left"/>
                     </colgroup>
                     <thead>
                        <tr>
                           <th align="left">Event ID</th>
                           <th align="left">Description</th>
                           <th align="left">Type</th>
                           <th align="left">Duration</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td align="left">
						
                              <code class="literal">org.mobicents.media.server.spi.event.Announcement.PLAY</code>
					
                           </td>
                           <td align="left">play an announcement</td>
                           <td align="left">TO</td>
                           <td align="left">variable</td>
                        </tr>
                        <tr>
                           <td align="left">
						
                              <code class="literal">org.mobicents.media.server.spi.event.Announcement.COMPLETED</code>
					
                           </td>
                           <td align="left"> </td>
                           <td align="left"> </td>
                           <td align="left"> </td>
                        </tr>
                        <tr>
                           <td align="left">
						
                              <code class="literal">org.mobicents.media.server.spi.event.Announcement.FAILED</code>
					
                           </td>
                           <td align="left"> </td>
                           <td align="left"> </td>
                           <td align="left"> </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>The announcement action is qualified by an URL name and by a set of initial parameters. The “<span class="quote">operation complete</span>” event will be detected when the announcement is played out. If the announcement cannot be played out, an operation failure event can be returned.  The failure may be explained by a commentary. </p>
               <h5 class="formalpara">The Advanced Audio Package</h5>
               <p class="formalpara">Package name: <code class="literal">org.mobicents.media.server.spi.events.AU</code>
		
               </p>
               <div class="table">
                  <a name="table-The_Advanced_Audio_Package"/>
                  <div class="table-contents">
                     <table summary="The Advanced Audio Package" border="1">
                        <colgroup>
                           <col align="left"/>
                           <col align="left"/>
                           <col align="left"/>
                           <col align="left"/>
                        </colgroup>
                        <thead>
                           <tr>
                              <th align="left">Event ID</th>
                              <th align="left">Description</th>
                              <th align="left">Type</th>
                              <th align="left">Duration</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td align="left">
						
                                 <code class="literal">org.mobicents.media.server.spi.event.AU.PLAY_RECORD</code>
					
                              </td>
                              <td align="left">play an announcement</td>
                              <td align="left">TO</td>
                              <td align="left">variable</td>
                           </tr>
                           <tr>
                              <td align="left">
						
                                 <code class="literal">org.mobicents.media.server.spi.event.AU.PROMPT_AND_COLLECT</code>
					
                              </td>
                              <td align="left"> </td>
                              <td align="left"> </td>
                              <td align="left"> </td>
                           </tr>
                           <tr>
                              <td align="left">
						
                                 <code class="literal">org.mobicents.media.server.spi.event.Announcement.FAILED</code>
					
                              </td>
                              <td align="left"> </td>
                              <td align="left"> </td>
                              <td align="left"> </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
                  <p class="title">
                     <b>Table 8.1. The Advanced Audio Package</b>
                  </p>
               </div>
               <br class="table-break"/>
               <p>PLAY_RECORD Plays a prompt and records user speech.  If the user does not speak, the user may be reprompted and given another chance to record.  By default PlayRecord does not play an initial prompt, makes only one attempt to record, and therefore functions as a simple Record operation</p>
            </div>
            <div class="section" lang="en-US">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title">
                           <a name="section-MMS_Demonstration_Example"/>8.7. MMS Demonstration Example</h2>
                     </div>
                  </div>
               </div>
               <p>The motive of this example is to demonstrate the capabilities of new Media Server (MS) and Media Server Resource Adaptors (MSC-RA).</p>
               <p>The example demonstrates usage of</p>
               <div class="itemizedlist">
                  <ul>
                     <li>
                        <p>the Announcement Endpoint</p>
                     </li>
                     <li>
                        <p>the Packet Relay Endpoint</p>
                     </li>
                     <li>
                        <p>The Loop Endpoint</p>
                     </li>
                     <li>
                        <p>The Conference Endpoint</p>
                     </li>
                     <li>
                        <p>The IVR Endpoint</p>
                     </li>
                  </ul>
               </div>
               <p>For more information on each of these types of endpoints, refer to <a href="#section-Mobicents_Media_Server_Architecture" title="8.2. Mobicents Media Server Architecture">Section 8.2, “Mobicents Media Server Architecture”</a>.	</p>
               <h5 class="formalpara">Where is the Code?</h5>
               <p class="formalpara">Check out the 'mms-demo' example from <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://mobicents.googlecode.com/svn/trunk/servers/jain-slee/examples/mms-demo">http://mobicents.googlecode.com/svn/trunk/servers/jain-slee/examples/mms-demo</a>.</p>
               <h5 class="formalpara">Install and Run</h5>
               <p class="formalpara">Start the Mobicents Server (this will also start Media Server). Make sure you have <code class="filename">server/default/deploy/mobicents.sar</code> and <code class="filename">server/default/deploy/mediaserver.sar</code> in your Mobicents Server</p>
               <h5 class="formalpara">From Binary</h5>
               <p class="formalpara">Go to <code class="filename">/examples/mms-demo</code> and call 'ant deploy-all'. This will deploy the SIP RA, MSC RA, the mms-demo example and also mms-demo-audio.war. The war file contains the audio *.wav files that are used by mms-demo example.</p>
               <h5 class="formalpara">From Source Code</h5>
               <p class="formalpara">If you are deploying from source code, you may deploy each of the resource adaptors individually</p>
               <div class="itemizedlist">
                  <ul>
                     <li>
                        <p>make sure <code class="envar">JBOSS_HOME</code> is set and server is running</p>
                     </li>
                     <li>
                        <p>Call mvn install from <code class="filename">servers/jain-slee/resources/sip</code> to deploy SIP RA </p>
                     </li>
                     <li>
                        <p>Call mvn install from <code class="filename">servers/jain-slee/resources/media</code> to deploy media RA</p>
                     </li>
                     <li>
                        <p>Call mvn install from <code class="filename">servers/jain-slee/examples/mms-demo</code> to deploy example</p>
                     </li>
                  </ul>
               </div>
               <p>Once the example is deployed, make a call from your SIP Phone to TBD.</p>
               <h5 class="formalpara">1010: Loop Endpoint Usage Demonstration</h5>
               <p class="formalpara">As soon as the call is established CallSbb creates a Connection using PREndpointImpl. PREndpointImpl has two Connections, one connected to calling UA by calling msConnection.modify("$", sdp). Once the connection is established CallSbb creates child LoopDemoSbb and calls startDemo() on it passing the PREndpoint name as argument. LoopDemoSbb creates child AnnouncementSbb which uses the AnnEndpointImpl to make an announcement. The other Connection of PREndpointImpl is connected to Connection from AnnEndpointImpl using the MsLink.</p>
               <pre class="programlisting">
	MsLink link = session.createLink(MsLink.MODE_FULL_DUPLEX);
....
...
link.join(userEndpoint, ANNOUNCEMENT_ENDPOINT);</pre>
               <p>Once the link is created (look at onLinkCreated() ) AnnouncementSbb creates the instance of MsSignalGenerator and attaches the AnnouncementSbb to ActivityContextInterface created passing MsSignalGenerator. MsSignalGenerator is used to play the announcement as shown below:</p>
               <pre class="programlisting">MsSignalGenerator generator = msProvider.getSignalGenerator(getAnnouncementEndpoint());
ActivityContextInterface generatorActivity = mediaAcif.getActivityContextInterface(generator);
generatorActivity.attach(sbbContext.getSbbLocalObject());
generator.apply(Announcement.PLAY, new String[]{url});</pre>
               <div class="mediaobject" align="center">
                  <a name="mediaobj-untitled_digram-1.png"/>
                  <img src="images/untitled_digram-1.png" align="middle"/>
                  <div class="caption">
                     <p/>
                  </div>
               </div>
               <p>As soon as announcement is over LoopDemoSbb creates child LoopbackSbb and calls startConversation() on it passing the PREndpoint name as argument. LoopbackSbb uses MsLink to associate the other Connection of PREndpointImpl to LoopEndpointImpl. LoopEndpointImpl simply forwards the voice packet received from caller back to caller.</p>
               <pre class="programlisting">
 MsLink link = session.createLink(MsLink.MODE_FULL_DUPLEX);
.......
...
link.join(endpointName, LOOP_ENDPOINT);</pre>
               <div class="mediaobject" align="center">
                  <a name="mediaobj-untitled_digram-2.png"/>
                  <img src="images/untitled_digram-2.png" align="middle"/>
                  <div class="caption">
                     <p/>
                  </div>
               </div>
               <div class="figure">
                  <a name="figure-1010.PNG"/>
                  <div class="figure-contents">
                     <div class="mediaobject" align="center">
                        <a name="mediaobj-1010.PNG"/>
                        <img src="images/1010.PNG" align="middle" alt="The SBB Child Relation Diagram"/>
                     </div>
                  </div>
                  <p class="title">
                     <b>Figure 8.3. The SBB Child Relation Diagram</b>
                  </p>
               </div>
               <br class="figure-break"/>
               <h5 class="formalpara">1011: DTMF Usage Demonstration</h5>
               <p class="formalpara">As soon as the call is established CallSbb creates a Connection using PREndpointImpl. PREndpointImpl has two Connections, one connected to calling UA by calling msConnection.modify("$", sdp). Once the connection is established CallSbb creates child DtmfDemoSbb and calls startDemo() on it passing the PREndpoint name as argument. DtmfDemoSbb creates child AnnouncementSbb which uses the AnnEndpointImpl to make an announcement. The other Connection of PREndpointImpl is connected to Connection from AnnEndpointImpl using the MsLink.</p>
               <pre class="programlisting">....
MsLink link = session.createLink(MsLink.MODE_FULL_DUPLEX);
....
...
link.join(userEndpoint, ANNOUNCEMENT_ENDPOINT);</pre>
               <p>
Once the link is created (look at onLinkCreated() ) AnnouncementSbb creates the instance of MsSignalGenerator and attaches the AnnouncementSbb to ActivityContextInterface created passing MsSignalGenerator. MsSignalGenerator is used to play the announcement as shown below.</p>
               <pre class="programlisting">MsSignalGenerator generator = msProvider.getSignalGenerator(getAnnouncementEndpoint());
ActivityContextInterface generatorActivity = mediaAcif.getActivityContextInterface(generator);
generatorActivity.attach(sbbContext.getSbbLocalObject());
generator.apply(Announcement.PLAY, new String[]{url});</pre>
               <div class="mediaobject" align="center">
                  <a name="mediaobj-untitled_digram-3.png"/>
                  <img src="images/untitled_digram-3.png" align="middle"/>
                  <div class="caption">
                     <p/>
                  </div>
               </div>
               <p>As soon as announcement is over DtmfDemoSbb creates instance of MsSignalDetector and attaches the DtmfDemoSbb to ActivityContextInterface created passing MsSignalDetector. This is necessary so that DtmfDemoSbb receives the DTMF event, look at onDtmf() method. In fact the SBB needs to be attached to this ACI everytime as the activity is over as soon as the DTMf is received.</p>
               <pre class="programlisting">MsSignalDetector dtmfDetector = msProvider.getSignalDetector(this.getUserEndpoint());
ActivityContextInterface dtmfAci =
mediaAcif.getActivityContextInterface(dtmfDetector);
dtmfAci.attach(sbbContext.getSbbLocalObject());
dtmfDetector.receive(Basic.DTMF, connection, new String[]{});</pre>
               <p>On every DTMF received DtmfDemoSbb plays corresponding wav file using the AnnouncementSbb as explained above.</p>
               <div class="figure">
                  <a name="figure-1011.PNG"/>
                  <div class="figure-contents">
                     <div class="mediaobject" align="center">
                        <a name="mediaobj-1011.PNG"/>
                        <img src="images/1011.PNG" align="middle"/>
                        <div class="caption">
                           <p>The SBB Child Relation Diagram</p>
                        </div>
                     </div>
                  </div>
                  <p class="title">
                     <b>Figure 8.4. </b>
                  </p>
               </div>
               <br class="figure-break"/>
               <h5 class="formalpara">1012: ConfEndpointImpl Usage Demonstration</h5>
               <p class="formalpara">As soon as the call is established CallSbb creates a Connection using PREndpointImpl. PREndpointImpl has two Connections, one connected to calling UA by calling msConnection.modify("$", sdp). Once the connection is established CallSbb creates child ConfDemoSbb and calls startDemo() on it passing the PREndpoint name as argument. ConfDemoSbb creates child AnnouncementSbb which uses the AnnEndpointImpl to make an announcement. The other Connection of PREndpointImpl is connected to Connection from AnnEndpointImpl using the MsLink.</p>
               <pre class="programlisting">....
MsLink link = session.createLink(MsLink.MODE_FULL_DUPLEX);
....
...
link.join(userEndpoint, ANNOUNCEMENT_ENDPOINT);</pre>
               <p>Once the link is created (look at onLinkCreated() ) AnnouncementSbb creates the instance of MsSignalGenerator and attaches the AnnouncementSbb to ActivityContextInterface created passing MsSignalGenerator. MsSignalGenerator is used to play the announcement as shown below</p>
               <pre class="programlisting">MsSignalGenerator generator = msProvider.getSignalGenerator(getAnnouncementEndpoint());
ActivityContextInterface generatorActivity = mediaAcif.getActivityContextInterface(generator);
generatorActivity.attach(sbbContext.getSbbLocalObject());
generator.apply(Announcement.PLAY, new String[]{url});</pre>
               <div class="mediaobject" align="center">
                  <a name="mediaobj-untitled_digram-4.png"/>
                  <img src="images/untitled_digram-4.png" align="middle"/>
                  <div class="caption">
                     <p/>
                  </div>
               </div>
               <p>As soon as announcement is over ConfDemoSbb creates child ForestSbb and calls enter() on it passing the PREndpoint name as argument. ForestSbb uses MsLink to associate the other Connection of PREndpointImpl to ConfEndpointImpl:</p>
               <pre class="programlisting">MsLink link = session.createLink(MsLink.MODE_FULL_DUPLEX);
link.join(endpointName, CNF_ENDPOINT);</pre>
               <p>Once the link is established (Look at onConfBridgeCreated() ) ForestSbb creates many child AnnouncementSbb each responsible for unique announcement (in this case playing crickets.wav and mocking.wav). So now UA is actually listening to many announcements at same go.</p>
               <div class="mediaobject" align="center">
                  <a name="mediaobj-untitled_digram-5.png"/>
                  <img src="images/untitled_digram-5.png" align="middle"/>
                  <div class="caption">
                     <p/>
                  </div>
               </div>
               <div class="figure">
                  <a name="figure-1012.PNG"/>
                  <div class="figure-contents">
                     <div class="mediaobject" align="center">
                        <a name="mediaobj-1012.PNG"/>
                        <img src="images/1012.PNG" align="middle"/>
                        <div class="caption">
                           <p>The SBB Child Relation Diagram</p>
                        </div>
                     </div>
                  </div>
                  <p class="title">
                     <b>Figure 8.5. </b>
                  </p>
               </div>
               <br class="figure-break"/>
            </div>
         </div>
         <div class="appendix" lang="en-US">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title">
                        <a name="Mobicents_User_Guide-Revision_History"/>Appendix A. Revision History</h2>
                  </div>
                  <div>
                     <div class="revhistory">
                        <table border="1" width="100%" summary="Revision history">
                           <tr>
                              <th align="left" valign="top" colspan="3">
                                 <b>Revision History</b>
                              </th>
                           </tr>
                           <tr>
                              <td align="left">Revision 1.0</td>
                              <td align="left">Mon Feb 19 2008</td>
                              <td align="left">
                                 <span class="firstname">Douglas<br/>
                                 </span>
                                 <span class="surname">Silas<br/>
                                 </span>
                                 <code class="email">&lt;<a href="mailto:dhensley@redhat.com">dhensley@redhat.com</a>&gt;</code>
                              </td>
                           </tr>
                           <tr>
                              <td align="left" colspan="3">
			
                                 <table class="simplelist" border="0" summary="Simple list">
                                    <tr>
                                       <td>Initial Release</td>
                                    </tr>
                                 </table>
		
                              </td>
                           </tr>
                        </table>
                     </div>
                  </div>
               </div>
            </div>
            <p>
	
            </p>
         </div>
      </div>
   </body>
</html>